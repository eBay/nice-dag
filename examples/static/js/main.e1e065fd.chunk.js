(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{191:function(e,n,t){"use strict";(function(e){var i=t(0),o=t.n(i),r=t(135),a=t(197);Object(r.setConfig)({logLevel:"debug"}),n.a=Object(r.hot)(e)(function(){return o.a.createElement(a.a,null)})}).call(this,t(204)(e))},197:function(e,n,t){"use strict";var i=t(109),o=t(0),r=t.n(o),a=function(){return document.location.hash.replace("#","")},d=function(){var e=Object(o.useState)(a()),n=Object(i.a)(e,2),t=n[0],r=n[1];return Object(o.useEffect)(function(){function e(){var e=a()||"basic";r(e),window.scrollTo({top:0})}return window.addEventListener("hashchange",e),function(){window.removeEventListener("hashchange",e)}},[r]),t},s={"ReadOnlyView.js":'import React, { useCallback, useEffect } from \'react\';\nimport { useNiceDag } from \'@ebay/nice-dag-react\';\nimport { HierarchicalModel, FlattenModel } from \'../data/ReadOnlyViewData\';\nimport { FullscreenExitOutlined, PlusCircleOutlined } from \'@ant-design/icons\';\nimport { Button, Space, Select } from \'antd\';\nimport ZoomInOutSlider from \'./ZoomInOutSlider\';\n\nconst Option = Select.Option;\n\nconst NODE_WIDTH = 150;\nconst NODE_HEIGHT = 60;\nconst CIRCLE_W_H = 30;\n\nfunction StartNode() {\n  return <div className="readonly-sample-start-node" />;\n}\n\nfunction EndNode() {\n  return <div className="readonly-sample-end-node" />;\n}\n\nfunction Connector({ type }) {\n  return <div className={`readonly-sample-connector-${type}`} />;\n}\n\nfunction Joint() {\n  return <div className={`readonly-sample-joint-node`} />;\n}\n\nfunction GroupControl({ node }) {\n  return (\n    <div className="readonly-sample-node-group-content">\n      <div>\n        {node.data?.label || node.id}\n        <Button\n          icon={<FullscreenExitOutlined />}\n          onClick={() => {\n            node.shrink();\n          }}\n          type="link"\n        />\n      </div>\n    </div>\n  );\n}\n\nfunction NodeControl({ node }) {\n  return (\n    <div className="readonly-sample-node-content">\n      <span>{node.data?.label || node.id}</span>\n      {(node.children?.length > 0 || node.data?.lazyLoadingChildren) && (\n        <Button\n          icon={<PlusCircleOutlined />}\n          onClick={() => {\n            if (node.data?.lazyLoadingChildren) {\n              node.withChildren(new Promise((resolve) => {\n                resolve([{\n                  id: \'step-1\',\n                }, {\n                  id: \'step-2\',\n                  dependencies: [\'step-1\']\n                }])\n              }));\n            } else {\n              node.expand();\n            }\n          }}\n          type="link"\n        />\n      )}\n    </div>\n  );\n}\n\nfunction SampleNode({ node, niceDag }) {\n  return (\n    <div className="readonly-sample-node">\n      {node.children?.length > 0 && !node.collapse ? (\n        <GroupControl node={node} niceDag={niceDag} />\n      ) : (\n        <NodeControl node={node} niceDag={niceDag} />\n      )}\n      <Connector type="in" />\n      <Connector type="out" />\n    </div>\n  );\n}\n\nconst getNodeSize = node => {\n  if (node.id === \'start\' || node.id === \'end\' || node.joint) {\n    return {\n      width: CIRCLE_W_H,\n      height: CIRCLE_W_H,\n    };\n  }\n  return {\n    width: NODE_WIDTH,\n    height: NODE_HEIGHT,\n  };\n};\n\nconst NODE_COMP_MAPPER = {\n  start: StartNode,\n  end: EndNode,\n};\n\nconst renderNode = ({ node, niceDag }) => {\n  let Comp = NODE_COMP_MAPPER[node.id] || SampleNode;\n  if (node.joint) {\n    Comp = Joint;\n  }\n  return <Comp node={node} niceDag={niceDag} />;\n};\n\nconst renderEdge = ({ edge, niceDag }) => {\n  return <div className="readonly-sample-edge-label">to</div>;\n};\n\nexport default function ReadOnlyView() {\n  const { niceDag, niceDagEl, minimapEl, render } = useNiceDag({\n    initNodes: HierarchicalModel,\n    getNodeSize,\n    renderNode,\n    renderEdge,\n    minimapConfig: {\n      viewBoxClassName: \'readonly-sample-minimap-viewbox\',\n    }\n  });\n  useEffect(() => {\n    if (niceDag) {\n      const bounds = niceDagEl.current.getBoundingClientRect();\n      niceDag.center({\n        width: bounds.width,\n        height: 400,\n      });\n    }\n  }, [niceDag, niceDagEl]);\n  const onDirectionChange = useCallback((value) => {\n    niceDag.setDirection(value);\n  }, [niceDag]);\n  return (\n    <div className="readonly-sample">\n      <div>\n        <Space>\n          <label>Direction</label>\n          <Select defaultValue="LR" style={{ width: 120 }} onChange={onDirectionChange}>\n            <Option value="LR">Left to Right</Option>\n            <Option value="RL">Right to Left</Option>\n            <Option value="TB">Top To Bottom</Option>\n            <Option value="BT">Bottom To Top</Option>\n          </Select>\n          <ZoomInOutSlider onScaleChange={value => niceDag.setScale(value / 100)} />\n        </Space>\n      </div>\n      <div className="readonly-sample-content">\n        <div className="readonly-sample-content-nice-dag" ref={niceDagEl} />\n        <div className="readonly-sample-content-minimap" >\n          <div className="readonly-sample-content-minimap-body" ref={minimapEl} />\n        </div>\n        {render()}\n      </div>\n    </div>\n  );\n}\n',"ReadOnlyViewData.js":"export const HierarchicalModel = [\n  {\n    id: 'start',\n  },\n  {\n    id: 'git-clone',\n    dependencies: ['start'],\n    data: {\n      label: 'Git Clone',\n    },\n  },\n  {\n    id: 'mvn',\n    dependencies: ['git-clone'],\n    data: {\n      label: 'Mvn Install',\n    },\n  },\n  {\n    id: 'security-check',\n    dependencies: ['git-clone'],\n    data: {\n      label: 'Security Check',\n    },\n  },\n  {\n    id: 'build',\n    dependencies: ['mvn', 'security-check'],\n    data: {\n      label: 'Build',\n      lazyLoadingChildren: true\n    },\n  },\n  {\n    id: 'deploy-fp-1',\n    dependencies: ['build'],\n    data: {\n      label: 'Deploy Feature-1',\n    },\n    children: [\n      {\n        id: 'provision-fp-1',\n        data: {\n          label: 'Provision Pool',\n        },\n      },\n      {\n        id: 'deployment-fp-1',\n        dependencies: ['provision-fp-1'],\n        data: {\n          label: 'Deployment',\n        },\n      },\n    ],\n  },\n  {\n    id: 'deploy-fp-2',\n    dependencies: ['build'],\n    data: {\n      label: 'Deploy Feature-2',\n    },\n    children: [\n      {\n        id: 'provision-fp-2',\n        data: {\n          label: 'Provision Pool',\n        },\n      },\n      {\n        id: 'deployment-fp-2',\n        dependencies: ['provision-fp-2'],\n        data: {\n          label: 'Deployment',\n        },\n      },\n    ],\n  },\n  {\n    id: 'smoke-test',\n    dependencies: ['deploy-fp-1', 'deploy-fp-2'],\n  },\n  {\n    id: 'integration-test',\n    dependencies: ['smoke-test'],\n  },\n  {\n    id: 'prod-deployment',\n    dependencies: ['integration-test'],\n  },\n  {\n    id: 'end',\n    dependencies: ['prod-deployment'],\n  },\n];\n\nexport const FlattenModel = [\n  {\n    id: 'start',\n  },\n  {\n    id: 'git-clone',\n    dependencies: ['start'],\n    data: {\n      label: 'Git Clone',\n    },\n  },\n  {\n    id: 'mvn',\n    dependencies: ['git-clone'],\n    data: {\n      label: 'Mvn Install',\n    },\n  },\n  {\n    id: 'security-check',\n    dependencies: ['git-clone'],\n    data: {\n      label: 'Security Check',\n    },\n  },\n  {\n    id: 'build',\n    dependencies: ['mvn', 'security-check'],\n    data: {\n      label: 'Build',\n    },\n  },\n  {\n    id: 'deploy-fp-1',\n    dependencies: ['build'],\n    data: {\n      label: 'Deploy Feature-1',\n    },\n  },\n  {\n    id: 'provision-fp-1',\n    data: {\n      label: 'Provision Pool',\n    },\n    parentId: 'deploy-fp-1'\n  },\n  {\n    id: 'deployment-fp-1',\n    dependencies: ['provision-fp-1'],\n    data: {\n      label: 'Deployment',\n    },\n    parentId: 'deploy-fp-1'\n  },\n  {\n    id: 'deploy-fp-2',\n    dependencies: ['build'],\n    data: {\n      label: 'Deploy Feature-2',\n    },\n  },\n  {\n    id: 'provision-fp-2',\n    data: {\n      label: 'Provision Pool',\n    },\n    parentId: 'deploy-fp-2'\n  },\n  {\n    id: 'deployment-fp-2',\n    dependencies: ['provision-fp-2'],\n    data: {\n      label: 'Deployment',\n    },\n    parentId: 'deploy-fp-2'\n  },\n  {\n    id: 'deployment-fp-3',\n    dependencies: ['deployment-fp-2'],\n    data: {\n      label: 'Last Step',\n    },\n    parentId: 'deploy-fp-2'\n\n  },\n  {\n    id: 'deployment-fp-2-2',\n    data: {\n      label: 'Deployment-child',\n    },\n    parentId: 'deployment-fp-2'\n  },\n  {\n    id: 'deployment-fp-2-2-child',\n    data: {\n      label: 'Deployment-child-child',\n    },\n    parentId: 'deployment-fp-2-2'\n  },\n  {\n    id: 'smoke-test',\n    dependencies: ['deploy-fp-1', 'deploy-fp-2'],\n  },\n  {\n    id: 'integration-test',\n    dependencies: ['smoke-test'],\n  },\n  {\n    id: 'prod-deployment',\n    dependencies: ['integration-test'],\n  },\n  {\n    id: 'end',\n    dependencies: ['prod-deployment'],\n  },\n];","ReadOnlyView.less":"@import '../../styles/mixins';\n@conector-size: 16px;\n\n.readonly-sample {\n  .ant-slider {\n    min-width: 180px;\n  }\n  &-minimap {\n    width: 250px;\n    height: 200px;\n  }\n  &-edge-label {\n    text-align: center;\n    margin-top: -20px;\n  }\n  &-start-node,\n  &-end-node,\n  &-joint-node {\n    border: 1px solid black;\n    border-radius: 50%;\n    width: 30px;\n    height: 30px;\n    background: white;\n  }\n\n  &-joint-node {\n    font-size: 18px;\n    display: flex;\n    align-content: center;\n    justify-content: center;\n    align-items: center;\n  }\n\n  &-end-node::before {\n    content: '';\n    position: absolute;\n    border: 1px solid black;\n    border-radius: 50%;\n    background: black;\n    top: 5px;\n    left: 5px;\n    width: 20px;\n    height: 20px;\n  }\n\n  &-connector {\n    &-in,\n    &-out {\n      width: @conector-size;\n      height: @conector-size;\n      border: 1px solid black;\n      border-radius: 50%;\n      position: absolute;\n      margin: auto;\n      top: 0;\n      bottom: 0;\n      background: white;\n    }\n\n    &-in {\n      left: @conector-size / -2;\n    }\n    &-out {\n      right: @conector-size / -2;\n    }\n  }\n\n  &-node {\n    width: 100%;\n    height: 100%;\n    &-group-content,\n    &-content {\n      position: relative;\n      width: 100%;\n      height: 100%;\n      border: 1px solid #8799c1;\n      border-radius: 10px;\n      display: flex;\n      flex-direction: column;\n    }\n    &-group-content {\n      padding: 4px 20px;\n      > div {\n        height: 30px;\n\n        a {\n          margin-left: 6px;\n          font-size: 16px;\n        }\n      }\n    }\n    &-content {\n      align-items: center;\n      justify-content: center;\n    }\n  }\n\n  &-content {\n    height: 400px;\n    position: relative;\n    &-nice-dag {\n      height: 100%;\n    }\n    &-minimap {\n      position: absolute;\n      right: 0;\n      width: 250px;\n      height: 120px;\n      bottom: 20px; //scroll bar\n      border: 1px solid gray;\n      padding: 2px 2px;\n      background-color: #efefef;\n\n      &-body {\n        width: 100%;\n        height: 100%;\n      }\n    }\n  }\n  &-minimap-viewbox {\n    border: 1px solid orange !important\n  }\n}\n\n \n","EditableView.js":'import React, { useCallback, useEffect } from \'react\';\nimport { useNiceDag, useNiceDagNode, useNiceDagEdge } from \'@ebay/nice-dag-react\';\nimport { HierarchicalModel } from \'../data/ReadOnlyViewData\';\nimport {\n  FullscreenExitOutlined,\n  PlusCircleOutlined,\n  DragOutlined,\n  CloseCircleOutlined,\n  CloseOutlined\n} from \'@ant-design/icons\';\nimport { Button, Dropdown, Menu, Space } from \'antd\';\nimport ZoomInOutSlider from \'./ZoomInOutSlider\';\n\nconst NODE_WIDTH = 150;\nconst NODE_HEIGHT = 60;\nconst CIRCLE_W_H = 30;\n\nfunction StartNode({ node, niceDag }) {\n  const { startNodeDragging } = useNiceDagNode({ node, niceDag });\n  return (\n    <div className="editable-sample-start-node">\n      <div className="editable-sample-start-node-move-hand" onMouseDown={startNodeDragging} />\n      <SquareConnector type="out" node={node} niceDag={niceDag} />\n    </div>\n  );\n}\n\nfunction EndNode({ node, niceDag }) {\n  const { startNodeDragging } = useNiceDagNode({ node, niceDag });\n  return (\n    <div className="editable-sample-end-node" onMouseDown={startNodeDragging}>\n      <SquareConnector type="in" />\n    </div>\n  );\n}\n\nlet nodeCtnRef = 0;\nfunction Edge({ edge }) {\n  const { onEdgeRemove, onNodeInsert } = useNiceDagEdge(edge);\n  const runInsertBetween = useCallback(() => {\n    onNodeInsert([\n      {\n        \'id\': `insert-node-${nodeCtnRef}`\n      },\n      {\n        \'id\': `insert-node-${nodeCtnRef + 1}`\n      },\n      {\n        \'id\': `insert-node-${nodeCtnRef + 2}`\n      }\n    ]);\n    nodeCtnRef += 3;\n  }, [onNodeInsert]);\n  const menu = (\n    <Menu\n      items={[\n        {\n          key: \'1\',\n          label: <span onClick={onEdgeRemove}>Remove</span>,\n        },\n        {\n          key: \'2\',\n          label: <span onClick={runInsertBetween}>Insert Tasks</span>,\n        },\n      ]}\n    />\n  );\n  return (\n    <div className="editable-sample-edge-label">\n      <Dropdown overlay={menu}>\n        <div />\n      </Dropdown>\n    </div>\n  );\n}\n\nconst renderEdge = props => {\n  return <Edge {...props} />;\n};\n\nfunction Connector({ type, niceDag, node }) {\n  const { startEdgeDragging } = useNiceDagNode({ node, niceDag });\n  return <div className={`editable-sample-connector-${type}`} onMouseDown={startEdgeDragging}\n    aria-label={`${type === \'in\' ? \'Inbound\' : \'Outbound\'}Connector`} role="button" />\n}\n\nfunction SquareConnector({ type, niceDag, node }) {\n  const { startEdgeDragging } = useNiceDagNode({ node, niceDag });\n  return (\n    <div className={`editable-sample-square-connector-${type}`} onMouseDown={startEdgeDragging} />\n  );\n}\n\nfunction Joint({ node, niceDag }) {\n  const { onNodeRemove, startNodeDragging } = useNiceDagNode({ node, niceDag });\n  return <div className="editable-sample-joint-node">\n    <div className="editable-sample-joint-node-move" onMouseDown={startNodeDragging}>\n      <DragOutlined />\n    </div>\n    <div\n      className="editable-sample-joint-node-remove-button"\n      role="button"\n      onMouseDown={onNodeRemove}\n      aria-label="Remove joint node"\n    >\n      <CloseOutlined />\n    </div>\n    <SquareConnector type="in" />\n    <SquareConnector type="out" node={node} niceDag={niceDag} />\n  </div>;\n}\n\nfunction GroupControl({ node, niceDag }) {\n  const { onNodeRemove, startNodeDragging } = useNiceDagNode({ node, niceDag });\n  return (\n    <div className="editable-sample-node-group-content">\n      <div>\n        <div className="editable-sample-node-group-content-bar" onMouseDown={startNodeDragging}>\n          <span>{node.data?.label || node.id}</span>\n          <DragOutlined />\n        </div>\n        <div\n          className="editable-sample-node-group-content-delete-button"\n          role="button"\n          onMouseDown={onNodeRemove}\n        >\n          <CloseCircleOutlined />\n        </div>\n        <Button\n          icon={<FullscreenExitOutlined />}\n          onClick={() => {\n            node.shrink();\n          }}\n          type="link"\n        />\n      </div>\n    </div>\n  );\n}\n\nfunction NodeControl({ node, niceDag }) {\n  const { onNodeRemove, startNodeDragging } = useNiceDagNode({ node, niceDag });\n  return (\n    <div className="editable-sample-node-content">\n      <div className="editable-sample-node-content-bar" onMouseDown={startNodeDragging}>\n        <span>{node.data?.label || node.id}</span>\n        <DragOutlined />\n      </div>\n      <div\n        className="editable-sample-node-content-delete-button"\n        role="button"\n        onMouseDown={onNodeRemove}\n      >\n        <CloseCircleOutlined />\n      </div>\n      {(node.children?.length > 0 || node.data?.lazyLoadingChildren) && (\n        <Button\n          icon={<PlusCircleOutlined />}\n          onClick={() => {\n            if (node.data?.lazyLoadingChildren) {\n              node.withChildren(new Promise((resolve) => {\n                resolve([{\n                  id: \'step-1\',\n                }, {\n                  id: \'step-2\',\n                  dependencies: [\'step-1\']\n                }])\n              }));\n            } else {\n              node.expand();\n            }\n          }}\n          type="link"\n        />\n      )}\n    </div>\n  );\n}\n\nfunction SampleNode({ node, niceDag }) {\n  return (\n    <div className="editable-sample-node">\n      {node.children?.length > 0 && !node.collapse ? (\n        <GroupControl node={node} niceDag={niceDag} />\n      ) : (\n        <NodeControl node={node} niceDag={niceDag} />\n      )}\n      <Connector type="in" />\n      <Connector type="out" node={node} niceDag={niceDag} />\n    </div>\n  );\n}\n\nconst getNodeSize = node => {\n  if (node.id === \'start\' || node.id === \'end\' || node.joint) {\n    return {\n      width: CIRCLE_W_H,\n      height: CIRCLE_W_H,\n    };\n  }\n  return {\n    width: NODE_WIDTH,\n    height: NODE_HEIGHT,\n  };\n};\n\nconst NODE_COMP_MAPPER = {\n  start: StartNode,\n  end: EndNode,\n};\n\nconst renderNode = ({ node, niceDag }) => {\n  let Comp = NODE_COMP_MAPPER[node.id] || SampleNode;\n  if (node.joint) {\n    Comp = Joint;\n  }\n  return <Comp node={node} niceDag={niceDag} />;\n};\n\nexport default function EditableDagView() {\n  const { niceDag, niceDagEl, render } = useNiceDag({\n    initNodes: HierarchicalModel,\n    getNodeSize,\n    renderNode,\n    editable: true,\n    renderEdge,\n    jointEdgeConnectorType: \'CENTER_OF_BORDER\'\n  });\n  useEffect(() => {\n    if (niceDag) {\n      const bounds = document.querySelector(\'.editable-sample\').getBoundingClientRect();\n      niceDag\n        .center({\n          width: bounds.width,\n          height: 400,\n        })\n        .startEditing();\n    }\n  }, [niceDag]);\n  return (\n    <div className="editable-sample">\n      <div>\n        <Space>\n          <Button\n            size="small"\n            onClick={() => {\n              niceDag.prettifier();\n            }}\n          >\n            Prettifier\n          </Button>\n          <Button\n            size="small"\n            onClick={() => {\n              niceDag.addNode({\n                id: `new-node-${nodeCtnRef}`,\n              }, {\n                x: 40,\n                y: 40\n              });\n              nodeCtnRef = nodeCtnRef + 1;\n            }}\n          >\n            Add Node\n          </Button>\n          <Button\n            size="small"\n            onClick={() => {\n              niceDag.addJointNode({\n                id: `new-node-${nodeCtnRef}`\n              }, {\n                x: 40,\n                y: 40\n              });\n              nodeCtnRef = nodeCtnRef + 1;\n            }}\n          >\n            Add Joint Node\n          </Button>\n          <ZoomInOutSlider onScaleChange={value => niceDag.setScale(value / 100)} />\n        </Space>\n      </div>\n      <div className="editable-sample-nice-dag-wrapper" ref={niceDagEl} />\n      {render()}\n    </div>\n  );\n}\n',"ZoomInOutSlider.js":"import React, { useState, useCallback } from 'react';\nimport { Slider, Space } from 'antd';\nimport { ZoomInOutlined, ZoomOutOutlined } from '@ant-design/icons';\n\nexport default function ZoomInOutSlider({ onScaleChange }) {\n  const [scale, setScale] = useState(100);\n  const onSlideValueChange = useCallback(\n    value => {\n      setScale(value);\n      onScaleChange(value);\n    },\n    [onScaleChange],\n  );\n  return (\n    <Space>\n      <ZoomOutOutlined />\n      <Slider defaultValue={scale} onChange={onSlideValueChange} />\n      <ZoomInOutlined />\n    </Space>\n  );\n}\n","EditableView.less":"@import '../../styles/mixins';\n@conector-size: 16px;\n\n.editable-sample {\n  .ant-slider {\n    min-width: 180px;\n  }\n  &-edge-label {\n    height: 100%;\n    width: calc(~'100% - ' @conector-size);\n    margin: auto;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    &:hover {\n      background: rgba(0, 0, 255, 0.2);\n    }\n\n    div {\n      width: 16px;\n      height: 16px;\n    }\n  }\n  &-start-node {\n    &-move-hand {\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n    }\n  }\n  &-start-node,\n  &-end-node,\n  &-joint-node {\n    border: 1px solid black;\n    border-radius: 50%;\n    width: 30px;\n    height: 30px;\n    background: white;\n  }\n\n  &-joint-node {\n    &-move {\n      text-align: center;\n      padding-top: 2px;\n      z-index: 1;\n    }\n\n    &-remove-button {\n      position: absolute;\n      top: -10px;\n      right: -2px;\n      background-color: white;\n      border: 1px solid black;\n      height: 14px;\n      font-size: 12px;\n\n      .anticon-close {\n        transform: translateY(-2px);\n      }\n    }\n  }\n\n  &-end-node::before {\n    content: '';\n    position: absolute;\n    border: 1px solid black;\n    border-radius: 50%;\n    background: darkgray;\n    top: 5px;\n    left: 5px;\n    width: 20px;\n    height: 20px;\n  }\n\n  &-square-connector,\n  &-connector {\n    &-in,\n    &-out {\n      width: @conector-size;\n      height: @conector-size;\n      border: 1px solid black;\n      border-radius: 50%;\n      position: absolute;\n      margin: auto;\n      top: 0;\n      bottom: 0;\n      background: white;\n    }\n\n    &-in {\n      left: @conector-size / -2;\n    }\n    &-out {\n      right: @conector-size / -2;\n      cursor: pointer;\n      z-index: 1;\n    }\n  }\n\n  &-square-connector {\n    &-in,\n    &-out {\n      border: 1px solid black;\n      border-radius: 0;\n    }\n  }\n\n  &-node {\n    width: 100%;\n    height: 100%;\n    background: white;\n\n    &-group-content,\n    &-content {\n      position: relative;\n      width: 100%;\n      height: 100%;\n      border: 1px solid #8799c1;\n      border-radius: 10px;\n      display: flex;\n      flex-direction: column;\n\n      &-delete-button {\n        position: absolute;\n        right: -10px;\n        top: -11px;\n        background: white;\n        font-size: 18px;\n        height: 20px;\n      }\n\n      &-bar {\n        cursor: pointer;\n        z-index: 2;\n        span:nth-child(2) {\n          margin-left: 4px;\n          font-size: 16px;\n        }\n      }\n    }\n    &-group-content {\n      padding: 4px 20px;\n      > div {\n        height: 30px;\n\n        a {\n          margin-left: 6px;\n          font-size: 16px;\n        }\n      }\n      &-bar {\n        cursor: pointer;\n        display: inline-block;\n        span:nth-child(2) {\n          margin-left: 4px;\n          font-size: 16px;\n        }\n      }\n    }\n    &-content {\n      align-items: center;\n      justify-content: center;\n    }\n  }\n\n  &-nice-dag-wrapper {\n    height: 400px;\n    border: 1px solid #efefef;\n  }\n}\n","ComplexHierarchicalView.js":"import React, { useEffect } from 'react';\nimport { useNiceDag } from '@ebay/nice-dag-react';\nimport { ComplexFlattenModel } from '../data/ComplexHierarchicalViewData';\nimport { FullscreenExitOutlined, PlusCircleOutlined } from '@ant-design/icons';\nimport { Button, Space } from 'antd';\nimport ZoomInOutSlider from './ZoomInOutSlider';\n\nconst NODE_WIDTH = 150;\nconst NODE_HEIGHT = 60;\nconst CIRCLE_W_H = 30;\n\nfunction StartNode() {\n  return <div className=\"complex-sample-start-node\" />;\n}\n\nfunction EndNode() {\n  return <div className=\"complex-sample-end-node\" />;\n}\n\nfunction Connector({ type }) {\n  return <div className={`complex-sample-connector-${type}`} />;\n}\n\nfunction Joint() {\n  return <div className={`complex-sample-joint-node`} />;\n}\n\nfunction GroupControl({ node }) {\n  return (\n    <div className=\"complex-sample-node-group-content\">\n      <div>\n        {node.data?.label || node.id}\n        <Button\n          icon={<FullscreenExitOutlined />}\n          onClick={() => {\n            node.shrink();\n          }}\n          type=\"link\"\n        />\n      </div>\n    </div>\n  );\n}\n\nfunction NodeControl({ node }) {\n  return (\n    <div className=\"complex-sample-node-content\">\n      <span>{node.data?.label || node.id}</span>\n      {(node.children?.length > 0 || node.data?.lazyLoadingChildren) && (\n        <Button\n          icon={<PlusCircleOutlined />}\n          onClick={() => {\n            if (node.data?.lazyLoadingChildren) {\n              node.withChildren(new Promise((resolve) => {\n                resolve([{\n                  id: 'step-1',\n                }, {\n                  id: 'step-2',\n                  dependencies: ['step-1']\n                }])\n              }));\n            } else {\n              node.expand();\n            }\n          }}\n          type=\"link\"\n        />\n      )}\n    </div>\n  );\n}\n\nfunction SampleNode({ node, niceDag }) {\n  return (\n    <div className=\"complex-sample-node\">\n      {node.children?.length > 0 && !node.collapse ? (\n        <GroupControl node={node} niceDag={niceDag} />\n      ) : (\n        <NodeControl node={node} niceDag={niceDag} />\n      )}\n      <Connector type=\"in\" />\n      <Connector type=\"out\" />\n    </div>\n  );\n}\n\nconst getNodeSize = node => {\n  if (node.id === 'start' || node.id === 'end' || node.joint) {\n    return {\n      width: CIRCLE_W_H,\n      height: CIRCLE_W_H,\n    };\n  }\n  return {\n    width: NODE_WIDTH,\n    height: NODE_HEIGHT,\n  };\n};\n\nconst NODE_COMP_MAPPER = {\n  start: StartNode,\n  end: EndNode,\n};\n\nconst renderNode = ({ node, niceDag }) => {\n  let Comp = NODE_COMP_MAPPER[node.id] || SampleNode;\n  if (node.joint) {\n    Comp = Joint;\n  }\n  return <Comp node={node} niceDag={niceDag} />;\n};\n\nconst renderEdge = ({ edge, niceDag }) => {\n  return <div className=\"complex-sample-edge-label\">to</div>;\n};\n\nfunction mapEdgeToPoints(edge) {\n  const { source, target } = edge;\n  let edgeSource = {\n    x: source.x + source.width,\n    y: source.y + source.height / 2,\n  };\n  let edgeTarget = {\n    x: target.x,\n    y: target.y + target.height / 2,\n  };\n  if (source.joint || source.id.indexOf('start') !== -1) {\n    edgeSource = {\n      x: source.x + source.width / 2,\n      y: source.y + source.height / 2,\n    };\n  } else if (target.joint || target.id.indexOf('end') !== -1) {\n    edgeTarget = {\n      x: target.x + target.width / 2,\n      y: target.y + target.height / 2,\n    };\n  }\n  return {\n    source: edgeSource,\n    target: edgeTarget,\n  };\n}\n\nexport default function ComplexView() {\n  const { niceDag, niceDagEl, render } = useNiceDag({\n    initNodes: ComplexFlattenModel,\n    modelType: 'FLATTEN',\n    getNodeSize,\n    renderNode,\n    mapEdgeToPoints,\n    renderEdge,\n  });\n  useEffect(() => {\n    if (niceDag) {\n      const bounds = niceDagEl.current.getBoundingClientRect();\n      niceDag.center({\n        width: bounds.width,\n        height: 400,\n      });\n    }\n  }, [niceDag, niceDagEl]);\n  return (\n    <div className=\"complex-sample\">\n      <div>\n        <Space>\n          <ZoomInOutSlider onScaleChange={value => niceDag.setScale(value / 100)} />\n        </Space>\n      </div>\n      <div className=\"complex-sample-nice-dag-wrapper\" ref={niceDagEl} />\n      {render()}\n    </div>\n  );\n}\n","ComplexHierarchicalView.less":"@import '../../styles/mixins';\n@conector-size: 16px;\n\n.complex-sample {\n  .ant-slider {\n    min-width: 180px;\n  }\n  &-edge-label {\n    text-align: center;\n    margin-top: -20px;\n  }\n  &-start-node,\n  &-end-node,\n  &-joint-node {\n    border: 1px solid black;\n    border-radius: 50%;\n    width: 30px;\n    height: 30px;\n    background: white;\n  }\n\n  &-joint-node {\n    font-size: 18px;\n    display: flex;\n    align-content: center;\n    justify-content: center;\n    align-items: center;\n  }\n\n  &-end-node::before {\n    content: '';\n    position: absolute;\n    border: 1px solid black;\n    border-radius: 50%;\n    background: black;\n    top: 5px;\n    left: 5px;\n    width: 20px;\n    height: 20px;\n  }\n\n  &-connector {\n    &-in,\n    &-out {\n      width: @conector-size;\n      height: @conector-size;\n      border: 1px solid black;\n      border-radius: 50%;\n      position: absolute;\n      margin: auto;\n      top: 0;\n      bottom: 0;\n      background: white;\n    }\n\n    &-in {\n      left: @conector-size / -2;\n    }\n    &-out {\n      right: @conector-size / -2;\n    }\n  }\n\n  &-node {\n    width: 100%;\n    height: 100%;\n    &-group-content,\n    &-content {\n      position: relative;\n      width: 100%;\n      height: 100%;\n      border: 1px solid #8799c1;\n      border-radius: 10px;\n      display: flex;\n      flex-direction: column;\n    }\n    &-group-content {\n      padding: 4px 20px;\n      > div {\n        height: 30px;\n\n        a {\n          margin-left: 6px;\n          font-size: 16px;\n        }\n      }\n    }\n    &-content {\n      align-items: center;\n      justify-content: center;\n    }\n  }\n\n  &-nice-dag-wrapper {\n    height: 400px;\n  }\n}","ComplexHierarchicalViewData.js":"export const ComplexFlattenModel = [\n    {\n        id: 'start',\n    },\n    {\n        id: 'parent',\n        dependencies: ['start'],\n        data: {\n            label: 'Parent',\n        },\n    },\n    {\n        id: 'child-1',\n        data: {\n            label: 'Child-1',\n        },\n        parentId: 'parent'\n    },\n    {\n        id: 'child-2',\n        dependencies: ['child-1'],\n        data: {\n            label: 'Child-2',\n        },\n        parentId: 'parent'\n    },\n    {\n        id: 'child-1-1',\n        data: {\n            label: 'Child-1-1',\n        },\n        parentId: 'child-1'\n    },\n    {\n        id: 'end',\n        dependencies: ['parent'],\n    },\n];"};function l(e){var n=e.filename;return Object(o.useEffect)(function(){window.Prism&&window.Prism.highlightAll()},[n]),r.a.createElement("pre",null,r.a.createElement("code",{className:"language-jsx line-numbers"},s[n]||'// Error: code of "'.concat(n,'" not found')))}var c,h,u,p,g,f,m=t(391),y=t(28),v=t.n(y);!function(e){e.REMOVE_SUB_VIEW="REMOVE_SUB_VIEW",e.ADD_SUB_VIEW="ADD_SUB_VIEW",e.RESIZE="RESIZE",e.ADD_NODE="ADD_NODE",e.REMOVE_NODE="REMOVE_NODE",e.ADD_EDGE="ADD_EDGE",e.REMOVE_EDGE="REMOVE_EDGE"}(c||(c={})),function(e){e.SHRINK_NODE="SHRINK_NODE",e.EXPAND_NODE="EXPAND_NODE",e.POSITION_CHANGE="POSITION_CHANGE",e.RESIZE="RESIZE",e.REMOVED="REMOVED",e.ADD_CHILD_NODE="ADD_CHILD_NODE"}(h||(h={})),function(e){e.LR="LR",e.RL="RL",e.TB="TB",e.BT="BT"}(u||(u={})),function(e){e.CENTER_OF_BORDER="CENTER_OF_BORDER",e.CENTER="CENTER"}(p||(p={})),function(e){e.HIERARCHY="HIERARCHY",e.FLATTEN="FLATTEN"}(g||(g={})),function(e){e.DEFAULT="DEFAULT",e.WITH_JOINT_NODES="WITH_JOINT_NODES"}(f||(f={}));var E=function(){return(E=Object.assign||function(e){for(var n,t=1,i=arguments.length;t<i;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)},b=function(e,n,t){if(t||2===arguments.length)for(var i,o=0,r=n.length;o<r;o++)!i&&o in n||(i||(i=Array.prototype.slice.call(n,0,o)),i[o]=n[o]);return e.concat(i||Array.prototype.slice.call(n))};var w=function(){function e(e,n){void 0===n&&(n=!1);var t=this;this.withStyle=function(e){return Object.keys(e).forEach(function(n){t.pElement.style[n]=e[n]}),t},this.withAttributes=function(e){return Object.keys(e).forEach(function(n){t.pElement.setAttribute(n,e[n])}),t},this.withAbsolutePoint=function(e){return t.pElement.style.position="absolute",t.pElement.style.top="".concat(e.y,"px"),t.pElement.style.left="".concat(e.x,"px"),t},this.withAbsolutePosition=function(e){return t.pElement.style.position="absolute",t.pElement.style.top="".concat(e.y,"px"),t.pElement.style.left="".concat(e.x,"px"),t.pElement.style.width="".concat(e.width,"px"),t.pElement.style.height="".concat(e.height,"px"),t},this.withSize=function(e){return t.pElement.style.width="".concat(e.width,"px"),t.pElement.style.height="".concat(e.height,"px"),t},this.withWidth=function(e){return t.pElement.style.width="".concat(e,"px"),t},this.withHeight=function(e){return t.pElement.style.height="".concat(e,"px"),t},this.withClassNames=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return e.forEach(function(e){t.pElement.classList.add(e)}),t},this.pElement=e,this._exists=n}return Object.defineProperty(e.prototype,"alreadyExists",{get:function(){return this._exists},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"htmlElement",{get:function(){return this.pElement},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"svgElement",{get:function(){return this.pElement},enumerable:!1,configurable:!0}),e}();function x(e){return new w(e)}function N(e){var n=document.createElement("div");return e&&e.appendChild(n),new w(n)}function C(e,n){var t=e.querySelector(".".concat(n)),i=!!t;return t||((t=document.createElement("div")).classList.add(n),e.appendChild(t)),new w(t,i)}function D(e,n){var t=document.createElementNS("http://www.w3.org/2000/svg",n);return e&&e.appendChild(t),new w(t)}function O(e,n,t){void 0===n&&(n=":scope>svg"),void 0===t&&(t="nice-dag-svg-arrow");var i=n?e.querySelector(n):null;if(!i){(i=document.createElementNS("http://www.w3.org/2000/svg","svg")).style.overflow="hidden";var o=document.createElementNS("http://www.w3.org/2000/svg","defs"),r=document.createElementNS("http://www.w3.org/2000/svg","marker"),a=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("id",t),r.setAttribute("markerUnits","strokeWidth"),r.setAttribute("markerWidth","12"),r.setAttribute("markerHeight","12"),r.setAttribute("viewBox","0 0 12 12"),r.setAttribute("refX","6"),r.setAttribute("refY","6"),r.setAttribute("orient","auto"),a.setAttribute("d","M2,2 L10,6 L2,10 L6,6 L2,2"),a.setAttribute("fill","#000"),r.appendChild(a),o.appendChild(r),i.appendChild(o),e.appendChild(i)}return new w(i)}function S(e){return!e||0===e.length}function L(e){return parseInt("".concat(Math.round(e+Number.EPSILON)))}function _(e,n){return 1!==n&&n?{x:L(e.x/n),y:L(e.y/n),top:L(e.top/n),left:L(e.left/n),width:L(e.width/n),height:L(e.height/n),bottom:L(e.bottom/n),right:L(e.right/n)}:e}function R(e){var n=e.getBoundingClientRect();return{x:n.x,y:n.y,top:n.top,left:n.left,bottom:n.bottom,right:n.right,width:n.width,height:n.height}}function k(e,n){var t=E({},e);return Object.keys(n||{}).forEach(function(e){return t[e]=t[e]||n[e]}),t}var P="nice-dag-node",B="nice-dag-edge",I="data-node-id-key",T="nice-dag-svg-bkg-arrow",M="nice-dag-svg-background",j="nice-dag-svg-dnd-arrow",z="nice-dag-svg-dnd",A="nice-dag-editor-bkg",V={x:0,y:0,width:0,height:0},H=function(){function e(e,n,t,i){var o,r=this;this.listeners=[],this.addNodeChangeListener=function(e){r.listeners.some(function(n){return n===e})||r.listeners.push(e)},this.removeNodeChangeListener=function(e){r.listeners=r.listeners.filter(function(n){return n!==e})},this.fireNodeChange=function(e){r.listeners.forEach(function(n){n.onNodeChange(e)})},this.model=t,this.id=e.id,this.joint=n,this.data=e.data,this.parentId=e.parentId,this.children=e.children,this.dependencies=e.dependencies||[],this.edgeConnectorType=i,this.ref=N().withClassNames(P).withAttributes((o={},o["".concat(I)]=e.id,o)).htmlElement}return e.prototype.resize=function(e){this.width=e.width,this.height=e.height,this.doLayout(),this.fireNodeChange({type:h.RESIZE,node:this})},e.prototype.addChildNode=function(e,n){var t=this.collapse||!this.children||0===this.children.length;this.children||(this.children=[]),this.children.push(e),this.fireNodeChange({type:h.ADD_CHILD_NODE,node:this,data:{point:n,isCollapsed:t,sourceNode:e}})},e.prototype.removeDependency=function(e){var n=this.dependencies.some(function(n){return n===e.id});return this.dependencies=this.dependencies.filter(function(n){return n!==e.id}),n},e.prototype.connect=function(e){var n=this;(null===e||void 0===e?void 0:e.dependencies.some(function(e){return e===n.id}))||(e.dependencies||(e.dependencies=[]),e.dependencies.push(this.id),this.model.addEdge(this,e))},e.prototype.doLayout=function(){x(this.ref).withAbsolutePosition({x:this.x,y:this.y,width:this.width,height:this.height})},e.prototype.setPoint=function(e,n){void 0===n&&(n=!0),this.x=e.x,this.y=e.y,this.ref&&(this.ref.style.left="".concat(this.x,"px"),this.ref.style.top="".concat(this.y,"px")),n&&this.fireNodeChange({type:h.POSITION_CHANGE,node:this})},e.prototype.setBounds=function(e,n){this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this.ref&&(this.ref.style.left="".concat(this.x,"px"),this.ref.style.top="".concat(this.y,"px"),this.ref.style.width="".concat(this.width,"px"),this.ref.style.height="".concat(this.height,"px")),n&&this.fireNodeChange({type:h.POSITION_CHANGE,node:this})},e.prototype.shrink=function(){this.collapse=!0,this.fireNodeChange({type:h.SHRINK_NODE,node:this})},e.prototype.expand=function(){this.collapse=!1,this.fireNodeChange({type:h.EXPAND_NODE,node:this})},e.prototype.withChildren=function(e,n){var t=this;void 0===n&&(n=!0),this.children&&n?this.expand():e.then(function(e){t.children=e,t.expand()})},e.prototype.refresh=function(){},e.prototype.remove=function(){var e;null===(e=this.ref)||void 0===e||e.remove(),this.fireNodeChange({type:h.REMOVED,node:this}),this.destory()},e.prototype.destory=function(){this.listeners=[],this.ref=null},e}(),G={};function W(e){return G[e]}var F=function(){function e(e,n){this.source=e,this.target=n,this.pathRef=D(null,"path").withAttributes({"data-source-key":e.id,"data-target-key":n.id}).svgElement,this.ref=N().withClassNames(B).withAbsolutePosition(V).htmlElement,this.source.addNodeChangeListener(this),this.target.addNodeChangeListener(this)}return e.prototype.destory=function(){this.source=null,this.target=null,this.pathRef=null,this.ref=null},e.prototype.onNodeChange=function(e){e.type===h.POSITION_CHANGE||e.type===h.RESIZE||e.type===h.EXPAND_NODE||e.type===h.SHRINK_NODE?this.doLayout():e.type===h.REMOVED&&(e.node===this.source&&this.target.removeDependency(this.source),this.ref.remove(),this.pathRef.remove())},e.prototype.insertNodes=function(e,n){var t=this;void 0===n&&(n=40);var i=this.getInsertNodesStartPosition(e,n);this.remove(),this.target.model.addNodes(e,i,n).forEach(function(e){t.source.connect(e),e.connect(t.target)}),this.destory()},e.prototype.getInsertNodesStartPosition=function(e,n){var t=W(this.source.model.dagId).config,i=t.graphLabel,o=t.getNodeSize,r=(0,t.mapEdgeToPoints)(this),a=r.source,d=r.target,s=(a.x+d.x)/2,l=(a.y+d.y)/2,c=0,h=0,p=0,g=0,f=function(e){return u[e.rankdir||"LR"]}(i);return e.forEach(function(e){var t=o(e);f===u.LR||f===u.RL?h+=t.height+n:c+=t.width+n,p=Math.max(c,t.width),g=Math.max(h,t.height)}),h-=n,c-=n,f===u.LR||f===u.RL?{x:s-p/2,y:l-h/2}:{x:s-c/2,y:l-g/2}},e.prototype.remove=function(){this.target.removeDependency(this.source),this.target.model.removeEdge(this),this.target.removeNodeChangeListener(this),this.source.removeNodeChangeListener(this),this.pathRef.remove(),this.ref.remove()},e.prototype.doLayout=function(){var e=(0,W(this.source.model.dagId).config.mapEdgeToPoints)(this),n=e.source,t=e.target,i=(n.x+t.x)/2,o=(n.y+t.y)/2,r="M".concat(n.x,",").concat(n.y," L").concat(i,",").concat(o," L").concat(t.x,",").concat(t.y);x(this.pathRef).withAttributes({d:r});var a,d,s=Math.sqrt((t.x-n.x)*(t.x-n.x)+(t.y-n.y)*(t.y-n.y)),l="rotate(".concat((a=t.y-n.y,d=t.x-n.x,180*Math.atan(a/d)/Math.PI),"deg)");x(this.ref).withAbsolutePosition({x:i-s/2,y:o-6,width:s,height:12}).withStyle({webkitTransform:l,mozTransform:l,msTransform:l,oTransform:l,transform:l})},e}(),Z=t(134),X=t.n(Z),J=function(e,n,t){if(t||2===arguments.length)for(var i,o=0,r=n.length;o<r;o++)!i&&o in n||(i||(i=Array.prototype.slice.call(n,0,o)),i[o]=n[o]);return e.concat(i||Array.prototype.slice.call(n))};var Y=function(){function e(e){var n=e.dagId,t=e.id,i=e.nodes,o=e.vmConfig,r=e.isRootModel,a=this;this.listeners=[],this.onNodeChange=function(e){if(e.type===h.EXPAND_NODE)a.setNodeCollapse(e.node,!1);else if(e.type===h.SHRINK_NODE)a.setNodeCollapse(e.node,!0);else if(e.type===h.ADD_CHILD_NODE){var n=e.data,t=n.isCollapsed,i=n.point,o=n.sourceNode;if(a.fireModelChange({source:a,originalSource:e.node,type:c.ADD_NODE}),t)a.setNodeCollapse(e.node,!1);else a.pChildVMs.find(function(n){return n.id===e.node.id}).addNode(o,i)}else e.type===h.POSITION_CHANGE||e.type===h.RESIZE?a.doLayout(!0,!1):e.type===h.REMOVED&&(a.pChildVMs=a.pChildVMs.filter(function(n){return n.id!==e.node.id}),a.vNodes=a.vNodes.filter(function(n){return n.id!==e.node.id}),a.pEdges=a.pEdges.filter(function(n){return!(n.source.id===e.node.id||n.target.id===e.node.id)}),a.fireModelChange({source:a,originalSource:e.node,type:c.REMOVE_NODE}))},this.addModelChangeListener=function(e){a.listeners.some(function(n){return n===e})||a.listeners.push(e)},this.removeNodeChangeListener=function(e){a.listeners=a.listeners.filter(function(n){return n===e})},this.isSubViewNode=function(e){var n;return!S(null===(n=a.pChildVMs)||void 0===n?void 0:n.filter(function(n){return n.id===e}))},this.findNodeById=function(e){var n=a.vNodes.find(function(n){return n.id===e});if(!n&&!S(a.pChildVMs))for(var t=0;t<a.pChildVMs.length&&!(n=a.pChildVMs[t].findNodeById(e));t++);return n},this.init=function(e){a.buildVNodes(e),a.buildEdges(),a.doLayout(!1,!1)},this.setNodeCollapse=function(e,n){var t,i=W(a.dagId).config.getNodeSize;if(n)a.pChildVMs=a.pChildVMs.filter(function(n){return n.id!==e.id}),t=i(e);else{var o=a.createChildVm(e,e.children);a.pChildVMs=J(J([],a.pChildVMs.filter(function(e){return e.id!==o.id}),!0),[o],!1),t=o.size()}e.width=t.width,e.height=t.height;var r=e.editing;e.editing=!1,a.doLayout(!0,!1),e.editing=r,a.fireModelChange({source:a,originalSource:e,type:n?c.REMOVE_SUB_VIEW:c.ADD_SUB_VIEW}),W(a._dagId).fireNiceDagChange()},this.fireModelChange=function(e){a.listeners.forEach(function(n){n.onModelChange(e)})},this.withJointNodes=function(){var e=[],n=function(e){void 0===e&&(e=[]);var n=[];e.forEach(function(e){n=b(b([],n,!0),e.dependencies||[],!0)});var t=new Set(n);return e.filter(function(e){return!t.has(e.id)})}(a.vNodes),t=new Set;return a.vNodes.forEach(function(i){var o,r=n.some(function(e){return e.id===i.id});if((null===(o=i.dependencies)||void 0===o?void 0:o.length)>1&&!r){var d="joint-".concat(i.dependencies.join("-"));if(!t.has(d)){var s=new H({id:d,dependencies:i.dependencies},!0,a,a.vmConfig.jointEdgeConnectorType);s.addNodeChangeListener(a),e.push(s),t.add(d)}i.dependencies=[d]}}),J(J([],a.vNodes,!0),e,!0)},this.buildVNodes=function(e){a.vNodes=e.map(function(e){return a.toViewNode(e)}),a.vmConfig.mode===f.WITH_JOINT_NODES&&(a.vNodes=a.withJointNodes()),a.withNodeSize()},this.withNodeSize=function(){var e={},n=W(a.dagId).config.getNodeSize;a.pChildVMs.forEach(function(n){return e[n.id]=n}),a.vNodes.forEach(function(t){var i=e[t.id]&&!t.collapse?e[t.id].size():n(t);t.width=i.width,t.height=i.height})},this.resize=function(e){var n=a.pSize,t=a.vmConfig.subViewPadding,i=0,o=0;a.vNodes.forEach(function(e){i=Math.max(e.x+e.width,i),o=Math.max(e.y+e.height,o)}),a.isRoot?a.pSize={width:i,height:o}:a.pSize={width:i+t.left+t.right,height:o+t.top+t.bottom},e&&(a.pSize.width===n.width&&a.pSize.height===n.height||a.fireModelChange({source:a,type:c.RESIZE}))},this.doLayout=function(e,n){n&&a.childVMs.forEach(function(t){t.doLayout(e,n),a.vNodes.find(function(e){return e.id===t.id}).resize(t.size())});var t=function(e,n){var t=new X.a.graphlib.Graph;t.setGraph(n),t.setDefaultEdgeLabel(function(){return{}});for(var i={},o=0;o<e.length;o++){var r=e[o];t.setNode("".concat(o),{width:r.width,height:r.height}),i[r.id]=o}return e.forEach(function(e){e.dependencies&&!S(e.dependencies)&&e.dependencies.filter(Boolean).forEach(function(n){t.setEdge(i[n],i[e.id])})}),X.a.layout(t),t}(a.vNodes,W(a.dagId).config.graphLabel),i=0;a.vNodes.forEach(function(e){if(!e.editing){var n=t.node(String(i)),o=e.width,r=e.height,a=n.x-o/2,d=n.y-r/2;e.x=a,e.y=d,e.doLayout()}i++}),a.resize(e),a.pEdges.forEach(function(e){e.doLayout()})},this.buildEdges=function(){a.pEdges=[];var e={};a.vNodes.forEach(function(n){return e[n.id]=n}),a.vNodes.forEach(function(n){S(n.dependencies)||n.dependencies.forEach(function(t){a.pEdges.push(new F(e[t],n))})})},this.size=function(e){if(void 0===e&&(e=!0),e||a.isRoot)return a.pSize;var n=a.vmConfig.subViewPadding;return{width:a.pSize.width-n.left-n.right,height:a.pSize.height-n.top-n.bottom}};var d=i;this._dagId=n,this.pId=t,this.vmConfig=o,this.isRootModel=r,this.pChildVMs=d.filter(function(e){return!e.collapse&&!S(e.children)}).map(function(e){return a.createChildVm(e,e.children)}),this.init(d)}return e.prototype.setRootOffset=function(e){var n=e.offsetX,t=e.offsetY;if(!this.isRoot)throw new Error("Sub model doesn't support the method.");this.vNodes.forEach(function(e){e.x+=n,e.y+=t,e.doLayout()}),this.pEdges.forEach(function(e){e.doLayout()})},e.prototype.addNodes=function(e,n,t){var i=this;void 0===t&&(t=40);var o=0,r=W(this.dagId).config.getNodeSize;return e.map(function(e){var a=r(e),d={x:n.x,y:n.y+o};return o+=t+a.height,i.addNode(e,d)})},e.prototype.addNode=function(e,n,t){var i=this.toViewNode(e);i.editing=!0,i.joint=t;var o=W(this.dagId).config.getNodeSize;this.vNodes.push(i);var r=o(i);return i.width=r.width,i.height=r.height,i.x=n.x,i.y=n.y,this.fireModelChange({source:this,originalSource:i,type:c.ADD_NODE}),e.collapse||S(e.children)?(i.fireNodeChange({type:h.POSITION_CHANGE,node:i}),W(this._dagId).fireNiceDagChange()):i.expand(),i},e.prototype.destory=function(){this.vNodes.forEach(function(e){return e.destory()}),this.pEdges.forEach(function(e){return e.destory()}),this.pChildVMs.forEach(function(e){return e.destory()}),this.listeners=[]},e.prototype.removeEdge=function(e){return!!this.pEdges.some(function(n){return n===e})&&(this.pEdges=this.pEdges.filter(function(n){return n!==e}),W(this._dagId).fireNiceDagChange(),!0)},e.prototype.refreshJointNodes=function(){var e=this;if(this.vmConfig.mode===f.WITH_JOINT_NODES){var n=this.vNodes.filter(function(e){return e.joint&&1===e.dependencies.length}),t=new Set(n.map(function(e){return e.id})),i=this.vNodes.filter(function(e){return e.dependencies.some(function(e){return t.has(e)})});n.forEach(function(n){var t=n.dependencies,o=e.findNodeById(t[0]);i.filter(function(e){return e.dependencies.some(function(e){return e===n.id})}).forEach(function(n){n.dependencies.push(o.id),e.createEdgeAndFireModelChange(o,n)})}),n.forEach(function(e){e.remove()})}},e.prototype.createEdgeAndFireModelChange=function(e,n){var t=new F(e,n);return this.pEdges.push(t),this.fireModelChange({source:this,originalSource:t,type:c.ADD_EDGE}),t.doLayout(),t},e.prototype.findPrecedentedNodes=function(e){var n=this;return this.pEdges.filter(function(n){return n.target.id===e.id}).map(function(e){return n.findNodeById(e.source.id)})},e.prototype.addEdge=function(e,n){var t=this.createEdgeAndFireModelChange(e,n);return W(this._dagId).fireNiceDagChange(),t},e.prototype.onModelChange=function(e){e.source.id!==this.id&&(e.type===c.RESIZE&&this.vNodes.find(function(n){return n.id===e.source.id}).resize(e.source.size()))},e.prototype.createChildVm=function(n,t){var i=new e({dagId:this._dagId,id:n.id,nodes:t,vmConfig:this.vmConfig});return i.addModelChangeListener(this),i},Object.defineProperty(e.prototype,"isRoot",{get:function(){return this.isRootModel},enumerable:!1,configurable:!0}),e.prototype.getAllNodes=function(){var e,n=J([],this.vNodes,!0);return null===(e=this.pChildVMs)||void 0===e||e.forEach(function(e){n=J(J([],n,!0),e.getAllNodes(),!0)}),n},e.prototype.getAllEdges=function(){var e,n=J([],this.edges,!0);return null===(e=this.pChildVMs)||void 0===e||e.forEach(function(e){n=J(J([],n,!0),e.getAllEdges(),!0)}),n},Object.defineProperty(e.prototype,"dagId",{get:function(){return this._dagId},enumerable:!1,configurable:!0}),e.prototype.toViewNode=function(e){var n=new H(e,!1,this,e.edgeConnectorType||this.vmConfig.edgeConnectorType);return n.addNodeChangeListener(this),n},Object.defineProperty(e.prototype,"subViewPadding",{get:function(){return this.vmConfig.subViewPadding},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.pId},enumerable:!1,configurable:!0}),e.prototype.get=function(){return this.pSize},Object.defineProperty(e.prototype,"childVMs",{get:function(){return this.pChildVMs},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nodes",{get:function(){return this.vNodes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"edges",{get:function(){return this.pEdges},enumerable:!1,configurable:!0}),e}(),q=function(){return(q=Object.assign||function(e){for(var n,t=1,i=arguments.length;t<i;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)},U={rankdir:"LR",ranksep:60,edgesep:10},$={color:"blue",size:40},K={top:40,bottom:20,left:20,right:20},Q={top:0,bottom:0,left:0,right:0},ee={color:"black"};function ne(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}var te={LR:function(e){var n=e.source,t=e.target;return{source:n.edgeConnectorType===p.CENTER?ne(n):{x:n.x+n.width,y:n.y+n.height/2},target:t.edgeConnectorType===p.CENTER?ne(t):{x:t.x,y:t.y+t.height/2}}},RL:function(e){var n=e.source,t=e.target;return{source:n.edgeConnectorType===p.CENTER?ne(n):{x:n.x,y:n.y+n.height/2},target:t.edgeConnectorType===p.CENTER?ne(t):{x:t.x+t.width,y:t.y+t.height/2}}},BT:function(e){var n=e.source,t=e.target;return{source:n.edgeConnectorType===p.CENTER?ne(n):{x:n.x+n.width/2,y:n.y},target:t.edgeConnectorType===p.CENTER?ne(t):{x:t.x+t.width/2,y:t.y+t.height}}},TB:function(e){var n=e.source,t=e.target;return{source:n.edgeConnectorType===p.CENTER?ne(n):{x:n.x+n.width/2,y:n.y+n.height},target:t.edgeConnectorType===p.CENTER?ne(t):{x:t.x+t.width/2,y:t.y}}}};function ie(){return ee}var oe=t(192),re=t.n(oe),ae={position:"fixed",top:"0",left:"0",right:"0",bottom:"0",zIndex:"9999",display:"none","user-select":"none",cursor:"pointer"},de="minimap-dnd-glass",se=function(){function e(e){var n=this;this.listeners=[],this.onCanvasReady=function(e){var t=n,i=t.mainLayer,o=t.zoomLayer,r=t.viewBoxElm,a=t.minimapContent,d=t.scale,s=i.scrollLeft,l=i.scrollTop,c=i.offsetWidth>o.offsetWidth?1:i.offsetWidth/o.offsetWidth,h=i.offsetHeight>o.offsetHeight?1:i.offsetHeight/o.offsetHeight,u=Math.ceil(e.width*c),p=Math.ceil(e.height*h),g=Math.ceil(s*d*c),f=Math.ceil(l*d*h);x(r).withStyle({border:"1px red solid",position:"absolute",width:"".concat(u,"px"),height:"".concat(p,"px"),left:"".concat(g,"px"),top:"".concat(f,"px"),cursor:"pointer",zIndex:999,display:"block"}),a.appendChild(r),a.appendChild(e)},this.updateViewBoxPosition=function(){var e=n.mainLayer.scrollLeft,t=n.mainLayer.scrollTop,i=n.canvas.width-n.viewBoxElm.offsetWidth,o=n.canvas.height-n.viewBoxElm.offsetHeight,r=n.scale*e;r=Math.max(0,r),r=Math.min(r,i);var a=n.scale*t;a=Math.max(0,a),a=Math.min(a,o),x(n.viewBoxElm).withStyle({left:"".concat(Math.ceil(r),"px"),top:"".concat(Math.ceil(a),"px")})},this.startViewBoxDragging=function(e){n.initClientX=e.clientX,n.initClientY=e.clientY,n.viewBoxInitX=n.viewBoxElm.offsetLeft,n.viewBoxInitY=n.viewBoxElm.offsetTop,x(n.dndGlass).withStyle({display:"block"})},this.onViewBoxDragging=function(e){var t=e.clientX-n.initClientX,i=e.clientY-n.initClientY,o=n.canvas.width-n.viewBoxElm.offsetWidth/n.viewBoxScale,r=n.canvas.height-n.viewBoxElm.offsetHeight/n.viewBoxScale,a=n.viewBoxInitX+t,d=n.viewBoxInitY+i;a=Math.max(0,a),a=Math.min(a,o),d=Math.max(0,d),d=Math.min(d,r),n.viewBoxElm.style.left="".concat(Math.ceil(a),"px"),n.viewBoxElm.style.top="".concat(Math.ceil(d),"px"),n.listeners.forEach(function(e){e.onMinimapDragging({scrollLeft:a/n.scale,scrollTop:d/n.scale})})},this.onViewBoxDraggingEnd=function(){x(n.dndGlass).withStyle({display:"none"})},this.viewBoxScale=1,this.mainLayer=e.mainLayer,this.zoomLayer=e.zoomLayer,this.parentContainer=e.container,this.viewBoxElm=this.createViewBoxElement(null===e||void 0===e?void 0:e.viewBoxClassName),this.canvas=document.createElement("canvas"),this.contentContainer=N(this.parentContainer).withStyle({position:"relative",width:"100%",height:"100%",display:"flex","justify-content":"center","place-content":"center","align-content":"center","flex-wrap":"nowrap","flex-direction":"column","align-items":"center"}).htmlElement,this.minimapContent=this.createMinimapElement(null===e||void 0===e?void 0:e.className);var t=C(this.mainLayer,de).withStyle(ae);t.htmlElement.addEventListener("mousemove",this.onViewBoxDragging),t.htmlElement.addEventListener("mouseup",this.onViewBoxDraggingEnd),this.dndGlass=t.htmlElement}return e.prototype.addMinimapListener=function(e){this.listeners.push(e)},e.prototype.createMinimapElement=function(e){var n=N(this.contentContainer).withClassNames("nice-dag-minimap").withStyle({position:"relative"}).htmlElement;return e&&n.classList.add(e),n},e.prototype.createViewBoxElement=function(e){var n=N(this.contentContainer).withClassNames("nice-dag-minimap").withStyle({position:"relative"}).htmlElement;return n.classList.add("nice-dag-minimap-viewbox"),e&&n.classList.add(e),n.addEventListener("mousedown",this.startViewBoxDragging),n},e.prototype.calcRatio=function(){var e=function(e){var n=getComputedStyle(e);return{height:e.clientHeight-parseFloat(n.paddingTop)-parseFloat(n.paddingBottom),width:e.clientWidth-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)}}(this.parentContainer),n=this.zoomLayer.getBoundingClientRect(),t=n.width/n.height;this.scale=t>1?e.width/n.width:e.height/n.height},e.prototype.useWidth=function(){var e=this.zoomLayer.getBoundingClientRect();return e.width/e.height>1},e.prototype.render=function(){var e=this;this.clear(),this.calcRatio();var n=this.parentContainer.getBoundingClientRect(),t=this.zoomLayer,i=t.getBoundingClientRect().width*this.scale,o=t.getBoundingClientRect().height*this.scale;x(this.viewBoxElm).withStyle({display:"none"}),this.useWidth()?(this.canvas.style.width="100%",x(this.minimapContent).withStyle({width:"100%",height:"auto"}),this.canvas.style.top="".concat(L((n.height-o)/2),"px")):(this.canvas.style.height="100%",x(this.minimapContent).withStyle({width:"auto",height:"100%"}),this.canvas.style.left="".concat(L((n.width-i)/2),"px")),this.canvas.width=Math.ceil(i),this.canvas.height=Math.ceil(o);var r=setTimeout(function(){window.clearTimeout(r),re()(t,{useCORS:!0,scale:e.scale,canvas:e.canvas,scrollY:0,scrollX:0}).then(e.onCanvasReady)},50)},e.prototype.destory=function(){this.listeners=[],this.clear()},e.prototype.clear=function(){this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height)},e.prototype.setViewBoxScale=function(e){this.viewBoxScale=e;var n=this.viewBoxElm,t=this.canvas.width/n.offsetWidth,i=this.canvas.height/n.offsetHeight,o=Math.min(1/e,t),r=Math.min(1/e,i);n.style.transform="scale(".concat(o,", ").concat(r,")"),n.style.transformOrigin="left top"},e}(),le=function(){return(le=Object.assign||function(e){for(var n,t=1,i=arguments.length;t<i;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)},ce=function(e,n){var t={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&n.indexOf(i)<0&&(t[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)n.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(t[i[o]]=e[i[o]])}return t},he="nice-dag-main-layer",ue="nice-dag-zoom-layer",pe="nice-dag-content-layer",ge="nice-dag-nodes-layer",fe={position:"relative",height:"100%",width:"100%"};function me(e){var n,t,i=function(e){return e?q(q({},e),{rankdir:e.rankdir||U.rankdir,ranksep:e.ranksep||U.ranksep,edgesep:e.edgesep||U.edgesep}):U}(e.graphLabel),o=(n=e.subViewPadding,void 0===(t=K)&&(t=Q),{top:(null===n||void 0===n?void 0:n.top)||t.top,left:(null===n||void 0===n?void 0:n.left)||t.left,bottom:(null===n||void 0===n?void 0:n.bottom)||t.bottom,right:(null===n||void 0===n?void 0:n.right)||t.right});return le(le({},e),{getEdgeAttributes:e.getEdgeAttributes||ie,gridSize:e.gridSize||40,graphLabel:i,mode:e.mode||f.WITH_JOINT_NODES,subViewPadding:o,gridConfig:k(e.gridConfig,$),edgeConnectorType:e.edgeConnectorType||p.CENTER_OF_BORDER,jointEdgeConnectorType:e.jointEdgeConnectorType||p.CENTER})}var ye,ve,Ee=function(){function e(n){var t,i=n.viewConfig,o=n.model,r=this;this.appendNode=function(e){r.nodesLayer.appendChild(e.ref),r.viewConfig.mapNodeToElement&&e.ref.appendChild(r.viewConfig.mapNodeToElement(e))},this.getEdgeLabel=function(e,n){throw new Error("Can't support the method with ".concat(e,", ").concat(n))},this.renderEdge=function(e){var n=e.pathRef,t=r.viewConfig.getEdgeAttributes(e),i=x(n).withAttributes({stroke:t&&t.color?t.color:"rgb(204, 204, 204)"}).svgElement;t.hideArrow||i.setAttribute("marker-mid","url(#".concat(r.model.dagId,"-nice-dag-svg-arrow)"))},this.getNodeLayerSizeStyle=function(){var e=r.model.size(!1);return{position:"relative",width:"".concat(e.width,"px"),height:"".concat(e.height,"px"),"z-index":"1"}},this.getContentLayerStyle=function(){var e=r.model.size();return{position:"absolute",top:0,left:0,height:"".concat(e.height,"px"),width:"".concat(e.width,"px")}},this.render=function(e){if(!r.model.isRoot){var n=r.viewConfig.subViewPadding;x(e).withStyle({"padding-top":"".concat(n.top,"px"),"padding-bottom":"".concat(n.bottom,"px"),"padding-left":"".concat(n.left,"px"),"padding-right":"".concat(n.right,"px")})}r.nodesLayer=N(e).withStyle(r.getNodeLayerSizeStyle()).withClassNames(ge).htmlElement,r.svgLayer=O(r.nodesLayer,null,"".concat(r.model.dagId,"-nice-dag-svg-arrow")).withAttributes({width:"100%",height:"100%"}).svgElement,r.contentLayer=N(e).withStyle(r.getContentLayerStyle()).withClassNames(pe).htmlElement;var t={};r.model.nodes.forEach(function(e){r.appendNode(e),S(e.children)||e.collapse||(t[e.id]=e.ref,e.ref.setAttribute("data-subview-key","true"))}),r.model.edges.forEach(function(e){r.svgLayer.appendChild(e.pathRef),r.nodesLayer.appendChild(e.ref),r.renderEdge(e)}),S(r.subViews)||r.subViews.forEach(function(e){e.render(t[e.model.id])})},this.resize=function(){x(r.nodesLayer).withStyle(r.getNodeLayerSizeStyle()),x(r.contentLayer).withStyle(r.getContentLayerStyle())},this.destory=function(){r.clear(),r.model.removeNodeChangeListener(r)},this.viewConfig=i,this.model=o,this.model.addModelChangeListener(this),this.subViews=null===(t=this.model.childVMs)||void 0===t?void 0:t.map(function(n){return new e({viewConfig:i,model:n})})}return e.prototype.justifySize=function(e){e.width>0&&(this.nodesLayer.style.width="".concat(e.width,"px"),this.contentLayer.style.width="".concat(e.width,"px")),e.height>0&&(this.nodesLayer.style.height="".concat(e.height,"px"),this.contentLayer.style.height="".concat(e.height,"px"))},e.prototype.clear=function(){var e,n;x(this.nodesLayer.parentElement).withStyle({"padding-top":0,"padding-bottom":0,"padding-left":0,"padding-right":0}),null===(e=this.nodesLayer)||void 0===e||e.remove(),null===(n=this.contentLayer)||void 0===n||n.remove()},e.prototype.onModelChange=function(n){var t,i,o,r=this;if(n.type===c.REMOVE_SUB_VIEW)(null===(t=this.subViews)||void 0===t?void 0:t.find(function(e){return e.model.id===n.originalSource.id})).destory(),this.subViews=null===(i=this.subViews)||void 0===i?void 0:i.filter(function(e){return e.model.id!=="".concat(n.originalSource.id)});else if(n.type===c.ADD_SUB_VIEW){var a={};this.subViews.forEach(function(e){return a[e.model.id]=e}),this.subViews=null===(o=this.model.childVMs)||void 0===o?void 0:o.map(function(t){var i=a[t.id];if(!i){var o=new e({viewConfig:r.viewConfig,model:t}),d=r.nodesLayer.querySelector("[".concat(I,"='").concat(n.originalSource.id,"']"));o.render(d),i=o}return i})}else n.type===c.RESIZE?this.resize():n.type===c.ADD_EDGE?(this.svgLayer.appendChild(n.originalSource.pathRef),this.nodesLayer.appendChild(n.originalSource.ref),n.originalSource.doLayout(),this.renderEdge(n.originalSource)):n.type===c.ADD_NODE&&(n.originalSource.doLayout(),this.nodesLayer.appendChild(n.originalSource.ref))},e.prototype.getAllNodes=function(){return this.model.getAllNodes()},e.prototype.getAllEdges=function(){return this.model.getAllEdges()},e}(),be=function(){function e(e){var n=this;this.listeners=[],this.findNodeById=function(e){return n.rootModel.findNodeById(e)},this.getElementByNodeId=function(e){var t=n.zoomLayer.querySelector("[".concat(I,"='").concat(e,"']>.").concat(pe));return t||(t=n.zoomLayer.querySelector("[".concat(I,"='").concat(e,"']"))),t},this.getEdgeLabel=function(e,t){return n.rootView.getEdgeLabel(e,t)},this.scrollTo=function(e){var t=n.getElementByNodeId(e),i=n.rootContainer.getBoundingClientRect();if(t){var o=t.getBoundingClientRect();n.mainLayer.scrollTop+=o.y-i.y-i.height/2,n.mainLayer.scrollLeft+=o.x-i.x}},this.getScrollPosition=function(){return{x:n.mainLayer.scrollLeft,y:n.mainLayer.scrollTop}},this.fireNiceDagChange=function(){n.listeners.forEach(function(e){return e.onChange()}),n.fireMinimapChange()},this.fireMinimapChange=function(){var e;null===(e=n.minimap)||void 0===e||e.render()},this.addNiceDagChangeListener=function(e){return n.listeners.every(function(n){return n!==e})&&n.listeners.push(e),!1},this.removeNiceDagChangeListener=function(e){return n.listeners.some(function(n){return n===e})&&(n.listeners=n.listeners.filter(function(n){return n===e})),!1},this.onMainLayerScroll=function(){var e;null===(e=n.minimap)||void 0===e||e.updateViewBoxPosition()},this.uid=Math.random().toString(16).slice(2);var t=me(e),i=t.container,o=t.minimapContainer,r=t.minimapConfig,a=ce(t,["container","minimapContainer","minimapConfig"]);this._config=a,this._config.mapEdgeToPoints=e.mapEdgeToPoints,this._config.mapEdgeToPoints||(this._config.mapEdgeToPoints=te[this._config.graphLabel.rankdir],this.useDefaultMapEdgeToPoints=!0),this._rootContainer=i,this.mainLayer=C(this.rootContainer,he).withStyle(le(le({},fe),{overflow:"auto"})).htmlElement,this.mainLayer.addEventListener("scroll",this.onMainLayerScroll),this.zoomLayer=C(this.mainLayer,ue).withStyle({position:"absolute","z-index":1}).htmlElement,o&&(this.minimap=new se(le({mainLayer:this.mainLayer,zoomLayer:this.zoomLayer,container:o},r)),this.minimap.addMinimapListener(this))}return e.prototype.setDirection=function(e){this._config.graphLabel.rankdir=e,this.useDefaultMapEdgeToPoints&&(this._config.mapEdgeToPoints=te[this._config.graphLabel.rankdir]),this.prettifier()},e.prototype.prettifier=function(){this.rootModel.doLayout(!0,!0),this.justifyCenter(this.parentSize),this.fireMinimapChange()},e.prototype.onMinimapDragging=function(e){var n=e.scrollLeft,t=e.scrollTop;this.mainLayer.scrollTop=t,this.mainLayer.scrollLeft=n},e.prototype.onModelChange=function(e){e.type===c.RESIZE&&x(this.zoomLayer).withSize(this.rootView.model.size()),e.type!==c.RESIZE&&e.type!==c.ADD_SUB_VIEW&&e.type!==c.REMOVE_SUB_VIEW||this.justifyCenter(this.parentSize)},Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rootContainer",{get:function(){return this._rootContainer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.uid},enumerable:!1,configurable:!0}),e.prototype.center=function(e){return this.parentSize=e,this.justifyCenter(this.parentSize),this.fireMinimapChange(),this},e.prototype.justifyCenter=function(e){if(e){var n=this.zoomLayer.getBoundingClientRect(),t=0,i=0;e.width>n.width&&(t=(e.width-n.width)/2),e.height>n.height&&(i=(e.height-n.height)/2),this.zoomLayer.style.left="".concat(t,"px"),this.zoomLayer.style.top="".concat(i,"px")}},e.prototype.withNodes=function(e){var n,t,i;null===(n=this.rootModel)||void 0===n||n.destory(),null===(t=this.rootView)||void 0===t||t.clear(),null===(i=this.minimap)||void 0===i||i.clear();var o=this.config.modelType===g.FLATTEN?function(e){if(!e||0===e.length)return[];var n=e.map(function(e){return E(E({},e),{children:[]})}),t={};return n.forEach(function(e){t[e.id]=e}),n.forEach(function(e){e.parentId&&t[e.parentId].children.push(e)}),n.forEach(function(e){0===e.children.length&&delete e.children}),n.filter(function(e){return!e.parentId})}(e):e,r=JSON.parse(JSON.stringify(o));return this.rootModel=new Y({dagId:this.uid,id:"root",nodes:r,vmConfig:this.config,isRootModel:!0}),this.rootView=new Ee({model:this.rootModel,viewConfig:this.config}),this.rootModel.addModelChangeListener(this),this},e.prototype.getAllNodes=function(){return this.rootView.getAllNodes()},e.prototype.getAllEdges=function(){return this.rootView.getAllEdges()},e.prototype.render=function(){var e;this.rootView.render(this.zoomLayer),null===(e=this.minimap)||void 0===e||e.render(),x(this.zoomLayer).withAbsolutePosition(le({x:0,y:0},this.rootView.model.size())),this.parentSize&&this.justifyCenter(this.parentSize)},e.prototype.destory=function(){var e;this.listeners=[],this.rootView.destory(),null===(e=this.minimap)||void 0===e||e.destory()},e.prototype.setScale=function(e){this._scale=e,this.zoomLayer.style.transform="scale(".concat(e,")"),this.zoomLayer.style.transformOrigin="left top",this.zoomLayer.setAttribute("data-zoom-ratio-key","".concat(e)),this.parentSize&&this.justifyCenter(this.parentSize),this.minimap&&this.minimap.setViewBoxScale(e)},Object.defineProperty(e.prototype,"scale",{get:function(){return this._scale||1},enumerable:!1,configurable:!0}),e}();!function(e){e.LeftToRight="LeftToRight",e.RightToLeft="RightToLeft",e.None="None"}(ye||(ye={})),function(e){e.TopToBottom="TopToBottom",e.BottomToTop="BottomToTop",e.None="None"}(ve||(ve={}));var we=function(){return(we=Object.assign||function(e){for(var n,t=1,i=arguments.length;t<i;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)},xe="dnd-glass",Ne={position:"fixed",top:"0",left:"0",right:"0",bottom:"0",zIndex:"9999",display:"none","user-select":"none"};var Ce=function(){function e(e,n,t){var i,o=this;this.eligibleEdgeConnectors=[],this.setEnabled=function(e){o._enabled=e},this.initContext=function(e){o.originalScrollPosition={x:o._rootContainer.scrollLeft,y:o._rootContainer.scrollTop},o.draggingNode=e,o.draggingNodeParentBounds=R(e.ref.parentElement);var n=e.ref.parentElement.querySelectorAll(":scope>.".concat(P));o.eligibleEdgeConnectors=[],n.forEach(function(n){n!==e.ref&&o.eligibleEdgeConnectors.push({viewNode:e.model.findNodeById(n.getAttribute(I)),bounds:R(n)})})},this.withContext=function(e){return o.context=e,o},this.startNodeDragging=function(e,n){if(o._enabled){x(o.editableGlass).withStyle({display:"block"}),o.initContext(e),o.updateRelativeMousePoint({x:n.pageX,y:n.pageY}),o.draggingElement=x(e.ref.cloneNode(!0)).withStyle({transform:"scale(".concat(o.context.provider.scale,")"),transformOrigin:"top left"}).htmlElement;var t=o.context.lastBounds();x(o.draggingElement).withStyle({"user-select":"none","z-index":9}).withAbsolutePoint({x:t.left,y:t.top}),o.editableGlass.appendChild(o.draggingElement)}},this.startEdgeDragging=function(e,n){if(o._enabled){x(o.editableGlass).withStyle({display:"block"}),o.isDraggingEdge=!0;var t=o.context.provider.svgDndBackground;o.draggingElement=D(t,"path").withAttributes({stroke:"rgb(204, 204, 204)","marker-mid":"url(#".concat(e.model.dagId,"-").concat(j,")")}).svgElement,o.initContext(e),o.updateRelativeMousePoint({x:n.pageX,y:n.pageY})}},this.onDragging=function(e){if(e.stopPropagation(),0===e.button){var n={x:e.pageX,y:e.pageY};if(o.context){var t=o._rootContainer.getBoundingClientRect(),i=o.context.xDirection(n,t),r=o.context.yDirection(n,t);o.updateRelativeMousePoint(n),o.isDraggingEdge?o.renderDraggingEdge(n):o.onDraggingNode(i,r)}}},this.endDragging=function(e){var n;null===(n=o.draggingElement)||void 0===n||n.remove();var t={x:e.pageX,y:e.pageY};o.updateRelativeMousePoint(t);var i=o._rootContainer.scrollLeft-o.originalScrollPosition.x,r=o._rootContainer.scrollTop-o.originalScrollPosition.y,a=o.context.provider.scale||1;if(o.isDraggingEdge){var d=o.findPotentialEdgeTarget(t);d&&o.draggingNode.connect(d)}else o.draggingNode.setPoint({x:o.draggingNode.x+o.context.xyDelta.x/a+i,y:o.draggingNode.y+o.context.xyDelta.y/a+r});x(o.editableGlass).withStyle({display:"none"}),x(o.context.provider.svgDndBackground).withStyle({display:"none"}),o.isDraggingEdge=!1},this.updateRelativeMousePoint=function(e){var n=o._rootContainer.getBoundingClientRect();if(o.context.moveTo(e,n),!o.isDraggingEdge){var t=o.context.lastBounds(),i=o.context.provider.getParentTopLeft(o.draggingNode),r=0,a=0;t.left<i.x&&(r=i.x-t.left),t.top<i.y&&(a=i.y-t.top),o.context.moveTo({x:e.x+r,y:e.y+a},n)}},this.scrollIfNeeded=function(e){var n=e.xDirection,t=e.yDirection,i=o._rootContainer.getBoundingClientRect(),r=R(o.draggingElement);o.context.provider.resizeIfNeeded(r);var a=0,d=0;n===ye.LeftToRight&&r.right>i.right&&(a=r.right-i.right),n===ye.RightToLeft&&r.left<i.left&&(a=-(i.left-r.left)),t===ve.TopToBottom&&r.bottom>=i.bottom-20&&(d=r.bottom-(i.bottom-20)),t===ve.BottomToTop&&r.top<i.top&&(d=-(i.top-r.top)),o._rootContainer.scrollLeft+=a,o._rootContainer.scrollTop+=d},this._rootContainer=e,this._glassStyles=n,this.mapEdgeToPoints=t;var r=C(document.body,xe).withStyle(we(we({},Ne),{cursor:(null===(i=this._glassStyles)||void 0===i?void 0:i.cursor)||"pointer"}));r.alreadyExists||(r.htmlElement.addEventListener("mousemove",this.onDragging),r.htmlElement.addEventListener("mouseup",this.endDragging)),this.editableGlass=r.htmlElement}return e.prototype.destory=function(){this.editableGlass.remove()},e.prototype.renderDraggingEdge=function(e){var n=this.draggingNode,t=this.findPotentialEdgeTarget(e);t&&(n=t);var i=this.mapEdgeToPoints({source:this.draggingNode,target:n}),o=i.source,r=i.target,a=this.context.provider.scale||1,d=_(this.context.provider.svgDndBackground.getBoundingClientRect(),a),s=_(this.draggingNodeParentBounds,a),l={x:o.x+s.x-d.x,y:o.y+s.y-d.y},c=r.x+s.x,h=r.y+s.y,u={x:(n!==this.draggingNode?c:L(e.x/a))-d.x,y:(n!==this.draggingNode?h:L(e.y/a))-d.y},p=(l.x+u.x)/2,g=(l.y+u.y)/2,f="M".concat(l.x,",").concat(l.y," L").concat(p,",").concat(g," L").concat(u.x,",").concat(u.y);x(this.draggingElement).withAttributes({d:f})},e.prototype.findPotentialEdgeTarget=function(e){var n,t=this,i=this.eligibleEdgeConnectors.find(function(n){return t=e,(i=n.bounds).x<=t.x&&i.y<=t.y&&i.right>=t.x&&i.bottom>=t.y;var t,i});return!i||(null===(n=i.viewNode.dependencies)||void 0===n?void 0:n.some(function(e){return e===t.draggingNode.id}))||W(this.draggingNode.model.dagId).config.mode!==f.WITH_JOINT_NODES||i.viewNode.dependencies&&0!==i.viewNode.dependencies.length&&!i.viewNode.joint?null:i.viewNode},e.prototype.onDraggingNode=function(e,n){var t=this.context.lastBounds();this.scrollIfNeeded({xDirection:e,yDirection:n}),x(this.draggingElement).withAbsolutePoint({x:t.left,y:t.top})},e}(),De=function(){return(De=Object.assign||function(e){for(var n,t=1,i=arguments.length;t<i;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)},Oe=200,Se=function(){function e(e){var n=e.rootXy,t=e.mPoint,i=e.bounds,o=e.scale,r=e.provider,a=this;this.moveTo=function(e,n){a.mrPoint={x:e.x-n.x,y:e.y-n.y}},this.xDirection=function(e,n){var t=e.x-n.left,i=(a.mrPoint||{x:0}).x;return i<t?ye.LeftToRight:i===t?ye.None:ye.RightToLeft},this.yDirection=function(e,n){var t=e.y-n.top;return(a.mrPoint||{y:0}).y<t?ve.TopToBottom:(a.mrPoint||{y:0}).y==t?ve.None:ve.BottomToTop},this.allowDrop=function(){if(a.mouseDownTimestamp&&(new Date).getTime()-a.mouseDownTimestamp<=Oe)return!1;var e=a.xyDelta;return!(Math.abs(e.x)<=5&&Math.abs(e.y)<=5)},this.mouseDownTimestamp=(new Date).getTime(),this.rootXy=n,this._scale=o;var d=n.x,s=n.y;this._originalPoint={x:t.x-d,y:t.y-s},this.originalBounds={x:i.left,y:i.top,left:i.left,top:i.top,width:i.width,height:i.height,right:i.left+i.width,bottom:i.top+i.height},this.originalOffset={x:this._originalPoint.x-this.originalBounds.x,y:this._originalPoint.y-this.originalBounds.y},this.mrPoint=this._originalPoint,this._provider=r,this.validDndThreshold=(null===r||void 0===r?void 0:r.validDndThreshold)||3}return Object.defineProperty(e.prototype,"originalPoint",{get:function(){return this._originalPoint},enumerable:!1,configurable:!0}),e.prototype.lastBounds=function(e){void 0===e&&(e=!1);var n=this.xyDelta,t={x:this.originalBounds.left+n.x,y:this.originalBounds.top+n.y},i=t.x,o=t.y,r=e?i-this.rootXy.x:i,a=e?o-this.rootXy.y:o;return De(De({},this.originalBounds),{x:r,y:a,left:r,top:a,right:r+this.originalBounds.width,bottom:a+this.originalBounds.height})},Object.defineProperty(e.prototype,"xyDelta",{get:function(){return{x:this.mrPoint.x-this._originalPoint.x,y:this.mrPoint.y-this._originalPoint.y}},enumerable:!1,configurable:!0}),e.prototype.topLeftDelta=function(e){return{x:e.x-(this._originalPoint.x-this.originalOffset.x),y:e.y-(this._originalPoint.y-this.originalOffset.y)}},Object.defineProperty(e.prototype,"provider",{get:function(){return this._provider},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"point",{get:function(){return this.mrPoint},enumerable:!1,configurable:!0}),e}(),Le=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),_e=function(){return(_e=Object.assign||function(e){for(var n,t=1,i=arguments.length;t<i;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)},Re=function(){function e(e,n,t){var i=this;this.xLines=[],this.yLines=[],this.doLayout=function(){var e=_(i.svg.getBoundingClientRect(),i._scale||1);i._xArr=[];for(var n=0;n<=e.width;)i._xArr.push(n),n+=i.gridSize;i._yArr=[];for(n=0;n<=e.height;)i._yArr.push(n),n+=i.gridSize},this.getLines=function(e){void 0===e&&(e=!1);var n=_(i.svg.getBoundingClientRect(),i._scale||1);return(e?i._yArr:i._xArr).map(function(t){return e?{x1:0,y1:t,x2:n.width,y2:t}:{x1:t,y1:0,x2:t,y2:n.height}})},this.gridPoint=function(e){var n=i.svg.getBoundingClientRect(),t=L(e.x/i.scale),o=L(e.y/i.scale),r=_(n,i.scale),a=i,d=a.xArr,s=a.yArr,l={column:-1,row:-1};if(t>=r.left+d[0]){for(var c=0;c<d.length;c++)if(t<r.left+d[c]){l.column=c-1;break}-1===l.column&&(l.column=d.length-2),l.column>d.length-2&&(l.column=d.length-2)}if(o>=r.top+s[0]){for(c=0;c<s.length;c++)if(o<r.top+s[c]){l.row=c-1;break}-1===l.row&&(l.row=s.length-2),l.row>s.length-2&&(l.row=s.length-2)}return l.column>=0&&l.row>=0?{x:d[l.column]+n.left,y:s[l.row]+n.top}:{x:n.left,y:n.top}},this.render=function(){i._visible=!0,i.clear(),i.doLayout(),i.getLines().forEach(function(e){i.appendLine(e,!1)}),i.getLines(!0).forEach(function(e){i.appendLine(e,!0)})},this.gridSize=n,this.svg=e,this._scale=t||1,this._visible=!1}return Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},enumerable:!1,configurable:!0}),e.prototype.clear=function(){this.svg.innerHTML="",this.xLines=[],this.yLines=[]},Object.defineProperty(e.prototype,"xArr",{get:function(){return this._xArr},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yArr",{get:function(){return this._yArr},enumerable:!1,configurable:!0}),e.prototype.appendLine=function(e,n){var t=document.createElementNS("http://www.w3.org/2000/svg","line");t.setAttribute("class","nice-dag-dnd-svg-layer-dash-line"),t.setAttribute("x1","".concat(e.x1)),t.setAttribute("x2","".concat(e.x2)),t.setAttribute("y1","".concat(e.y1)),t.setAttribute("y2","".concat(e.y2)),x(t).withAttributes({stroke:"#9a9a9a","stroke-width":1,"stroke-dasharray":"2, 4"}),n?this.yLines.push(t):this.xLines.push(t),this.svg.appendChild(t)},e.prototype.redraw=function(){var e=this.xArr,n=this.yArr;this.doLayout();var t=this.getLines();if(this._xArr.length>e.length)for(var i=0;i<this._xArr.length;i++){var o=t[i];i>=e.length&&this.appendLine(o,!1)}for(i=0;i<t.length;i++){o=t[i];x(this.xLines[i]).withAttributes({x1:"".concat(o.x1),x2:"".concat(o.x2),y1:"".concat(o.y1),y2:"".concat(o.y2)})}var r=this.getLines(!0);if(this._yArr.length>n.length)for(i=0;i<this._yArr.length;i++){o=r[i];i>=n.length&&this.appendLine(o,!0)}for(i=0;i<r.length;i++){o=r[i];x(this.yLines[i]).withAttributes({x1:"".concat(o.x1),x2:"".concat(o.x2),y1:"".concat(o.y1),y2:"".concat(o.y2)})}},Object.defineProperty(e.prototype,"scale",{set:function(e){this._scale=e},enumerable:!1,configurable:!0}),e}(),ke=function(e){function n(n){var t=e.call(this,n)||this;return t.startEditing=function(){t._editing=!0,t.getAllNodes().forEach(function(e){return e.editing=!0}),t._dnd.setEnabled(!0),t.setGridVisible(!0)},t.stopEditing=function(){t._editing=!1,t.getAllNodes().forEach(function(e){return e.editing=!1}),t._dnd.setEnabled(!1),t.setGridVisible(!1)},t.startEdgeDragging=function(e,n){x(t.svgDndBkg).withStyle({display:"block"});var i=t._rootContainer.getBoundingClientRect(),o=e.ref.getBoundingClientRect();t._dnd.withContext(new Se({rootXy:{x:i.left,y:i.y},mPoint:{x:n.pageX,y:n.pageY},bounds:o,scale:t._scale,provider:t})).startEdgeDragging(e,n)},t.startNodeDragging=function(e,n){x(t.svgDndBkg).withStyle({display:"block"}),e.editing=!0;var i=t._rootContainer.getBoundingClientRect(),o=e.ref.getBoundingClientRect();t._dnd.withContext(new Se({rootXy:{x:i.left,y:i.y},mPoint:{x:n.pageX,y:n.pageY},bounds:o,scale:t._scale,provider:t})).startNodeDragging(e,n)},t._dnd=new Ce(t.mainLayer,n.glassStyles,t._config.mapEdgeToPoints),t.editorBkgContainer=C(t.mainLayer,A).htmlElement,t.svgGridBkg=O(t.editorBkgContainer,null,"".concat(t.uid,"-").concat(T)).withStyle({width:"100%",height:"100%"}).withClassNames(M).svgElement,t.svgDndBkg=O(t.editorBkgContainer,null,"".concat(t.uid,"-").concat(j)).withClassNames(z).withAbsolutePosition(V).withStyle({width:"100%",height:"100%",display:"none","z-index":99}).svgElement,t}return Le(n,e),Object.defineProperty(n.prototype,"svgDndBackground",{get:function(){return this.svgDndBkg},enumerable:!1,configurable:!0}),n.prototype.onModelChange=function(n){e.prototype.onModelChange.call(this,n),n.type===c.RESIZE&&this._editing&&(this.doBackgroundLayout(),this._grid.redraw())},Object.defineProperty(n.prototype,"grid",{get:function(){return this._grid},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"validDndThreshold",{get:function(){return 3},enumerable:!1,configurable:!0}),n.prototype.addJointNode=function(e,n,t){(void 0===t&&(t="root"),"root"===t)?this.rootModel.addNode(e,n,!0):this.rootModel.findNodeById(t).addChildNode(e,n)},n.prototype.addNode=function(e,n,t){(void 0===t&&(t="root"),"root"===t)?this.rootModel.addNode(e,n):this.rootModel.findNodeById(t).addChildNode(e,n)},Object.defineProperty(n.prototype,"editing",{get:function(){return this._editing},enumerable:!1,configurable:!0}),n.prototype.center=function(n){return this._editing||(e.prototype.center.call(this,n),this.doBackgroundLayout(),this.setGridVisible(this._editing)),this},n.prototype.doBackgroundLayout=function(){var e=this.zoomLayer.getBoundingClientRect(),n=this.scale,t=void 0===n?1:n,i=this.mainLayer.getBoundingClientRect(),o={width:L(e.width/t),height:L(e.height/t)};e.width<i.width&&(o.width=L(i.width/t)),e.height<i.height&&(o.height=L(i.height/t));var r=_e({x:0,y:0},o);x(this.editorBkgContainer).withAbsolutePosition(r)},n.prototype.setGridVisible=function(e){e?this._grid.render():this._grid.clear()},n.prototype.prettifier=function(){var e=this.editing;this.stopEditing(),this.rootModel.doLayout(!0,!0),this.justifyCenter(this.parentSize),e&&this.startEditing()},n.prototype.resizeBackground=function(e,n){var t=e.getBoundingClientRect(),i=n.x+n.width-t.x,o=n.y+n.height-t.y;if(t.width<i){var r=L(i/(this._scale||1));x(this.svgDndBackground).withWidth(r),x(this.svgGridBkg).withWidth(r)}if(t.height<o){var a=L(o/(this._scale||1));x(this.svgDndBackground).withHeight(a),x(this.svgGridBkg).withHeight(a)}return t.width<i||t.height<o},n.prototype.resizeIfNeeded=function(e){var n=this.resizeBackground(this.svgGridBkg,e);return n&&this._grid.redraw(),n},n.prototype.render=function(){e.prototype.render.call(this),this.doBackgroundLayout(),this._grid=new Re(this.svgGridBkg,this.config.gridSize,this._scale),this.setGridVisible(this._editing)},n.prototype.justifyCenter=function(e){if(!this._editing&&e){var n=this.zoomLayer.getBoundingClientRect(),t=0,i=0,o=0,r=0;e.width>n.width&&(t=(e.width-n.width)/2,o=L(e.width/this.scale)),e.height>n.height&&(i=(e.height-n.height)/2,r=L(e.height/this.scale)),this.rootView.justifySize({width:o,height:r}),(t>0||i>0)&&this.rootModel.setRootOffset({offsetX:L(t/this.scale),offsetY:L(i/this.scale)}),this.doBackgroundLayout()}},n.prototype.setScale=function(n){e.prototype.setScale.call(this,n),this.editorBkgContainer.style.transform="scale(".concat(n,")"),this.editorBkgContainer.style.transformOrigin="left top",this.doBackgroundLayout(),this._grid.scale=n,this.grid.visible&&this._grid.redraw()},n.prototype.getParentTopLeft=function(e){var n=e.ref.parentElement.getBoundingClientRect();return{x:n.left,y:n.top}},n.prototype.destory=function(){e.prototype.destory.call(this),this._dnd.destory()},n}(be);var Pe={use:W,init:function(e,n){void 0===n&&(n=!1);var t=n?new ke(e):new be(e);return function(e,n){G[e]=n}(t.id,t),t}},Be=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ie=function(){return(Ie=Object.assign||function(e){for(var n,t=1,i=arguments.length;t<i;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)},Te=function(e,n){var t={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&n.indexOf(i)<0&&(t[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)n.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(t[i[o]]=e[i[o]])}return t},Me=function(e,n,t){if(t||2===arguments.length)for(var i,o=0,r=n.length;o<r;o++)!i&&o in n||(i||(i=Array.prototype.slice.call(n,0,o)),i[o]=n[o]);return e.concat(i||Array.prototype.slice.call(n))},je=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return Be(n,e),n.prototype.render=function(){if(this.props.niceDag&&this.props.node.ref){var e=this.props.niceDag.getElementByNodeId(this.props.node.id);if(e)return v.a.createPortal(this.props.render(this.props),e)}return null},n}(r.a.Component),ze=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return Be(n,e),n.prototype.render=function(){return this.props.niceDag&&this.props.edge.ref?v.a.createPortal(this.props.render(this.props),this.props.edge.ref):null},n}(r.a.Component);function Ae(e){var n=e.node,t=e.niceDag;return{onNodeRemove:Object(o.useCallback)(function(){n.remove()},[n]),startEdgeDragging:Object(o.useCallback)(function(e){t.startEdgeDragging(n,e)},[t,n]),startNodeDragging:Object(o.useCallback)(function(e){t.startNodeDragging(n,e)},[t,n])}}function Ve(e){!function(e){if(!e.initNodes)throw new Error("initNodes can't be undefined!")}(e);var n=e.onMount,t=e.renderNode,i=e.renderEdge,a=(e.scrollPosition,e.initNodes),d=e.minimapConfig,s=Te(e,["onMount","renderNode","renderEdge","scrollPosition","initNodes","minimapConfig"]),l=Object(o.useRef)(null),c=Object(o.useRef)(null),h=Object(o.useRef)(null),u=Object(o.useRef)(),p=Object(o.useState)(0),g=p[0],f=p[1],m=Object(o.useCallback)(function(){h.current&&h.current.destory()},[f]),y=Object(o.useMemo)(function(){return{onChange:function(){f(g+1)}}},[f,g]);return Object(o.useEffect)(function(){if(u.current!==a){if(!h.current){var t=Pe.init(Ie({container:l.current,minimapContainer:c.current,minimapConfig:d},s),e.editable);h.current=t}h.current.withNodes(a).render(),f(g+1),u.current=a,n&&n()}return h.current.addNiceDagChangeListener(y),function(){h.current.removeNiceDagChangeListener(y)}},[a,f,g,n]),Object(o.useEffect)(function(){return function(){h.current&&h.current.destory()}},[]),{niceDag:h.current,niceDagEl:l,minimapEl:c,render:function(){if(h.current){var e=h.current.getAllNodes();console.log(e,e.map(function(e){return e.id}));var n=(null===e||void 0===e?void 0:e.length)>0?e.map(function(e){return r.a.createElement(je,{render:t,node:e,key:e.id,niceDag:h.current,patchVersion:g})}):null;if(i){var o=h.current.getAllEdges(),a=(null===o||void 0===o?void 0:o.length)>0?o.map(function(e){return r.a.createElement(ze,{render:i,edge:e,patchVersion:g,key:"edge-".concat(e.source.id,"-").concat(e.target.id),niceDag:h.current})}):[];n=Me(Me([],n,!0),a,!0)}return n}return null},reset:m}}var He=[{id:"start"},{id:"git-clone",dependencies:["start"],data:{label:"Git Clone"}},{id:"mvn",dependencies:["git-clone"],data:{label:"Mvn Install"}},{id:"security-check",dependencies:["git-clone"],data:{label:"Security Check"}},{id:"build",dependencies:["mvn","security-check"],data:{label:"Build",lazyLoadingChildren:!0}},{id:"deploy-fp-1",dependencies:["build"],data:{label:"Deploy Feature-1"},children:[{id:"provision-fp-1",data:{label:"Provision Pool"}},{id:"deployment-fp-1",dependencies:["provision-fp-1"],data:{label:"Deployment"}}]},{id:"deploy-fp-2",dependencies:["build"],data:{label:"Deploy Feature-2"},children:[{id:"provision-fp-2",data:{label:"Provision Pool"}},{id:"deployment-fp-2",dependencies:["provision-fp-2"],data:{label:"Deployment"}}]},{id:"smoke-test",dependencies:["deploy-fp-1","deploy-fp-2"]},{id:"integration-test",dependencies:["smoke-test"]},{id:"prod-deployment",dependencies:["integration-test"]},{id:"end",dependencies:["prod-deployment"]}],Ge=t(399),We=t(400),Fe=t(390),Ze=t(113),Xe=t(394),Je=t(392),Ye=t(397),qe=t(398);function Ue(e){var n=e.onScaleChange,t=Object(o.useState)(100),a=Object(i.a)(t,2),d=a[0],s=a[1],l=Object(o.useCallback)(function(e){s(e),n(e)},[n]);return r.a.createElement(Xe.b,null,r.a.createElement(Ye.a,null),r.a.createElement(Je.a,{defaultValue:d,onChange:l}),r.a.createElement(qe.a,null))}var $e=Fe.a.Option;function Ke(e){var n=e.type;return r.a.createElement("div",{className:"readonly-sample-connector-".concat(n)})}function Qe(){return r.a.createElement("div",{className:"readonly-sample-joint-node"})}function en(e){var n,t=e.node;return r.a.createElement("div",{className:"readonly-sample-node-group-content"},r.a.createElement("div",null,(null===(n=t.data)||void 0===n?void 0:n.label)||t.id,r.a.createElement(Ze.a,{icon:r.a.createElement(Ge.a,null),onClick:function(){t.shrink()},type:"link"})))}function nn(e){var n,t,i,o=e.node;return r.a.createElement("div",{className:"readonly-sample-node-content"},r.a.createElement("span",null,(null===(n=o.data)||void 0===n?void 0:n.label)||o.id),((null===(t=o.children)||void 0===t?void 0:t.length)>0||(null===(i=o.data)||void 0===i?void 0:i.lazyLoadingChildren))&&r.a.createElement(Ze.a,{icon:r.a.createElement(We.a,null),onClick:function(){var e;null!==(e=o.data)&&void 0!==e&&e.lazyLoadingChildren?o.withChildren(new Promise(function(e){e([{id:"step-1"},{id:"step-2",dependencies:["step-1"]}])})):o.expand()},type:"link"}))}function tn(e){var n,t=e.node,i=e.niceDag;return r.a.createElement("div",{className:"readonly-sample-node"},(null===(n=t.children)||void 0===n?void 0:n.length)>0&&!t.collapse?r.a.createElement(en,{node:t,niceDag:i}):r.a.createElement(nn,{node:t,niceDag:i}),r.a.createElement(Ke,{type:"in"}),r.a.createElement(Ke,{type:"out"}))}var on=function(e){return"start"===e.id||"end"===e.id||e.joint?{width:30,height:30}:{width:150,height:60}},rn={start:function(){return r.a.createElement("div",{className:"readonly-sample-start-node"})},end:function(){return r.a.createElement("div",{className:"readonly-sample-end-node"})}},an=function(e){var n=e.node,t=e.niceDag,i=rn[n.id]||tn;return n.joint&&(i=Qe),r.a.createElement(i,{node:n,niceDag:t})},dn=function(e){e.edge,e.niceDag;return r.a.createElement("div",{className:"readonly-sample-edge-label"},"to")};function sn(){var e=Ve({initNodes:He,getNodeSize:on,renderNode:an,renderEdge:dn,minimapConfig:{viewBoxClassName:"readonly-sample-minimap-viewbox"}}),n=e.niceDag,t=e.niceDagEl,i=e.minimapEl,a=e.render;Object(o.useEffect)(function(){if(n){var e=t.current.getBoundingClientRect();n.center({width:e.width,height:400})}},[n,t]);var d=Object(o.useCallback)(function(e){n.setDirection(e)},[n]);return r.a.createElement("div",{className:"readonly-sample"},r.a.createElement("div",null,r.a.createElement(Xe.b,null,r.a.createElement("label",null,"Direction"),r.a.createElement(Fe.a,{defaultValue:"LR",style:{width:120},onChange:d},r.a.createElement($e,{value:"LR"},"Left to Right"),r.a.createElement($e,{value:"RL"},"Right to Left"),r.a.createElement($e,{value:"TB"},"Top To Bottom"),r.a.createElement($e,{value:"BT"},"Bottom To Top")),r.a.createElement(Ue,{onScaleChange:function(e){return n.setScale(e/100)}}))),r.a.createElement("div",{className:"readonly-sample-content"},r.a.createElement("div",{className:"readonly-sample-content-nice-dag",ref:t}),r.a.createElement("div",{className:"readonly-sample-content-minimap"},r.a.createElement("div",{className:"readonly-sample-content-minimap-body",ref:i})),a()))}var ln=t(401),cn=t(111),hn=t(396),un=t(393),pn=t(395);var gn=0;function fn(e){var n=function(e){return{onEdgeRemove:Object(o.useCallback)(function(){e.remove()},[e]),onNodeInsert:Object(o.useCallback)(function(n,t){void 0===t&&(t=40),e.insertNodes(n,t)},[e])}}(e.edge),t=n.onEdgeRemove,i=n.onNodeInsert,a=Object(o.useCallback)(function(){i([{id:"insert-node-".concat(gn)},{id:"insert-node-".concat(gn+1)},{id:"insert-node-".concat(gn+2)}]),gn+=3},[i]),d=r.a.createElement(un.a,{items:[{key:"1",label:r.a.createElement("span",{onClick:t},"Remove")},{key:"2",label:r.a.createElement("span",{onClick:a},"Insert Tasks")}]});return r.a.createElement("div",{className:"editable-sample-edge-label"},r.a.createElement(pn.a,{overlay:d},r.a.createElement("div",null)))}var mn=function(e){return r.a.createElement(fn,e)};function yn(e){var n=e.type,t=e.niceDag,i=Ae({node:e.node,niceDag:t}).startEdgeDragging;return r.a.createElement("div",{className:"editable-sample-connector-".concat(n),onMouseDown:i,"aria-label":"".concat("in"===n?"Inbound":"Outbound","Connector"),role:"button"})}function vn(e){var n=e.type,t=e.niceDag,i=Ae({node:e.node,niceDag:t}).startEdgeDragging;return r.a.createElement("div",{className:"editable-sample-square-connector-".concat(n),onMouseDown:i})}function En(e){var n=e.node,t=e.niceDag,i=Ae({node:n,niceDag:t}),o=i.onNodeRemove,a=i.startNodeDragging;return r.a.createElement("div",{className:"editable-sample-joint-node"},r.a.createElement("div",{className:"editable-sample-joint-node-move",onMouseDown:a},r.a.createElement(ln.a,null)),r.a.createElement("div",{className:"editable-sample-joint-node-remove-button",role:"button",onMouseDown:o,"aria-label":"Remove joint node"},r.a.createElement(cn.a,null)),r.a.createElement(vn,{type:"in"}),r.a.createElement(vn,{type:"out",node:n,niceDag:t}))}function bn(e){var n,t=e.node,i=e.niceDag,o=Ae({node:t,niceDag:i}),a=o.onNodeRemove,d=o.startNodeDragging;return r.a.createElement("div",{className:"editable-sample-node-group-content"},r.a.createElement("div",null,r.a.createElement("div",{className:"editable-sample-node-group-content-bar",onMouseDown:d},r.a.createElement("span",null,(null===(n=t.data)||void 0===n?void 0:n.label)||t.id),r.a.createElement(ln.a,null)),r.a.createElement("div",{className:"editable-sample-node-group-content-delete-button",role:"button",onMouseDown:a},r.a.createElement(hn.a,null)),r.a.createElement(Ze.a,{icon:r.a.createElement(Ge.a,null),onClick:function(){t.shrink()},type:"link"})))}function wn(e){var n,t,i,o=e.node,a=e.niceDag,d=Ae({node:o,niceDag:a}),s=d.onNodeRemove,l=d.startNodeDragging;return r.a.createElement("div",{className:"editable-sample-node-content"},r.a.createElement("div",{className:"editable-sample-node-content-bar",onMouseDown:l},r.a.createElement("span",null,(null===(n=o.data)||void 0===n?void 0:n.label)||o.id),r.a.createElement(ln.a,null)),r.a.createElement("div",{className:"editable-sample-node-content-delete-button",role:"button",onMouseDown:s},r.a.createElement(hn.a,null)),((null===(t=o.children)||void 0===t?void 0:t.length)>0||(null===(i=o.data)||void 0===i?void 0:i.lazyLoadingChildren))&&r.a.createElement(Ze.a,{icon:r.a.createElement(We.a,null),onClick:function(){var e;null!==(e=o.data)&&void 0!==e&&e.lazyLoadingChildren?o.withChildren(new Promise(function(e){e([{id:"step-1"},{id:"step-2",dependencies:["step-1"]}])})):o.expand()},type:"link"}))}function xn(e){var n,t=e.node,i=e.niceDag;return r.a.createElement("div",{className:"editable-sample-node"},(null===(n=t.children)||void 0===n?void 0:n.length)>0&&!t.collapse?r.a.createElement(bn,{node:t,niceDag:i}):r.a.createElement(wn,{node:t,niceDag:i}),r.a.createElement(yn,{type:"in"}),r.a.createElement(yn,{type:"out",node:t,niceDag:i}))}var Nn=function(e){return"start"===e.id||"end"===e.id||e.joint?{width:30,height:30}:{width:150,height:60}},Cn={start:function(e){var n=e.node,t=e.niceDag,i=Ae({node:n,niceDag:t}).startNodeDragging;return r.a.createElement("div",{className:"editable-sample-start-node"},r.a.createElement("div",{className:"editable-sample-start-node-move-hand",onMouseDown:i}),r.a.createElement(vn,{type:"out",node:n,niceDag:t}))},end:function(e){var n=Ae({node:e.node,niceDag:e.niceDag}).startNodeDragging;return r.a.createElement("div",{className:"editable-sample-end-node",onMouseDown:n},r.a.createElement(vn,{type:"in"}))}},Dn=function(e){var n=e.node,t=e.niceDag,i=Cn[n.id]||xn;return n.joint&&(i=En),r.a.createElement(i,{node:n,niceDag:t})};function On(){var e=Ve({initNodes:He,getNodeSize:Nn,renderNode:Dn,editable:!0,renderEdge:mn,jointEdgeConnectorType:"CENTER_OF_BORDER"}),n=e.niceDag,t=e.niceDagEl,i=e.render;return Object(o.useEffect)(function(){if(n){var e=document.querySelector(".editable-sample").getBoundingClientRect();n.center({width:e.width,height:400}).startEditing()}},[n]),r.a.createElement("div",{className:"editable-sample"},r.a.createElement("div",null,r.a.createElement(Xe.b,null,r.a.createElement(Ze.a,{size:"small",onClick:function(){n.prettifier()}},"Prettifier"),r.a.createElement(Ze.a,{size:"small",onClick:function(){n.addNode({id:"new-node-".concat(gn)},{x:40,y:40}),gn+=1}},"Add Node"),r.a.createElement(Ze.a,{size:"small",onClick:function(){n.addJointNode({id:"new-node-".concat(gn)},{x:40,y:40}),gn+=1}},"Add Joint Node"),r.a.createElement(Ue,{onScaleChange:function(e){return n.setScale(e/100)}}))),r.a.createElement("div",{className:"editable-sample-nice-dag-wrapper",ref:t}),i())}var Sn=[{id:"start"},{id:"parent",dependencies:["start"],data:{label:"Parent"}},{id:"child-1",data:{label:"Child-1"},parentId:"parent"},{id:"child-2",dependencies:["child-1"],data:{label:"Child-2"},parentId:"parent"},{id:"child-1-1",data:{label:"Child-1-1"},parentId:"child-1"},{id:"end",dependencies:["parent"]}];function Ln(e){var n=e.type;return r.a.createElement("div",{className:"complex-sample-connector-".concat(n)})}function _n(){return r.a.createElement("div",{className:"complex-sample-joint-node"})}function Rn(e){var n,t=e.node;return r.a.createElement("div",{className:"complex-sample-node-group-content"},r.a.createElement("div",null,(null===(n=t.data)||void 0===n?void 0:n.label)||t.id,r.a.createElement(Ze.a,{icon:r.a.createElement(Ge.a,null),onClick:function(){t.shrink()},type:"link"})))}function kn(e){var n,t,i,o=e.node;return r.a.createElement("div",{className:"complex-sample-node-content"},r.a.createElement("span",null,(null===(n=o.data)||void 0===n?void 0:n.label)||o.id),((null===(t=o.children)||void 0===t?void 0:t.length)>0||(null===(i=o.data)||void 0===i?void 0:i.lazyLoadingChildren))&&r.a.createElement(Ze.a,{icon:r.a.createElement(We.a,null),onClick:function(){var e;null!==(e=o.data)&&void 0!==e&&e.lazyLoadingChildren?o.withChildren(new Promise(function(e){e([{id:"step-1"},{id:"step-2",dependencies:["step-1"]}])})):o.expand()},type:"link"}))}function Pn(e){var n,t=e.node,i=e.niceDag;return r.a.createElement("div",{className:"complex-sample-node"},(null===(n=t.children)||void 0===n?void 0:n.length)>0&&!t.collapse?r.a.createElement(Rn,{node:t,niceDag:i}):r.a.createElement(kn,{node:t,niceDag:i}),r.a.createElement(Ln,{type:"in"}),r.a.createElement(Ln,{type:"out"}))}var Bn=function(e){return"start"===e.id||"end"===e.id||e.joint?{width:30,height:30}:{width:150,height:60}},In={start:function(){return r.a.createElement("div",{className:"complex-sample-start-node"})},end:function(){return r.a.createElement("div",{className:"complex-sample-end-node"})}},Tn=function(e){var n=e.node,t=e.niceDag,i=In[n.id]||Pn;return n.joint&&(i=_n),r.a.createElement(i,{node:n,niceDag:t})},Mn=function(e){e.edge,e.niceDag;return r.a.createElement("div",{className:"complex-sample-edge-label"},"to")};function jn(e){var n=e.source,t=e.target,i={x:n.x+n.width,y:n.y+n.height/2},o={x:t.x,y:t.y+t.height/2};return n.joint||-1!==n.id.indexOf("start")?i={x:n.x+n.width/2,y:n.y+n.height/2}:(t.joint||-1!==t.id.indexOf("end"))&&(o={x:t.x+t.width/2,y:t.y+t.height/2}),{source:i,target:o}}function zn(){var e=Ve({initNodes:Sn,modelType:"FLATTEN",getNodeSize:Bn,renderNode:Tn,mapEdgeToPoints:jn,renderEdge:Mn}),n=e.niceDag,t=e.niceDagEl,i=e.render;return Object(o.useEffect)(function(){if(n){var e=t.current.getBoundingClientRect();n.center({width:e.width,height:400})}},[n,t]),r.a.createElement("div",{className:"complex-sample"},r.a.createElement("div",null,r.a.createElement(Xe.b,null,r.a.createElement(Ue,{onScaleChange:function(e){return n.setScale(e/100)}}))),r.a.createElement("div",{className:"complex-sample-nice-dag-wrapper",ref:t}),i())}var An=m.a.TabPane,Vn={"read-only-view":{name:"Read-Only View",component:r.a.createElement(sn,null),code:["ReadOnlyView.js","ZoomInOutSlider.js"],less:"ReadOnlyView.less",data:"ReadOnlyViewData.js"},"editable-view":{name:"Editable View",component:r.a.createElement(On,null),code:["EditableView.js","ZoomInOutSlider.js"],less:"EditableView.less",data:"ReadOnlyViewData.js"},"complex-structure-view":{name:"Complex Structure View",component:r.a.createElement(zn,null),code:["ComplexHierarchicalView.js","ZoomInOutSlider.js"],less:"ComplexHierarchicalView.less",data:"ComplexHierarchicalViewData.js"}};n.a=function(){var e=d()||"read-only-view",n=Vn[e]||{},t=r.a.createElement("div",{className:"app"},r.a.createElement("div",{className:"sider"},r.a.createElement("h1",null,r.a.createElement("span",{className:"header-name"},"@ebay/nice-dag"),r.a.createElement("span",{className:"example-title"},"Examples")),r.a.createElement("div",{className:"scroll-container",id:"scroll-container"},r.a.createElement("ul",null,Object.keys(Vn).map(function(n){return r.a.createElement("li",{key:n},r.a.createElement("a",{href:"#".concat(n),className:e===n?"active":""},Vn[n].name))})))),r.a.createElement("div",{className:"sample-content"},function(){var n=Vn[e];return n&&n.component?r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,n.name),r.a.createElement("div",{className:"example-container"},n.component)," "):r.a.createElement("span",{style:{color:"red"}},'Error: example "',e,'" not found.')}(),r.a.createElement("div",{className:"code-container"},r.a.createElement(m.a,{defaultActiveKey:"tab-code"},r.a.createElement(An,{tab:"Code",key:"tab-code"},n.code.map(function(e){return r.a.createElement("div",{className:"code-viewer",key:e},r.a.createElement("div",{className:"code-viewer-title"},e),r.a.createElement(l,{filename:e}))})),r.a.createElement(An,{tab:"Less",key:"tab-less"},r.a.createElement(l,{filename:n.less})),r.a.createElement(An,{tab:"Data",key:"tab-data"},r.a.createElement(l,{filename:n.data}))))));return"redux"===e?t:r.a.createElement("div",{className:"example-container"},t)}},199:function(e,n,t){e.exports=t(387)},384:function(e,n,t){},387:function(e,n,t){"use strict";t.r(n);var i=t(0),o=t.n(i),r=t(28),a=t.n(r),d=t(191);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));t(384);a.a.render(o.a.createElement(d.a,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[199,1,2]]]);
//# sourceMappingURL=main.e1e065fd.chunk.js.map