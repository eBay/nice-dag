(function(){"use strict";var e={2216:function(e,t,n){var i=n(8257),o=n(6941),s=n(9431);const d={class:"app"},a={class:"sider"},r=(0,o._)("div",{class:"header-info"},[(0,o._)("span",{class:"example-title"},"Vue.js Example"),(0,o._)("span",{class:"header-name"},"@ebay/nice-dag-vue3")],-1),l={class:"scroll-container",id:"scroll-container"},h=["href"],c=(0,o._)("div",{class:"footer-info"},[(0,o._)("span",{class:"footer-label"},"Other Reference"),(0,o._)("a",{href:"../react/index.html#read-only-view"},"React.js Example")],-1),g={class:"sample-content"},p={class:"code-viewer-title"},u=(0,o._)("div",{class:"code-viewer-title"},"Less",-1),m=(0,o._)("div",{class:"code-viewer-title"},"Data",-1);function v(e,t,n,i,v,f){const y=(0,o.up)("LogoSvg"),E=(0,o.up)("ReadOnlyView"),w=(0,o.up)("EditableView"),b=(0,o.up)("CodeViewer"),N=(0,o.up)("el-tab-pane"),D=(0,o.up)("el-tabs");return(0,o.wg)(),(0,o.iD)("div",d,[(0,o._)("div",a,[(0,o._)("h1",null,[(0,o.Wm)(y),r]),(0,o._)("div",l,[(0,o._)("ul",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.examples,((e,t)=>((0,o.wg)(),(0,o.iD)("li",{key:t},[(0,o._)("a",{href:`#${t}`,class:(0,s.C_)({active:i.isActive(t)})},(0,s.zw)(e.name),11,h)])))),128))])]),c]),(0,o._)("div",g,[(0,o._)("h1",null,[(0,o._)("span",null,(0,s.zw)(i.getCurrentExample(i.current).name),1)]),"read-only-view"===i.current?((0,o.wg)(),(0,o.j4)(E,{key:0})):(0,o.kq)("",!0),"editable-view"===i.current?((0,o.wg)(),(0,o.j4)(w,{key:1})):(0,o.kq)("",!0),(0,o.Wm)(D,{modelValue:i.activeTab,"onUpdate:modelValue":t[0]||(t[0]=e=>i.activeTab=e),onTabClick:i.handleClick},{default:(0,o.w5)((()=>[(0,o.Wm)(N,{label:"Code",name:"code"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.examples[i.current].codes,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e},[(0,o._)("div",p,(0,s.zw)(e),1),(0,o.Wm)(b,{filename:e},null,8,["filename"])])))),128))])),_:1}),(0,o.Wm)(N,{label:"Less",name:"less"},{default:(0,o.w5)((()=>[u,(0,o.Wm)(b,{filename:i.examples[i.current].less},null,8,["filename"])])),_:1}),(0,o.Wm)(N,{label:"Data",name:"data"},{default:(0,o.w5)((()=>[m,(0,o.Wm)(b,{filename:i.examples[i.current].data},null,8,["filename"])])),_:1})])),_:1},8,["modelValue","onTabClick"])])])}const f={className:"readonly-sample"},y={className:"readonly-sample-control"},E={className:"readonly-sample-control-direction"},w={className:"readonly-sample-control-zoom"},b={className:"readonly-sample-content"},N={className:"readonly-sample-content-nice-dag",ref:"niceDagEl"},D={className:"readonly-sample-content-minimap-row"},C={className:"readonly-sample-content-minimap"},x={className:"readonly-sample-content-minimap-body",ref:"minimapEl"};function S(e,t,n,i,s,d){const a=(0,o.up)("el-option"),r=(0,o.up)("el-select"),l=(0,o.up)("el-slider"),h=(0,o.up)("StartNode"),c=(0,o.up)("EndNode"),g=(0,o.up)("Joint"),p=(0,o.up)("SampleNode"),u=(0,o.up)("NiceDagNodes"),m=(0,o.up)("Edge"),v=(0,o.up)("NiceDagEdges");return(0,o.wg)(),(0,o.iD)("div",f,[(0,o._)("div",y,[(0,o._)("div",E,[(0,o.Wm)(r,{modelValue:i.direction,"onUpdate:modelValue":t[0]||(t[0]=e=>i.direction=e),placeholder:"Select",onChange:i.onDirectionChange},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.directions,(e=>((0,o.wg)(),(0,o.j4)(a,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])]),(0,o._)("div",w,[(0,o.Wm)(l,{modelValue:i.scale,"onUpdate:modelValue":t[1]||(t[1]=e=>i.scale=e),"show-input":"",onChange:i.onScaleChange},null,8,["modelValue","onChange"])])]),(0,o._)("div",b,[(0,o._)("div",N,null,512),(0,o.Wm)(u,{niceDagReactive:i.niceDagReactive},{default:(0,o.w5)((e=>["start"===e.node.id?((0,o.wg)(),(0,o.j4)(h,{key:0})):(0,o.kq)("",!0),"end"===e.node.id?((0,o.wg)(),(0,o.j4)(c,{key:1})):(0,o.kq)("",!0),e.node.joint?((0,o.wg)(),(0,o.j4)(g,{key:2})):(0,o.kq)("",!0),"end"===e.node.id||"start"===e.node.id||e.node.joint?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(p,{key:3,node:e.node,niceDagReactive:i.niceDagReactive,observor:i.niceDagReactive.observor},null,8,["node","niceDagReactive","observor"]))])),_:1},8,["niceDagReactive"]),(0,o.Wm)(v,{niceDagReactive:i.niceDagReactive},{default:(0,o.w5)((()=>[(0,o.Wm)(m)])),_:1},8,["niceDagReactive"])]),(0,o._)("div",D,[(0,o._)("div",C,[(0,o._)("div",x,null,512)])])])}const R=[{id:"start"},{id:"git-clone",dependencies:["start"],data:{label:"Git Clone"}},{id:"mvn",dependencies:["git-clone"],data:{label:"Mvn Install"}},{id:"security-check",dependencies:["git-clone"],data:{label:"Security Check"}},{id:"build",dependencies:["mvn","security-check"],data:{label:"Build"}},{id:"deploy-fp-1",dependencies:["build"],data:{label:"Deploy Feature-1"},children:[{id:"provision-fp-1",data:{label:"Provision Pool"}},{id:"deployment-fp-1",dependencies:["provision-fp-1"],data:{label:"Deployment"}}]},{id:"deploy-fp-2",dependencies:["build"],data:{label:"Deploy Feature-2"},children:[{id:"provision-fp-2",data:{label:"Provision Pool"}},{id:"deployment-fp-2",dependencies:["provision-fp-2"],data:{label:"Deployment"}}]},{id:"smoke-test",dependencies:["deploy-fp-1","deploy-fp-2"]},{id:"integration-test",dependencies:["smoke-test"]},{id:"prod-deployment",dependencies:["integration-test"]},{id:"end",dependencies:["prod-deployment"]}];var _=n(4880);const L={viewBox:"64 64 896 896",focusable:"false","data-icon":"fullscreen-exit",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},k=(0,o._)("path",{d:"M391 240.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L200 146.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L280 333.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L401 410c5.1.6 9.5-3.7 8.9-8.9L391 240.9zm10.1 373.2L240.8 633c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L146.3 824a8.03 8.03 0 000 11.3l42.4 42.3c3.1 3.1 8.2 3.1 11.3 0L333.7 744l43.7 43.7A8.01 8.01 0 00391 783l18.9-160.1c.6-5.1-3.7-9.4-8.8-8.8zm221.8-204.2L783.2 391c6.6-.8 9.4-8.9 4.7-13.6L744 333.6 877.7 200c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.3a8.03 8.03 0 00-11.3 0L690.3 279.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L614.1 401c-.6 5.2 3.7 9.5 8.8 8.9zM744 690.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L623 614c-5.1-.6-9.5 3.7-8.9 8.9L633 783.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L824 877.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L744 690.4z"},null,-1),M=[k];function B(e,t,n,i,s,d){return(0,o.wg)(),(0,o.iD)("svg",L,M)}var I={name:"ShrinkSvg"},T=n(2018);const V=(0,T.Z)(I,[["render",B]]);var z=V;const P={viewBox:"64 64 896 896",focusable:"false","data-icon":"plus-circle",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},O=(0,o._)("path",{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"},null,-1),A=(0,o._)("path",{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"},null,-1),$=[O,A];function W(e,t,n,i,s,d){return(0,o.wg)(),(0,o.iD)("svg",P,$)}var j={name:"PlusSvg"};const H=(0,T.Z)(j,[["render",W]]);var G=H;function q(e,t,n,i,s,d){return(0,o.wg)(),(0,o.iD)("button",{onClick:t[0]||(t[0]=t=>e.$emit("onClick")),class:"nice-dag-vue-sample-icon-button"},[(0,o.WI)(e.$slots,"default",{},void 0,!0)])}var J={name:"MyButton"};const Z=(0,T.Z)(J,[["render",q],["__scopeId","data-v-d38a2660"]]);var X=Z;const Y=(0,o.Wm)("div",{className:"readonly-sample-start-node"},null),F=(0,o.Wm)("div",{className:"readonly-sample-end-node"},null),U={props:["type"],emits:["update:type"],render(){return(0,o.Wm)("div",{className:`readonly-sample-connector-${this.type}`},null)}},K=(0,o.Wm)("div",{className:"readonly-sample-joint-node"},null),Q={props:["node","niceDag"],emits:["update:node","update:niceDag"],components:[z,X],render(){return(0,o.Wm)("div",{className:"readonly-sample-node-group-content"},[(0,o.Wm)("div",null,[this.node.data?.label||this.node.id,(0,o.Wm)(X,{onClick:()=>this.node.shrink()},{default:()=>[(0,o.Wm)(z,null,null)]})])])}},ee={props:["node","niceDag"],emits:["update:node","update:niceDag"],render(){return(0,o.Wm)("div",{className:"readonly-sample-node-content"},[(0,o.Wm)("span",null,[this.node.data?.label||this.node.id]),(this.node.children?.length>0||this.node.data?.lazyLoadingChildren)&&(0,o.Wm)(X,{onClick:()=>{this.node.data?.lazyLoadingChildren?this.node.withChildren(new Promise((e=>{e([{id:"step-1"},{id:"step-2",dependencies:["step-1"]}])}))):this.node.expand()}},{default:()=>[(0,o.Wm)(G,null,null)]})])}},te={render(){return(0,o.Wm)("div",{className:"readonly-sample-edge-label"},[(0,o.Uk)("to")])}},ne={props:["node","niceDagReactive"],emits:["update:node","update:niceDagReactive"],render(){return(0,o.Wm)("div",{className:"readonly-sample-node"},[this.node.children?.length>0&&!this.node.collapse?(0,o.Wm)(Q,{node:this.node,niceDag:this.niceDagReactive.use()},null):(0,o.Wm)(ee,{node:this.node,niceDag:this.niceDagReactive.use()},null),(0,o.Wm)(U,{type:"in"},null),(0,o.Wm)(U,{type:"out"},null)])}};n(2083);var ie=n(1113),oe=n(2187),se=Object.defineProperty,de=(e,t,n)=>t in e?se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ae=(e,t,n)=>(de(e,"symbol"!=typeof t?t+"":t,n),n),re=(e=>(e.REMOVE_SUB_VIEW="REMOVE_SUB_VIEW",e.ADD_SUB_VIEW="ADD_SUB_VIEW",e.RESIZE="RESIZE",e.ADD_NODE="ADD_NODE",e.REMOVE_NODE="REMOVE_NODE",e.ADD_EDGE="ADD_EDGE",e.REMOVE_EDGE="REMOVE_EDGE",e))(re||{}),le=(e=>(e.SHRINK_NODE="SHRINK_NODE",e.EXPAND_NODE="EXPAND_NODE",e.POSITION_CHANGE="POSITION_CHANGE",e.RESIZE="RESIZE",e.REMOVED="REMOVED",e.ADD_CHILD_NODE="ADD_CHILD_NODE",e))(le||{}),he=(e=>(e.LR="LR",e.RL="RL",e.TB="TB",e.BT="BT",e))(he||{}),ce=(e=>(e.CENTER_OF_BORDER="CENTER_OF_BORDER",e.CENTER="CENTER",e))(ce||{}),ge=(e=>(e.HIERARCHY="HIERARCHY",e.FLATTEN="FLATTEN",e))(ge||{}),pe=(e=>(e.DEFAULT="DEFAULT",e.WITH_JOINT_NODES="WITH_JOINT_NODES",e))(pe||{});function ue(e=[]){let t=[];e.forEach((e=>{t=[...t,...e.dependencies||[]]}));const n=new Set(t);return e.filter((e=>!n.has(e.id)))}function me(e){const t=getComputedStyle(e),n=e.clientHeight-parseFloat(t.paddingTop)-parseFloat(t.paddingBottom),i=e.clientWidth-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight);return{height:n,width:i}}class ve{constructor(e,t=!1){ae(this,"pElement"),ae(this,"_exists"),ae(this,"withStyle",(e=>(Object.keys(e).forEach((t=>{this.pElement.style[t]=e[t]})),this))),ae(this,"withAttributes",(e=>(Object.keys(e).forEach((t=>{this.pElement.setAttribute(t,e[t])})),this))),ae(this,"withAbsolutePoint",(e=>(this.pElement.style.position="absolute",this.pElement.style.top=`${e.y}px`,this.pElement.style.left=`${e.x}px`,this))),ae(this,"withAbsolutePosition",(e=>(this.pElement.style.position="absolute",this.pElement.style.top=`${e.y}px`,this.pElement.style.left=`${e.x}px`,this.pElement.style.width=`${e.width}px`,this.pElement.style.height=`${e.height}px`,this))),ae(this,"withSize",(e=>(this.pElement.style.width=`${e.width}px`,this.pElement.style.height=`${e.height}px`,this))),ae(this,"withWidth",(e=>(this.pElement.style.width=`${e}px`,this))),ae(this,"withHeight",(e=>(this.pElement.style.height=`${e}px`,this))),ae(this,"withClassNames",((...e)=>(e.forEach((e=>{this.pElement.classList.add(e)})),this))),this.pElement=e,this._exists=t}get alreadyExists(){return this._exists}get htmlElement(){return this.pElement}get svgElement(){return this.pElement}}function fe(e){return new ve(e)}function ye(e){const t=document.createElement("div");return e&&e.appendChild(t),new ve(t)}function Ee(e,t){let n=e.querySelector(`.${t}`);const i=!!n;return n||(n=document.createElement("div"),n.classList.add(t),e.appendChild(n)),new ve(n,i)}function we(e,t){const n=document.createElementNS("http://www.w3.org/2000/svg",t);return e&&e.appendChild(n),new ve(n)}function be(e,t=":scope>svg",n="nice-dag-svg-arrow"){let i=t?e.querySelector(t):null;if(!i){i=document.createElementNS("http://www.w3.org/2000/svg","svg"),i.style.overflow="hidden";const t=document.createElementNS("http://www.w3.org/2000/svg","defs"),o=document.createElementNS("http://www.w3.org/2000/svg","marker"),s=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("id",n),o.setAttribute("markerUnits","strokeWidth"),o.setAttribute("markerWidth","12"),o.setAttribute("markerHeight","12"),o.setAttribute("viewBox","0 0 12 12"),o.setAttribute("refX","6"),o.setAttribute("refY","6"),o.setAttribute("orient","auto"),s.setAttribute("d","M2,2 L10,6 L2,10 L6,6 L2,2"),s.setAttribute("fill","#000"),o.appendChild(s),t.appendChild(o),i.appendChild(t),e.appendChild(i)}return new ve(i)}function Ne(e){return!e||0===e.length}function De(){return Math.random().toString(16).slice(2)}function Ce(e){return e===1/0?1/0:parseInt(`${Math.round(e+Number.EPSILON)}`)}function xe(e,t){return 1!==t&&t?{x:Ce(e.x/t),y:Ce(e.y/t),top:Ce(e.top/t),left:Ce(e.left/t),width:Ce(e.width/t),height:Ce(e.height/t),bottom:Ce(e.bottom/t),right:Ce(e.right/t)}:e}function Se(e){const t=e.getBoundingClientRect();return{x:t.x,y:t.y,top:t.top,left:t.left,bottom:t.bottom,right:t.right,width:t.width,height:t.height}}function Re(e,t){const n={...e};return Object.keys(t||{}).forEach((e=>n[e]=n[e]||t[e])),n}function _e(e,t){return 180*Math.atan(e/t)/Math.PI}function Le(e){if(!e||0===e.length)return[];const t=e.map((e=>({...e,children:[]}))),n={};return t.forEach((e=>{n[e.id]=e})),t.forEach((e=>{e.parentId&&n[e.parentId].children.push(e)})),t.forEach((e=>{0===e.children.length&&delete e.children})),t.filter((e=>!e.parentId))}function ke(e){return he[e.rankdir||"LR"]}function Me(e,t){return typeof e<"u"?e:t}const Be="nice-dag-node",Ie="nice-dag-edge",Te="data-node-id-key",Ve="nice-dag-svg-bkg-arrow",ze="nice-dag-svg-background",Pe="nice-dag-svg-dnd-arrow",Oe="nice-dag-svg-dnd",Ae="nice-dag-editor-bkg",$e={x:0,y:0,width:0,height:0};class We{constructor(e,t,n,i){ae(this,"joint"),ae(this,"editing"),ae(this,"dependencies"),ae(this,"id"),ae(this,"data"),ae(this,"children"),ae(this,"parentId"),ae(this,"collapse"),ae(this,"x"),ae(this,"y"),ae(this,"width"),ae(this,"height"),ae(this,"listeners",[]),ae(this,"ref"),ae(this,"edgeConnectorType"),ae(this,"model"),ae(this,"addNodeChangeListener",(e=>{this.listeners.some((t=>t===e))||this.listeners.push(e)})),ae(this,"removeNodeChangeListener",(e=>{this.listeners=this.listeners.filter((t=>t!==e))})),ae(this,"fireNodeChange",(e=>{this.listeners.forEach((t=>{t.onNodeChange(e)}))})),this.model=n,this.id=e.id,this.joint=t,this.data=e.data,this.parentId=e.parentId,this.children=e.children,this.dependencies=e.dependencies||[],this.edgeConnectorType=i,this.collapse=e.collapse,this.ref=ye().withClassNames(Be).withAttributes({[`${Te}`]:e.id}).htmlElement}resize(e){this.width=e.width,this.height=e.height,this.doLayout(),this.fireNodeChange({type:le.RESIZE,node:this})}addChildNode(e,t){const n=this.collapse||!this.children||0===this.children.length;this.children||(this.children=[]),this.children.push(e),this.fireNodeChange({type:le.ADD_CHILD_NODE,node:this,data:{point:t,isCollapsed:n,sourceNode:e}})}removeDependency(e){const t=this.dependencies.some((t=>t===e.id));return this.dependencies=this.dependencies.filter((t=>t!==e.id)),t}connect(e){null!=e&&e.dependencies.some((e=>e===this.id))||(e.dependencies||(e.dependencies=[]),e.dependencies.push(this.id),this.model.addEdge(this,e))}doLayout(){fe(this.ref).withAbsolutePosition({x:this.x,y:this.y,width:this.width,height:this.height})}setPoint(e,t=!0){this.x=e.x,this.y=e.y,this.ref&&(this.ref.style.left=`${this.x}px`,this.ref.style.top=`${this.y}px`),t&&this.fireNodeChange({type:le.POSITION_CHANGE,node:this})}setBounds(e,t){this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this.ref&&(this.ref.style.left=`${this.x}px`,this.ref.style.top=`${this.y}px`,this.ref.style.width=`${this.width}px`,this.ref.style.height=`${this.height}px`),t&&this.fireNodeChange({type:le.POSITION_CHANGE,node:this})}shrink(){this.collapse=!0,this.fireNodeChange({type:le.SHRINK_NODE,node:this})}expand(){this.collapse=!1,this.fireNodeChange({type:le.EXPAND_NODE,node:this})}withChildren(e,t=!0){this.children&&t?this.expand():e.then((e=>{this.children=e,this.expand()}))}refresh(){}remove(){var e;null==(e=this.ref)||e.remove(),this.fireNodeChange({type:le.REMOVED,node:this}),this.destory()}destory(){this.listeners=[],this.ref=null}}const je={};function He(e){return e?je[e]:void 0}function Ge(e,t){je[e]=t}const qe=12;class Je{constructor(e,t){ae(this,"source"),ae(this,"target"),ae(this,"pathRef"),ae(this,"ref"),this.source=e,this.target=t,this.pathRef=we(null,"path").withAttributes({"data-source-key":e.id,"data-target-key":t.id}).svgElement,this.ref=ye().withClassNames(Ie).withAbsolutePosition($e).htmlElement,this.source.addNodeChangeListener(this),this.target.addNodeChangeListener(this)}destory(){this.source=null,this.target=null,this.pathRef=null,this.ref=null}onNodeChange(e){e.type===le.POSITION_CHANGE||e.type===le.RESIZE||e.type===le.EXPAND_NODE||e.type===le.SHRINK_NODE?this.doLayout():e.type===le.REMOVED&&(this.remove(),this.destory())}insertNodes(e,t=40){const n=this.getInsertNodesStartPosition(e,t);this.remove(),this.target.model.addNodes(e,n,t).forEach((e=>{this.source.connect(e),e.connect(this.target)})),this.destory()}getInsertNodesStartPosition(e,t){const{graphLabel:n,getNodeSize:i,mapEdgeToPoints:o}=He(this.source.model.dagId).config,{source:s,target:d}=o(this),a=(s.x+d.x)/2,r=(s.y+d.y)/2;let l=0,h=0,c=0,g=0;const p=ke(n);return e.forEach((e=>{const n=i(e);p===he.LR||p===he.RL?h+=n.height+t:l+=n.width+t,c=Math.max(l,n.width),g=Math.max(h,n.height)})),h-=t,l-=t,p===he.LR||p===he.RL?{x:a-c/2,y:r-h/2}:{x:a-l/2,y:r-g/2}}remove(){this.target.removeDependency(this.source),this.target.model.removeEdge(this),this.target.removeNodeChangeListener(this),this.source.removeNodeChangeListener(this),this.pathRef.remove(),this.ref.remove()}doLayout(){const{mapEdgeToPoints:e}=He(this.source.model.dagId).config,{source:t,target:n}=e(this),i=(t.x+n.x)/2,o=(t.y+n.y)/2,s=`M${t.x},${t.y} L${i},${o} L${n.x},${n.y}`;fe(this.pathRef).withAttributes({d:s});const d=Math.sqrt((n.x-t.x)*(n.x-t.x)+(n.y-t.y)*(n.y-t.y)),a=`rotate(${_e(n.y-t.y,n.x-t.x)}deg)`;fe(this.ref).withAbsolutePosition({x:i-d/2,y:o-qe/2,width:d,height:qe}).withStyle({webkitTransform:a,mozTransform:a,msTransform:a,oTransform:a,transform:a})}}function Ze(e,t){const n=new ie.graphlib.Graph;n.setGraph(t),n.setDefaultEdgeLabel((function(){return{}}));const i={};for(let o=0;o<e.length;o++){const t=e[o];n.setNode(`${o}`,{width:t.width,height:t.height}),i[t.id]=o}return e.forEach((e=>{e.dependencies&&!Ne(e.dependencies)&&e.dependencies.filter(Boolean).forEach((t=>{n.setEdge(i[t],i[e.id])}))})),ie.layout(n),n}class Xe{constructor({dagId:e,parentNode:t,nodes:n,vmConfig:i,isRootModel:o}){ae(this,"vNodes"),ae(this,"pChildVMs"),ae(this,"_parentNode"),ae(this,"vmConfig"),ae(this,"pEdges"),ae(this,"pSize"),ae(this,"listeners",[]),ae(this,"isRootModel"),ae(this,"_dagId"),ae(this,"onNodeChange",(e=>{if(e.type===le.EXPAND_NODE)this.setNodeCollapse(e.node,!1);else if(e.type===le.SHRINK_NODE)this.setNodeCollapse(e.node,!0);else if(e.type===le.ADD_CHILD_NODE){const{isCollapsed:t,point:n,sourceNode:i}=e.data;this.fireModelChange({source:this,originalSource:e.node,type:re.ADD_NODE}),t?this.setNodeCollapse(e.node,!1):this.pChildVMs.find((t=>t.id===e.node.id)).addNode(i,n)}else e.type===le.POSITION_CHANGE||e.type===le.RESIZE?this.doLayout(!0,!1):e.type===le.REMOVED&&(this.pChildVMs=this.pChildVMs.filter((t=>t.id!==e.node.id)),this.vNodes=this.vNodes.filter((t=>t.id!==e.node.id)),this.pEdges=this.pEdges.filter((t=>!(t.source.id===e.node.id||t.target.id===e.node.id))),this.fireModelChange({source:this,originalSource:e.node,type:re.REMOVE_NODE}))})),ae(this,"addModelChangeListener",(e=>{this.listeners.some((t=>t===e))||this.listeners.push(e)})),ae(this,"removeNodeChangeListener",(e=>{this.listeners=this.listeners.filter((t=>t===e))})),ae(this,"isSubViewNode",(e=>{var t;return!Ne(null==(t=this.pChildVMs)?void 0:t.filter((t=>t.id===e)))})),ae(this,"findNodeById",(e=>{let t=this.vNodes.find((t=>t.id===e));if(!t&&!Ne(this.pChildVMs))for(let n=0;n<this.pChildVMs.length&&(t=this.pChildVMs[n].findNodeById(e),!t);n++);return t})),ae(this,"init",(e=>{this.buildVNodes(e),this.buildEdges(),this.doLayout(!1,!1)})),ae(this,"setNodeCollapse",((e,t)=>{let n;const{getNodeSize:i}=He(this.dagId).config;if(t)this.pChildVMs=this.pChildVMs.filter((t=>t.id!==e.id)),n=i(e);else{const t=this.createChildVm(e,e.children);this.pChildVMs=[...this.pChildVMs.filter((e=>e.id!==t.id)),t],n=t.size()}e.width=n.width,e.height=n.height;const o=e.editing;e.editing=!1,this.doLayout(!0,!1),e.editing=o,this.fireModelChange({source:this,originalSource:e,type:t?re.REMOVE_SUB_VIEW:re.ADD_SUB_VIEW}),He(this._dagId).fireNiceDagChange()})),ae(this,"fireModelChange",(e=>{this.listeners.forEach((t=>{t.onModelChange(e)}))})),ae(this,"withJointNodes",(()=>{const e=[],t=ue(this.vNodes),n=new Set;return this.vNodes.forEach((i=>{var o;const s=t.some((e=>e.id===i.id));if((null==(o=i.dependencies)?void 0:o.length)>1&&!s){const t=`joint-${i.dependencies.join("-")}`;if(!n.has(t)){const o=new We({id:t,dependencies:i.dependencies},!0,this,this.vmConfig.jointEdgeConnectorType);o.addNodeChangeListener(this),e.push(o),n.add(t)}i.dependencies=[t]}})),[...this.vNodes,...e]})),ae(this,"buildVNodes",(e=>{this.vNodes=e.map((e=>this.toViewNode(e))),this.vmConfig.mode===pe.WITH_JOINT_NODES&&(this.vNodes=this.withJointNodes()),this.withNodeSize()})),ae(this,"withNodeSize",(()=>{const e={},{getNodeSize:t}=He(this.dagId).config;this.pChildVMs.forEach((t=>e[t.id]=t)),this.vNodes.forEach((n=>{const i=e[n.id]&&!n.collapse?e[n.id].size():t(n);n.width=i.width,n.height=i.height}))})),ae(this,"resize",(e=>{const t=this.pSize,n=this.vmConfig.subViewPadding;let i=0,o=0;this.vNodes.forEach((e=>{i=Math.max(e.x+e.width,i),o=Math.max(e.y+e.height,o)})),this.isRoot?this.pSize={width:i,height:o}:this.pSize={width:i+n.left+n.right,height:o+n.top+n.bottom},e&&(this.pSize.width!==t.width||this.pSize.height!==t.height)&&this.fireModelChange({source:this,type:re.RESIZE})})),ae(this,"doLayout",((e,t)=>{t&&this.childVMs.forEach((n=>{n.doLayout(e,t),this.vNodes.find((e=>e.id===n.id)).resize(n.size())}));const n=Ze(this.vNodes,He(this.dagId).config.graphLabel);let i=0;this.vNodes.forEach((e=>{if(!e.editing){const t=n.node(String(i)),{width:o,height:s}=e,d=t.x-o/2,a=t.y-s/2;e.x=d,e.y=a,e.doLayout()}i++})),this.resize(e),this.pEdges.forEach((e=>{e.doLayout()}))})),ae(this,"buildEdges",(()=>{this.pEdges=[];const e={};this.vNodes.forEach((t=>e[t.id]=t)),this.vNodes.forEach((t=>{Ne(t.dependencies)||t.dependencies.forEach((n=>{this.pEdges.push(new Je(e[n],t))}))}))})),ae(this,"size",((e=!0)=>{if(e||this.isRoot)return this.pSize;const t=this.vmConfig.subViewPadding;return{width:this.pSize.width-t.left-t.right,height:this.pSize.height-t.top-t.bottom}}));const s=n;this._dagId=e,this._parentNode=t,this.vmConfig=i,this.isRootModel=o,this.pChildVMs=s.filter((e=>!e.collapse&&!Ne(e.children))).map((e=>this.createChildVm(e,e.children))),this.init(s)}setRootOffset({offsetX:e,offsetY:t}){if(!this.isRoot)throw new Error("Sub model doesn't support the method.");this.vNodes.forEach((n=>{n.x+=e,n.y+=t,n.doLayout()})),this.pEdges.forEach((e=>{e.doLayout()}))}addNodes(e,t,n=40){let i=0;const{getNodeSize:o}=He(this.dagId).config;return e.map((e=>{const s=o(e),d={x:t.x,y:t.y+i};return i+=n+s.height,this.addNode(e,d)}))}addNode(e,t,n){const i=this.toViewNode(e);i.editing=!0,i.joint=n;const{getNodeSize:o}=He(this.dagId).config;this.vNodes.push(i);const s=o(i);return i.width=s.width,i.height=s.height,i.x=t.x,i.y=t.y,this.fireModelChange({source:this,originalSource:i,type:re.ADD_NODE}),e.collapse||Ne(e.children)?(i.fireNodeChange({type:le.POSITION_CHANGE,node:i}),He(this._dagId).fireNiceDagChange()):i.expand(),i}destory(){this.vNodes.forEach((e=>e.destory())),this.pEdges.forEach((e=>e.destory())),this.pChildVMs.forEach((e=>e.destory())),this.listeners=[]}removeEdge(e){return!!this.pEdges.some((t=>t===e))&&(this.pEdges=this.pEdges.filter((t=>t!==e)),He(this._dagId).fireNiceDagChange(),!0)}refreshJointNodes(){if(this.vmConfig.mode===pe.WITH_JOINT_NODES){const e=this.vNodes.filter((e=>e.joint&&1===e.dependencies.length)),t=new Set(e.map((e=>e.id))),n=this.vNodes.filter((e=>e.dependencies.some((e=>t.has(e)))));e.forEach((e=>{const{dependencies:t}=e,i=this.findNodeById(t[0]);n.filter((t=>t.dependencies.some((t=>t===e.id)))).forEach((e=>{e.dependencies.push(i.id),this.createEdgeAndFireModelChange(i,e)}))})),e.forEach((e=>{e.remove()}))}}createEdgeAndFireModelChange(e,t){const n=new Je(e,t);return this.pEdges.push(n),this.fireModelChange({source:this,originalSource:n,type:re.ADD_EDGE}),n.doLayout(),n}findPrecedentedNodes(e){return this.pEdges.filter((t=>t.target.id===e.id)).map((e=>this.findNodeById(e.source.id)))}addEdge(e,t){const n=this.createEdgeAndFireModelChange(e,t);return He(this._dagId).fireNiceDagChange(),n}onModelChange(e){e.source.id!==this.id&&e.type===re.RESIZE&&this.vNodes.find((t=>t.id===e.source.id)).resize(e.source.size())}createChildVm(e,t){const n=new Xe({dagId:this._dagId,parentNode:e,nodes:t,vmConfig:this.vmConfig});return n.addModelChangeListener(this),n}get isRoot(){return this.isRootModel}getAllNodes(){var e;let t=[...this.vNodes];return null==(e=this.pChildVMs)||e.forEach((e=>{t=[...t,...e.getAllNodes()]})),t}getAllEdges(){var e;let t=[...this.edges];return null==(e=this.pChildVMs)||e.forEach((e=>{t=[...t,...e.getAllEdges()]})),t}get dagId(){return this._dagId}toViewNode(e){const t=new We(e,!1,this,e.edgeConnectorType||this.vmConfig.edgeConnectorType);return t.addNodeChangeListener(this),t}get subViewPadding(){return this.vmConfig.subViewPadding}get parentNode(){return this._parentNode}get id(){var e;return null==(e=this._parentNode)?void 0:e.id}get(){return this.pSize}get childVMs(){return this.pChildVMs}get nodes(){return this.vNodes}get edges(){return this.pEdges}}const Ye={rankdir:"LR",ranksep:60,edgesep:10},Fe={color:"blue",size:40},Ue={top:40,bottom:20,left:20,right:20},Ke={top:0,bottom:0,left:0,right:0},Qe={color:"black"};function et(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}const tt={LR:({source:e,target:t})=>{const n=e.edgeConnectorType===ce.CENTER?et(e):{x:e.x+e.width,y:e.y+e.height/2},i=t.edgeConnectorType===ce.CENTER?et(t):{x:t.x,y:t.y+t.height/2};return{source:n,target:i}},RL:({source:e,target:t})=>{const n=e.edgeConnectorType===ce.CENTER?et(e):{x:e.x,y:e.y+e.height/2},i=t.edgeConnectorType===ce.CENTER?et(t):{x:t.x+t.width,y:t.y+t.height/2};return{source:n,target:i}},BT:({source:e,target:t})=>{const n=e.edgeConnectorType===ce.CENTER?et(e):{x:e.x+e.width/2,y:e.y},i=t.edgeConnectorType===ce.CENTER?et(t):{x:t.x+t.width/2,y:t.y+t.height};return{source:n,target:i}},TB:({source:e,target:t})=>{const n=e.edgeConnectorType===ce.CENTER?et(e):{x:e.x+e.width/2,y:e.y+e.height},i=t.edgeConnectorType===ce.CENTER?et(t):{x:t.x+t.width/2,y:t.y};return{source:n,target:i}}};function nt(e){return e?{...e,rankdir:e.rankdir||Ye.rankdir,ranksep:e.ranksep||Ye.ranksep,edgesep:e.edgesep||Ye.edgesep}:Ye}function it(e,t=Ke){return{top:Me(null==e?void 0:e.top,t.top),left:Me(null==e?void 0:e.left,t.left),bottom:Me(null==e?void 0:e.bottom,t.bottom),right:Me(null==e?void 0:e.right,t.right)}}function ot(){return Qe}const st={position:"fixed",top:"0",left:"0",right:"0",bottom:"0",zIndex:"9999",display:"none","user-select":"none",cursor:"pointer"},dt="minimap-dnd-glass";class at{constructor(e){ae(this,"scale"),ae(this,"viewBoxScale"),ae(this,"viewBoxInitX"),ae(this,"viewBoxInitY"),ae(this,"mainLayer"),ae(this,"zoomLayer"),ae(this,"minimapContent"),ae(this,"viewBoxElm"),ae(this,"viewBoxClassname"),ae(this,"canvas"),ae(this,"dndGlass"),ae(this,"initClientX"),ae(this,"initClientY"),ae(this,"listeners",[]),ae(this,"parentContainer"),ae(this,"contentContainer"),ae(this,"onCanvasReady",(e=>{const{mainLayer:t,zoomLayer:n,viewBoxElm:i,minimapContent:o,scale:s}=this,d=t.scrollLeft,a=t.scrollTop,r=t.offsetWidth>n.offsetWidth?1:t.offsetWidth/n.offsetWidth,l=t.offsetHeight>n.offsetHeight?1:t.offsetHeight/n.offsetHeight,h=Math.ceil(e.width*r),c=Math.ceil(e.height*l),g=Math.ceil(d*s*r),p=Math.ceil(a*s*l);fe(i).withStyle({border:"1px red solid",position:"absolute",width:`${h}px`,height:`${c}px`,left:`${g}px`,top:`${p}px`,cursor:"pointer",zIndex:999,display:"block"}),o.appendChild(i),o.appendChild(e)})),ae(this,"updateViewBoxPosition",(()=>{const e=this.mainLayer.scrollLeft,t=this.mainLayer.scrollTop,n=this.canvas.width-this.viewBoxElm.offsetWidth,i=this.canvas.height-this.viewBoxElm.offsetHeight;let o=this.scale*e;o=Math.max(0,o),o=Math.min(o,n);let s=this.scale*t;s=Math.max(0,s),s=Math.min(s,i),fe(this.viewBoxElm).withStyle({left:`${Math.ceil(o)}px`,top:`${Math.ceil(s)}px`})})),ae(this,"startViewBoxDragging",(e=>{this.initClientX=e.clientX,this.initClientY=e.clientY,this.viewBoxInitX=this.viewBoxElm.offsetLeft,this.viewBoxInitY=this.viewBoxElm.offsetTop,fe(this.dndGlass).withStyle({display:"block"})})),ae(this,"onViewBoxDragging",(e=>{const t=e.clientX-this.initClientX,n=e.clientY-this.initClientY,i=this.canvas.width-this.viewBoxElm.offsetWidth/this.viewBoxScale,o=this.canvas.height-this.viewBoxElm.offsetHeight/this.viewBoxScale;let s=this.viewBoxInitX+t,d=this.viewBoxInitY+n;s=Math.max(0,s),s=Math.min(s,i),d=Math.max(0,d),d=Math.min(d,o),this.viewBoxElm.style.left=`${Math.ceil(s)}px`,this.viewBoxElm.style.top=`${Math.ceil(d)}px`,this.listeners.forEach((e=>{e.onMinimapDragging({scrollLeft:s/this.scale,scrollTop:d/this.scale})}))})),ae(this,"onViewBoxDraggingEnd",(()=>{fe(this.dndGlass).withStyle({display:"none"})})),this.viewBoxScale=1,this.mainLayer=e.mainLayer,this.zoomLayer=e.zoomLayer,this.parentContainer=e.container,this.viewBoxElm=this.createViewBoxElement(null==e?void 0:e.viewBoxClassName),this.canvas=document.createElement("canvas"),this.contentContainer=ye(this.parentContainer).withStyle({position:"relative",width:"100%",height:"100%",display:"flex","justify-content":"center","place-content":"center","align-content":"center","flex-wrap":"nowrap","flex-direction":"column","align-items":"center"}).htmlElement,this.minimapContent=this.createMinimapElement(null==e?void 0:e.className);const t=Ee(this.mainLayer,dt).withStyle(st);t.htmlElement.addEventListener("mousemove",this.onViewBoxDragging),t.htmlElement.addEventListener("mouseup",this.onViewBoxDraggingEnd),this.dndGlass=t.htmlElement}addMinimapListener(e){this.listeners.push(e)}createMinimapElement(e){const t=ye(this.contentContainer).withClassNames("nice-dag-minimap").withStyle({position:"relative"}).htmlElement;return e&&t.classList.add(e),t}createViewBoxElement(e){const t=ye(this.contentContainer).withClassNames("nice-dag-minimap").withStyle({position:"relative"}).htmlElement;return t.classList.add("nice-dag-minimap-viewbox"),e&&t.classList.add(e),t.addEventListener("mousedown",this.startViewBoxDragging),t}calcRatio(){const e=me(this.parentContainer),t=this.zoomLayer.getBoundingClientRect();t.width/t.height>1?this.scale=e.width/t.width:this.scale=e.height/t.height}useWidth(){const e=this.zoomLayer.getBoundingClientRect();return e.width/e.height>1}render(){this.clear(),this.calcRatio();const e=this.parentContainer.getBoundingClientRect(),t=this.zoomLayer,n=t.getBoundingClientRect().width*this.scale,i=t.getBoundingClientRect().height*this.scale,{viewBoxElm:o}=this;fe(o).withStyle({display:"none"}),this.useWidth()?(this.canvas.style.width="100%",fe(this.minimapContent).withStyle({width:"100%",height:"auto"}),this.canvas.style.top=`${Ce((e.height-i)/2)}px`):(this.canvas.style.height="100%",fe(this.minimapContent).withStyle({width:"auto",height:"100%"}),this.canvas.style.left=`${Ce((e.width-n)/2)}px`),this.canvas.width=Math.ceil(n),this.canvas.height=Math.ceil(i);const s=setTimeout((()=>{window.clearTimeout(s),oe(t,{useCORS:!0,scale:this.scale,canvas:this.canvas,scrollY:0,scrollX:0}).then(this.onCanvasReady)}),50)}destory(){this.listeners=[],this.clear()}clear(){this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height)}setViewBoxScale(e){this.viewBoxScale=e;let t=this.viewBoxElm;const n=this.canvas.width/t.offsetWidth,i=this.canvas.height/t.offsetHeight,o=Math.min(1/e,n),s=Math.min(1/e,i);t.style.transform=`scale(${o}, ${s})`,t.style.transformOrigin="left top"}}const rt="nice-dag-main-layer",lt="nice-dag-zoom-layer",ht="nice-dag-content-layer",ct="nice-dag-nodes-layer",gt={position:"relative",height:"100%",width:"100%"};function pt(e){const t=nt(e.graphLabel),n=it(e.subViewPadding,Ue);return{...e,getEdgeAttributes:e.getEdgeAttributes||ot,graphLabel:t,mode:e.mode||pe.WITH_JOINT_NODES,subViewPadding:n,gridConfig:Re(e.gridConfig,Fe),edgeConnectorType:e.edgeConnectorType||ce.CENTER_OF_BORDER,jointEdgeConnectorType:e.jointEdgeConnectorType||ce.CENTER}}class ut{constructor({viewConfig:e,model:t}){var n;ae(this,"nodesLayer"),ae(this,"contentLayer"),ae(this,"svgLayer"),ae(this,"viewConfig"),ae(this,"subViews"),ae(this,"model"),ae(this,"appendNode",(e=>{this.nodesLayer.appendChild(e.ref),this.viewConfig.mapNodeToElement&&e.ref.appendChild(this.viewConfig.mapNodeToElement(e))})),ae(this,"getContentElement",(()=>this.contentLayer)),ae(this,"getEdgeLabel",((e,t)=>{throw new Error(`Can't support the method with ${e}, ${t}`)})),ae(this,"renderEdge",(e=>{const t=e.pathRef,n=this.viewConfig.getEdgeAttributes(e),i=fe(t).withAttributes({stroke:n&&n.color?n.color:"rgb(204, 204, 204)"}).svgElement;n.hideArrow||i.setAttribute("marker-mid",`url(#${this.model.dagId}-nice-dag-svg-arrow)`)})),ae(this,"getNodeLayerSizeStyle",(()=>{const e=this.model.size(!1);return{position:"relative",width:`${e.width}px`,height:`${e.height}px`,"z-index":"1"}})),ae(this,"getContentLayerStyle",(()=>{const e=this.model.size();return{position:"absolute",top:0,left:0,height:`${e.height}px`,width:`${e.width}px`}})),ae(this,"render",(e=>{if(!this.model.isRoot){const t=this.viewConfig.subViewPadding;fe(e).withStyle({"padding-top":`${t.top}px`,"padding-bottom":`${t.bottom}px`,"padding-left":`${t.left}px`,"padding-right":`${t.right}px`})}this.nodesLayer=ye(e).withStyle(this.getNodeLayerSizeStyle()).withClassNames(ct).htmlElement,this.svgLayer=be(this.nodesLayer,null,`${this.model.dagId}-nice-dag-svg-arrow`).withAttributes({width:"100%",height:"100%"}).svgElement,this.contentLayer=ye(e).withStyle(this.getContentLayerStyle()).withClassNames(ht).htmlElement,this.appendViewElement(this.model.parentNode,this.contentLayer);const t={};this.model.nodes.forEach((e=>{this.appendNode(e),!Ne(e.children)&&!e.collapse&&(t[e.id]=e.ref,e.ref.setAttribute("data-subview-key","true"))})),this.model.edges.forEach((e=>{this.svgLayer.appendChild(e.pathRef),this.nodesLayer.appendChild(e.ref),this.renderEdge(e)})),Ne(this.subViews)||this.subViews.forEach((e=>{e.render(t[e.model.id])}))})),ae(this,"appendViewElement",((e,t)=>{if(this.viewConfig.getViewElement){const n=this.viewConfig.getViewElement(e);n&&t.appendChild(n)}})),ae(this,"resize",(()=>{fe(this.nodesLayer).withStyle(this.getNodeLayerSizeStyle()),fe(this.contentLayer).withStyle(this.getContentLayerStyle())})),ae(this,"destory",(()=>{this.clear(),this.model.removeNodeChangeListener(this)})),this.viewConfig=e,this.model=t,this.model.addModelChangeListener(this),this.subViews=null==(n=this.model.childVMs)?void 0:n.map((t=>new ut({viewConfig:e,model:t})))}justifySize(e){e.width>0&&(this.nodesLayer.style.width=`${e.width}px`,this.contentLayer.style.width=`${e.width}px`),e.height>0&&(this.nodesLayer.style.height=`${e.height}px`,this.contentLayer.style.height=`${e.height}px`)}clear(){var e,t;fe(this.nodesLayer.parentElement).withStyle({"padding-top":0,"padding-bottom":0,"padding-left":0,"padding-right":0}),null==(e=this.nodesLayer)||e.remove(),null==(t=this.contentLayer)||t.remove()}onModelChange(e){var t,n,i;if(e.type===re.REMOVE_SUB_VIEW)(null==(t=this.subViews)?void 0:t.find((t=>t.model.id===e.originalSource.id))).destory(),this.subViews=null==(n=this.subViews)?void 0:n.filter((t=>t.model.id!==`${e.originalSource.id}`));else if(e.type===re.ADD_SUB_VIEW){const t={};this.subViews.forEach((e=>t[e.model.id]=e)),this.subViews=null==(i=this.model.childVMs)?void 0:i.map((n=>{let i=t[n.id];if(!i){const t=new ut({viewConfig:this.viewConfig,model:n}),o=this.nodesLayer.querySelector(`[${Te}='${e.originalSource.id}']`);t.render(o),i=t}return i}))}else e.type===re.RESIZE?this.resize():e.type===re.ADD_EDGE?(this.svgLayer.appendChild(e.originalSource.pathRef),this.nodesLayer.appendChild(e.originalSource.ref),e.originalSource.doLayout(),this.renderEdge(e.originalSource)):e.type===re.ADD_NODE&&(e.originalSource.doLayout(),this.nodesLayer.appendChild(e.originalSource.ref))}getAllNodes(){return this.model.getAllNodes()}getAllEdges(){return this.model.getAllEdges()}}class mt{constructor(e){ae(this,"_rootContainer"),ae(this,"zoomLayer"),ae(this,"_config"),ae(this,"mainLayer"),ae(this,"rootView"),ae(this,"minimap"),ae(this,"rootModel"),ae(this,"uid"),ae(this,"listeners",[]),ae(this,"parentSize"),ae(this,"_scale"),ae(this,"useDefaultMapEdgeToPoints"),ae(this,"destoried"),ae(this,"getRootContentElement",(()=>this.rootView.getContentElement())),ae(this,"findNodeById",(e=>this.rootModel.findNodeById(e))),ae(this,"getElementByNodeId",(e=>{let t=this.zoomLayer.querySelector(`[${Te}='${e}']>.${ht}`);return t||(t=this.zoomLayer.querySelector(`[${Te}='${e}']`)),t})),ae(this,"getEdgeLabel",((e,t)=>this.rootView.getEdgeLabel(e,t))),ae(this,"scrollTo",(e=>{const t=this.getElementByNodeId(e),n=this.rootContainer.getBoundingClientRect();if(t){const e=t.getBoundingClientRect();this.mainLayer.scrollTop+=e.y-n.y-n.height/2,this.mainLayer.scrollLeft+=e.x-n.x}})),ae(this,"getScrollPosition",(()=>({x:this.mainLayer.scrollLeft,y:this.mainLayer.scrollTop}))),ae(this,"fireNiceDagChange",(()=>{this.listeners.forEach((e=>e.onChange())),this.fireMinimapChange()})),ae(this,"fireMinimapChange",(()=>{var e;null==(e=this.minimap)||e.render()})),ae(this,"addNiceDagChangeListener",(e=>(this.listeners.every((t=>t!==e))&&this.listeners.push(e),!1))),ae(this,"removeNiceDagChangeListener",(e=>(this.listeners.some((t=>t===e))&&(this.listeners=this.listeners.filter((t=>t===e))),!1))),ae(this,"onMainLayerScroll",(()=>{var e;null==(e=this.minimap)||e.updateViewBoxPosition()})),this.uid=e.id||De();const{container:t,minimapContainer:n,minimapConfig:i,...o}=pt(e);this._config=o,this._config.mapEdgeToPoints=e.mapEdgeToPoints,this._config.mapEdgeToPoints||(this._config.mapEdgeToPoints=tt[this._config.graphLabel.rankdir],this.useDefaultMapEdgeToPoints=!0),this._rootContainer=t,this.mainLayer=Ee(this.rootContainer,rt).withStyle({...gt,overflow:"auto"}).htmlElement,this.mainLayer.addEventListener("scroll",this.onMainLayerScroll),this.zoomLayer=Ee(this.mainLayer,lt).withStyle({position:"absolute","z-index":1}).htmlElement,n&&(this.minimap=new at({mainLayer:this.mainLayer,zoomLayer:this.zoomLayer,container:n,...i}),this.minimap.addMinimapListener(this))}setDirection(e){this._config.graphLabel.rankdir=e,this.useDefaultMapEdgeToPoints&&(this._config.mapEdgeToPoints=tt[this._config.graphLabel.rankdir]),this.prettify()}prettify(){this.rootModel.doLayout(!0,!0),this.justifyCenter(this.parentSize),this.fireMinimapChange()}onMinimapDragging(e){const{scrollLeft:t,scrollTop:n}=e;this.mainLayer.scrollTop=n,this.mainLayer.scrollLeft=t}onModelChange(e){e.type===re.RESIZE&&fe(this.zoomLayer).withSize(this.rootView.model.size()),(e.type===re.RESIZE||e.type===re.ADD_SUB_VIEW||e.type===re.REMOVE_SUB_VIEW)&&this.justifyCenter(this.parentSize)}get config(){return this._config}get rootContainer(){return this._rootContainer}get id(){return this.uid}center(e){return this.parentSize=e,this.justifyCenter(this.parentSize),this.fireMinimapChange(),this}justifyCenter(e){if(e){const t=this.zoomLayer.getBoundingClientRect();let n=0,i=0;e.width>t.width&&(n=(e.width-t.width)/2),e.height>t.height&&(i=(e.height-t.height)/2),this.zoomLayer.style.left=`${n}px`,this.zoomLayer.style.top=`${i}px`}}withNodes(e){var t,n,i,o;null==(t=this.rootModel)||t.destory(),this.destoried?null==(o=this.minimap)||o.addMinimapListener(this):(null==(n=this.rootView)||n.clear(),null==(i=this.minimap)||i.clear());const s=this.config.modelType===ge.FLATTEN?Le(e):e,d=JSON.parse(JSON.stringify(s));return this.rootModel=new Xe({dagId:this.uid,parentNode:{id:"root"},nodes:d,vmConfig:this.config,isRootModel:!0}),this.rootView=new ut({model:this.rootModel,viewConfig:this.config}),this.rootModel.addModelChangeListener(this),this.destoried=!1,this}getAllNodes(){return this.rootView.getAllNodes()}getAllEdges(){return this.rootView.getAllEdges()}render(){var e;this.rootView.render(this.zoomLayer),null==(e=this.minimap)||e.render(),fe(this.zoomLayer).withAbsolutePosition({x:0,y:0,...this.rootView.model.size()}),this.parentSize&&this.justifyCenter(this.parentSize)}get isDestoried(){return this.destoried}destory(){var e;this.destoried=!0,this.listeners=[],this.rootView.destory(),null==(e=this.minimap)||e.destory()}setScale(e){this._scale=e,this.zoomLayer.style.transform=`scale(${e})`,this.zoomLayer.style.transformOrigin="left top",this.zoomLayer.setAttribute("data-zoom-ratio-key",`${e}`),this.parentSize&&this.justifyCenter(this.parentSize),this.minimap&&this.minimap.setViewBoxScale(e)}get scale(){return this._scale||1}}var vt=(e=>(e.LeftToRight="LeftToRight",e.RightToLeft="RightToLeft",e.None="None",e))(vt||{}),ft=(e=>(e.TopToBottom="TopToBottom",e.BottomToTop="BottomToTop",e.None="None",e))(ft||{});const yt="dnd-glass",Et={position:"fixed",top:"0",left:"0",right:"0",bottom:"0",zIndex:"9999",display:"none","user-select":"none"};function wt(e,t){return t.x<=e.x&&t.y<=e.y&&t.right>=e.x&&t.bottom>=e.y}class bt{constructor(e,t,n){ae(this,"_rootContainer"),ae(this,"_glassStyles"),ae(this,"draggingNode"),ae(this,"draggingElement"),ae(this,"_enabled"),ae(this,"editableGlass"),ae(this,"context"),ae(this,"isDraggingEdge"),ae(this,"mapEdgeToPoints"),ae(this,"draggingNodeParentBounds"),ae(this,"eligibleEdgeConnectors",[]),ae(this,"originalScrollPosition"),ae(this,"buildGlass",(()=>{var e;const t=Ee(document.body,yt).withStyle({...Et,cursor:(null==(e=this._glassStyles)?void 0:e.cursor)||"pointer"});t.alreadyExists||(t.htmlElement.addEventListener("mousemove",this.onDragging),t.htmlElement.addEventListener("mouseup",this.endDragging)),this.editableGlass=t.htmlElement})),ae(this,"setEnabled",(e=>{this._enabled=e})),ae(this,"initContext",(e=>{this.originalScrollPosition={x:this._rootContainer.scrollLeft,y:this._rootContainer.scrollTop},this.draggingNode=e,this.draggingNodeParentBounds=Se(e.ref.parentElement);const t=e.ref.parentElement.querySelectorAll(`:scope>.${Be}`);this.eligibleEdgeConnectors=[],t.forEach((t=>{t!==e.ref&&this.eligibleEdgeConnectors.push({viewNode:e.model.findNodeById(t.getAttribute(Te)),bounds:Se(t)})}))})),ae(this,"withContext",(e=>(this.context=e,this))),ae(this,"startNodeDragging",((e,t)=>{if(this._enabled){fe(this.editableGlass).withStyle({display:"block"}),this.initContext(e),this.updateRelativeMousePoint({x:t.pageX,y:t.pageY}),this.draggingElement=fe(e.ref.cloneNode(!0)).withStyle({transform:`scale(${this.context.provider.scale})`,transformOrigin:"top left"}).htmlElement;const n=this.context.lastBounds();fe(this.draggingElement).withStyle({"user-select":"none","z-index":9}).withAbsolutePoint({x:n.left,y:n.top}),this.editableGlass.appendChild(this.draggingElement)}})),ae(this,"startEdgeDragging",((e,t)=>{if(this._enabled){fe(this.editableGlass).withStyle({display:"block"}),this.isDraggingEdge=!0;const n=this.context.provider.svgDndBackground;this.draggingElement=we(n,"path").withAttributes({stroke:"rgb(204, 204, 204)","marker-mid":`url(#${e.model.dagId}-${Pe})`}).svgElement,this.initContext(e),this.updateRelativeMousePoint({x:t.pageX,y:t.pageY})}})),ae(this,"onDragging",(e=>{if(e.stopPropagation(),0===e.button){const t={x:e.pageX,y:e.pageY};if(this.context){const e=this._rootContainer.getBoundingClientRect(),n=this.context.xDirection(t,e),i=this.context.yDirection(t,e);this.updateRelativeMousePoint(t),this.isDraggingEdge?this.renderDraggingEdge(t):this.onDraggingNode(n,i)}}})),ae(this,"endDragging",(e=>{var t;null==(t=this.draggingElement)||t.remove();const n={x:e.pageX,y:e.pageY};this.updateRelativeMousePoint(n);const i={x:this._rootContainer.scrollLeft-this.originalScrollPosition.x,y:this._rootContainer.scrollTop-this.originalScrollPosition.y},o=this.context.provider.scale||1;let s;this.isDraggingEdge?(s=this.findPotentialEdgeTarget(n),s&&this.draggingNode.connect(s)):this.draggingNode.setPoint({x:this.draggingNode.x+this.context.xyDelta.x/o+i.x,y:this.draggingNode.y+this.context.xyDelta.y/o+i.y}),fe(this.editableGlass).withStyle({display:"none"}),fe(this.context.provider.svgDndBackground).withStyle({display:"none"}),this.isDraggingEdge?this.context.provider.endEdgeDragging(this.draggingNode,s):this.context.provider.endNodeDragging(this.draggingNode),this.isDraggingEdge=!1})),ae(this,"updateRelativeMousePoint",(e=>{const t=this._rootContainer.getBoundingClientRect();if(this.context.moveTo(e,t),!this.isDraggingEdge){const n=this.context.lastBounds(),i=this.context.provider.getParentTopLeft(this.draggingNode);let o=0,s=0;n.left<i.x&&(o=i.x-n.left),n.top<i.y&&(s=i.y-n.top),this.context.moveTo({x:e.x+o,y:e.y+s},t)}})),ae(this,"scrollIfNeeded",(({xDirection:e,yDirection:t})=>{const n=this._rootContainer.getBoundingClientRect(),i=Se(this.draggingElement);this.context.provider.resizeIfNeeded(i);let o=0,s=0;e===vt.LeftToRight&&i.right>n.right&&(o=i.right-n.right),e===vt.RightToLeft&&i.left<n.left&&(o=-(n.left-i.left)),t===ft.TopToBottom&&i.bottom>=n.bottom-20&&(s=i.bottom-(n.bottom-20)),t===ft.BottomToTop&&i.top<n.top&&(s=-(n.top-i.top)),this._rootContainer.scrollLeft+=o,this._rootContainer.scrollTop+=s})),this._rootContainer=e,this._glassStyles=t,this.mapEdgeToPoints=n,this.buildGlass()}destory(){this.editableGlass.remove()}renderDraggingEdge(e){let t=this.draggingNode;const n=this.findPotentialEdgeTarget(e);n&&(t=n);const{source:i,target:o}=this.mapEdgeToPoints({source:this.draggingNode,target:t}),s=this.context.provider.scale||1,d=xe(this.context.provider.svgDndBackground.getBoundingClientRect(),s),a=xe(this.draggingNodeParentBounds,s),r={x:i.x+a.x-d.x,y:i.y+a.y-d.y},l={x:o.x+a.x,y:o.y+a.y},h={x:(t!==this.draggingNode?l.x:Ce(e.x/s))-d.x,y:(t!==this.draggingNode?l.y:Ce(e.y/s))-d.y},c=(r.x+h.x)/2,g=(r.y+h.y)/2,p=`M${r.x},${r.y} L${c},${g} L${h.x},${h.y}`;fe(this.draggingElement).withAttributes({d:p})}findPotentialEdgeTarget(e){var t;const n=this.eligibleEdgeConnectors.find((t=>wt(e,t.bounds)));return!n||null!=(t=n.viewNode.dependencies)&&t.some((e=>e===this.draggingNode.id))||He(this.draggingNode.model.dagId).config.mode!==pe.WITH_JOINT_NODES||n.viewNode.dependencies&&0!==n.viewNode.dependencies.length&&!n.viewNode.joint?null:n.viewNode}onDraggingNode(e,t){const n=this.context.lastBounds();this.scrollIfNeeded({xDirection:e,yDirection:t}),fe(this.draggingElement).withAbsolutePoint({x:n.left,y:n.top})}}const Nt=200;class Dt{constructor({rootXy:e,mPoint:t,bounds:n,scale:i,provider:o}){ae(this,"mouseDownTimestamp"),ae(this,"originalBounds"),ae(this,"_originalPoint"),ae(this,"mrPoint"),ae(this,"originalOffset"),ae(this,"rootXy"),ae(this,"invalidDropping"),ae(this,"_provider"),ae(this,"dir"),ae(this,"_scale"),ae(this,"validDndThreshold"),ae(this,"moveTo",((e,t)=>{this.mrPoint={x:e.x-t.x,y:e.y-t.y}})),ae(this,"xDirection",((e,t)=>{const n=e.x-t.left,i=(this.mrPoint||{x:0}).x;return i<n?vt.LeftToRight:i===n?vt.None:vt.RightToLeft})),ae(this,"yDirection",((e,t)=>{const n=e.y-t.top;return(this.mrPoint||{y:0}).y<n?ft.TopToBottom:(this.mrPoint||{y:0}).y==n?ft.None:ft.BottomToTop})),ae(this,"allowDrop",(()=>{if(this.mouseDownTimestamp&&(new Date).getTime()-this.mouseDownTimestamp<=Nt)return!1;const e=this.xyDelta;return!(Math.abs(e.x)<=5&&Math.abs(e.y)<=5)})),this.mouseDownTimestamp=(new Date).getTime(),this.rootXy=e,this._scale=i;const{x:s,y:d}=e;this._originalPoint={x:t.x-s,y:t.y-d},this.originalBounds={x:n.left,y:n.top,left:n.left,top:n.top,width:n.width,height:n.height,right:n.left+n.width,bottom:n.top+n.height},this.originalOffset={x:this._originalPoint.x-this.originalBounds.x,y:this._originalPoint.y-this.originalBounds.y},this.mrPoint=this._originalPoint,this._provider=o,this.validDndThreshold=(null==o?void 0:o.validDndThreshold)||3}get originalPoint(){return this._originalPoint}lastBounds(e=!1){const t=this.xyDelta,{x:n,y:i}={x:this.originalBounds.left+t.x,y:this.originalBounds.top+t.y},o=e?n-this.rootXy.x:n,s=e?i-this.rootXy.y:i;return{...this.originalBounds,x:o,y:s,left:o,top:s,right:o+this.originalBounds.width,bottom:s+this.originalBounds.height}}get xyDelta(){return{x:this.mrPoint.x-this._originalPoint.x,y:this.mrPoint.y-this._originalPoint.y}}topLeftDelta(e){return{x:e.x-(this._originalPoint.x-this.originalOffset.x),y:e.y-(this._originalPoint.y-this.originalOffset.y)}}get provider(){return this._provider}get point(){return this.mrPoint}}const Ct="http://www.w3.org/2000/svg";class xt{constructor(e,t,n){ae(this,"gridSize"),ae(this,"svg"),ae(this,"_scale"),ae(this,"_xArr"),ae(this,"_yArr"),ae(this,"xLines",[]),ae(this,"yLines",[]),ae(this,"_visible"),ae(this,"doLayout",(()=>{const e=this.svg.getBoundingClientRect(),t=xe(e,this._scale||1);this._xArr=[];for(let n=0;n<=t.width;)this._xArr.push(n),n+=this.gridSize;this._yArr=[];for(let n=0;n<=t.height;)this._yArr.push(n),n+=this.gridSize})),ae(this,"getLines",((e=!1)=>{const t=this.svg.getBoundingClientRect(),n=xe(t,this._scale||1);return(e?this._yArr:this._xArr).map((t=>e?{x1:0,y1:t,x2:n.width,y2:t}:{x1:t,y1:0,x2:t,y2:n.height}))})),ae(this,"gridPoint",(e=>{const t=this.svg.getBoundingClientRect(),n={x:Ce(e.x/this.scale),y:Ce(e.y/this.scale)},i=xe(t,this.scale),{xArr:o,yArr:s}=this,d={column:-1,row:-1};if(n.x>=i.left+o[0]){for(let e=0;e<o.length;e++)if(n.x<i.left+o[e]){d.column=e-1;break}-1===d.column&&(d.column=o.length-2),d.column>o.length-2&&(d.column=o.length-2)}if(n.y>=i.top+s[0]){for(let e=0;e<s.length;e++)if(n.y<i.top+s[e]){d.row=e-1;break}-1===d.row&&(d.row=s.length-2),d.row>s.length-2&&(d.row=s.length-2)}return d.column>=0&&d.row>=0?{x:o[d.column]+t.left,y:s[d.row]+t.top}:{x:t.left,y:t.top}})),ae(this,"render",(()=>{this._visible=!0,this.clear(),this.doLayout(),this.getLines().forEach((e=>{this.appendLine(e,!1)})),this.getLines(!0).forEach((e=>{this.appendLine(e,!0)}))})),this.gridSize=t,this.svg=e,this._scale=n||1,this._visible=!1}get visible(){return this._visible}clear(){this.svg.innerHTML="",this.xLines=[],this.yLines=[]}get xArr(){return this._xArr}get yArr(){return this._yArr}appendLine(e,t){const n=document.createElementNS(Ct,"line");n.setAttribute("class","nice-dag-dnd-svg-layer-dash-line"),n.setAttribute("x1",`${e.x1}`),n.setAttribute("x2",`${e.x2}`),n.setAttribute("y1",`${e.y1}`),n.setAttribute("y2",`${e.y2}`),fe(n).withAttributes({stroke:"#9a9a9a","stroke-width":1,"stroke-dasharray":"2, 4"}),t?this.yLines.push(n):this.xLines.push(n),this.svg.appendChild(n)}redraw(){const{xArr:e,yArr:t}=this;this.doLayout();const n=this.getLines();if(this._xArr.length>e.length)for(let o=0;o<this._xArr.length;o++){const t=n[o];o>=e.length&&this.appendLine(t,!1)}for(let o=0;o<n.length;o++){const e=n[o];fe(this.xLines[o]).withAttributes({x1:`${e.x1}`,x2:`${e.x2}`,y1:`${e.y1}`,y2:`${e.y2}`})}const i=this.getLines(!0);if(this._yArr.length>t.length)for(let o=0;o<this._yArr.length;o++){const e=i[o];o>=t.length&&this.appendLine(e,!0)}for(let o=0;o<i.length;o++){const e=i[o];fe(this.yLines[o]).withAttributes({x1:`${e.x1}`,x2:`${e.x2}`,y1:`${e.y1}`,y2:`${e.y2}`})}}set scale(e){this._scale=e}}class St extends mt{constructor(e){super(e),ae(this,"_dnd"),ae(this,"_editing"),ae(this,"svgGridBkg"),ae(this,"svgDndBkg"),ae(this,"editorBkgContainer"),ae(this,"_grid"),ae(this,"glassStyles"),ae(this,"startEditing",(()=>{this._editing=!0,this.getAllNodes().forEach((e=>e.editing=!0)),this._dnd.setEnabled(!0),this.setGridVisible(!0)})),ae(this,"stopEditing",(()=>{this._editing=!1,this.getAllNodes().forEach((e=>e.editing=!1)),this._dnd.setEnabled(!1),this.setGridVisible(!1)})),ae(this,"startEdgeDragging",((e,t)=>{if(this._editing){fe(this.svgDndBkg).withStyle({display:"block"});const n=this._rootContainer.getBoundingClientRect(),i=e.ref.getBoundingClientRect();this._dnd.withContext(new Dt({rootXy:{x:n.left,y:n.y},mPoint:{x:t.pageX,y:t.pageY},bounds:i,scale:this._scale,provider:this})).startEdgeDragging(e,t)}})),ae(this,"startNodeDragging",((e,t)=>{if(this._editing){fe(this.svgDndBkg).withStyle({display:"block"}),e.editing=!0;const n=this._rootContainer.getBoundingClientRect(),i=e.ref.getBoundingClientRect();this._dnd.withContext(new Dt({rootXy:{x:n.left,y:n.y},mPoint:{x:t.pageX,y:t.pageY},bounds:i,scale:this._scale,provider:this})).startNodeDragging(e,t)}})),this._dnd=new bt(this.mainLayer,e.glassStyles,this._config.mapEdgeToPoints),this.editorBkgContainer=Ee(this.mainLayer,Ae).htmlElement,this.svgGridBkg=be(this.editorBkgContainer,null,`${this.uid}-${Ve}`).withStyle({width:"100%",height:"100%"}).withClassNames(ze).svgElement,this.svgDndBkg=be(this.editorBkgContainer,null,`${this.uid}-${Pe}`).withClassNames(Oe).withAbsolutePosition($e).withStyle({width:"100%",height:"100%",display:"none","z-index":99}).svgElement}endNodeDragging(){this.fireMinimapChange()}endEdgeDragging(){this.fireMinimapChange()}get svgDndBackground(){return this.svgDndBkg}onModelChange(e){super.onModelChange(e),e.type===re.RESIZE?this._editing&&(this.doBackgroundLayout(),this._grid.redraw(),this.fireMinimapChange()):e.type===re.REMOVE_NODE&&this.fireMinimapChange()}get grid(){return this._grid}get validDndThreshold(){return 3}addJointNode(e,t,n="root"){"root"===n?this.rootModel.addNode(e,t,!0):this.rootModel.findNodeById(n).addChildNode(e,t)}addNode(e,t,n="root"){"root"===n?this.rootModel.addNode(e,t):this.rootModel.findNodeById(n).addChildNode(e,t)}withNodes(e){const t=this.isDestoried;return super.withNodes(e),t&&(this._dnd=new bt(this.mainLayer,this.glassStyles,this._config.mapEdgeToPoints),this._editing?this.startEditing():this.stopEditing()),this}get editing(){return this._editing}center(e){return this._editing||(super.center(e),this.doBackgroundLayout(),this.setGridVisible(this._editing)),this}doBackgroundLayout(){const e=this.zoomLayer.getBoundingClientRect(),{scale:t=1}=this,n=this.mainLayer.getBoundingClientRect(),i={width:Ce(e.width/t),height:Ce(e.height/t)};e.width<n.width&&(i.width=Ce(n.width/t)),e.height<n.height&&(i.height=Ce(n.height/t));const o={x:0,y:0,...i};fe(this.editorBkgContainer).withAbsolutePosition(o)}setGridVisible(e){e?this._grid.render():this._grid.clear()}prettify(){const e=this.editing;this.stopEditing(),this.rootModel.doLayout(!0,!0),this.justifyCenter(this.parentSize),e&&this.startEditing()}resizeBackground(e,t){const n=e.getBoundingClientRect(),i=t.x+t.width-n.x,o=t.y+t.height-n.y;if(n.width<i){const e=Ce(i/(this._scale||1));fe(this.svgDndBackground).withWidth(e),fe(this.svgGridBkg).withWidth(e)}if(n.height<o){const e=Ce(o/(this._scale||1));fe(this.svgDndBackground).withHeight(e),fe(this.svgGridBkg).withHeight(e)}return n.width<i||n.height<o}resizeIfNeeded(e){const t=this.resizeBackground(this.svgGridBkg,e);return t&&this._grid.redraw(),t}render(){var e;super.render(),this.doBackgroundLayout(),this._grid=new xt(this.svgGridBkg,null==(e=this.config.gridConfig)?void 0:e.size,this._scale),this.setGridVisible(this._editing)}justifyCenter(e){if(!this._editing&&e){const t=this.zoomLayer.getBoundingClientRect();let n=0,i=0,o=0,s=0;e.width>t.width&&(n=(e.width-t.width)/2,o=Ce(e.width/this.scale)),e.height>t.height&&(i=(e.height-t.height)/2,s=Ce(e.height/this.scale)),this.rootView.justifySize({width:o,height:s}),(n>0||i>0)&&this.rootModel.setRootOffset({offsetX:Ce(n/this.scale),offsetY:Ce(i/this.scale)}),this.doBackgroundLayout()}}setScale(e){super.setScale(e),this.editorBkgContainer.style.transform=`scale(${e})`,this.editorBkgContainer.style.transformOrigin="left top",this.doBackgroundLayout(),this._grid.scale=e,this.grid.visible&&this._grid.redraw()}getParentTopLeft(e){const t=e.ref.parentElement.getBoundingClientRect();return{x:t.left,y:t.top}}destory(){super.destory(),this._dnd.destory()}}function Rt(e,t=!1){const n=t?new St(e):new mt(e);return Ge(n.id,n),n}const _t={use:He,init:Rt},Lt=(0,o.aZ)({props:{niceDagReactive:Object}}),kt=(e,t)=>{const n=e.__vccOpts||e;for(const[i,o]of t)n[i]=o;return n},Mt={key:0};function Bt(e,t,n,i,s,d){var a,r;return e.niceDagReactive&&e.niceDagReactive.observor>0?((0,o.wg)(),(0,o.iD)("div",Mt,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((null==(r=null==(a=e.niceDagReactive)?void 0:a.use())?void 0:r.getAllEdges())||[],(t=>((0,o.wg)(),(0,o.j4)(o.lR,{key:`edge-${t.source.id}-${t.target.id}`,to:t.ref},[(0,o.WI)(e.$slots,"default",{edge:t})],8,["to"])))),128))])):(0,o.kq)("",!0)}const It=kt(Lt,[["render",Bt]]),Tt=(0,o.aZ)({props:{niceDagReactive:Object},setup(e){return{getDomRef(t){var n,i;return null==(i=null==(n=e.niceDagReactive)?void 0:n.use())?void 0:i.getElementByNodeId(t.id)}}}}),Vt={key:0};function zt(e,t,n,i,s,d){var a,r;return e.niceDagReactive&&e.niceDagReactive.observor>0?((0,o.wg)(),(0,o.iD)("div",Vt,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((null==(r=null==(a=e.niceDagReactive)?void 0:a.use())?void 0:r.getAllNodes())||[],(t=>((0,o.wg)(),(0,o.j4)(o.lR,{key:t.id,to:e.getDomRef(t)},[(0,o.WI)(e.$slots,"default",{node:t})],8,["to"])))),128))])):(0,o.kq)("",!0)}const Pt=kt(Tt,[["render",zt]]);(0,o.aZ)({props:{niceDagReactive:Object},setup(e){return{getDomRef(){var t,n;return null==(n=null==(t=e.niceDagReactive)?void 0:t.use())?void 0:n.getRootContentElement()}}}});const Ot={};function At(e){const t=(0,_.qj)({id:e,observor:0,use:()=>_t.use(e)});return Ot[e]=t,t}function $t(e){return Ot[e]}function Wt(e){delete Ot[e]}function jt(e){Ot[e]?Ot[e].observor+=1:console.error(`Can't find observor with dag id:${e}`)}const Ht={create:At,get:$t,inc:jt,remove:Wt};function Gt(){return Math.random().toString(16).slice(2)}function qt(e){const{onMount:t,scrollPosition:n,initNodes:i,getNodeSize:s,...d}=e,a=(0,_.iH)(),r=(0,_.iH)(),l=Ht.create(Gt()),h={onChange:()=>{Ht.inc(l.id)}};return(0,o.bv)((()=>{const n=_t.init({id:l.id,container:a.value,getNodeSize:s,...d,minimapContainer:r.value},e.editable);n.withNodes(i).render(),t&&t(),n.addNiceDagChangeListener(h),Ht.inc(l.id)})),(0,o.Ah)((()=>{var e;null==(e=_t.use(l.id))||e.destory(),Ht.remove(l.id)})),{niceDagReactive:l,niceDagEl:a,minimapEl:r,reset:()=>{var e;null==(e=_t.use(l.id))||e.destory()}}}const Jt=150,Zt=60,Xt=30,Yt=e=>"start"===e.id||"end"===e.id||e.joint?{width:Xt,height:Xt}:{width:Jt,height:Zt};var Ft={name:"ReadOnlyView",props:{},components:{NiceDagNodes:Pt,NiceDagEdges:It,StartNode:Y,EndNode:F,SampleNode:ne,Joint:K,Edge:te},setup(){const e=(0,_.iH)(100),t=(0,_.iH)("LR"),n=[{value:"LR",label:"Left to Right"},{value:"RL",label:"Right to Left"},{value:"TB",label:"Top to Bottom"},{value:"BT",label:"Bottom to Top"}],{niceDagEl:i,minimapEl:s,niceDagReactive:d}=qt({initNodes:R,getNodeSize:Yt,minimapConfig:{viewBoxClassName:"readonly-sample-minimap-viewbox"}},!1);(0,o.bv)((()=>{const e=d.use();if(e){const t=i.value.getBoundingClientRect();e.center({width:t.width,height:400})}}));const a=()=>{d.use().setScale(e.value/100)},r=()=>{d.use().setDirection(t.value)};return{niceDagEl:i,minimapEl:s,niceDagReactive:d,scale:e,onScaleChange:a,direction:t,directions:n,onDirectionChange:r}}};const Ut=(0,T.Z)(Ft,[["render",S]]);var Kt=Ut;const Qt={className:"editable-sample"},en={className:"editable-sample-control"},tn={className:"editable-sample-control-action"},nn={className:"editable-sample-control-zoom"},on={className:"editable-sample-content"},sn={className:"editable-sample-content-nice-dag",ref:"niceDagEl"};function dn(e,t,n,i,s,d){const a=(0,o.up)("el-button"),r=(0,o.up)("el-row"),l=(0,o.up)("el-slider"),h=(0,o.up)("EditableStartNode"),c=(0,o.up)("EditableEndNode"),g=(0,o.up)("EditableJoint"),p=(0,o.up)("EditableNode"),u=(0,o.up)("NiceDagNodes"),m=(0,o.up)("EditableEdge"),v=(0,o.up)("NiceDagEdges");return(0,o.wg)(),(0,o.iD)("div",Qt,[(0,o._)("div",en,[(0,o._)("div",tn,[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Wm)(a,{onClick:i.prettify},{default:(0,o.w5)((()=>[(0,o.Uk)("Prettify")])),_:1},8,["onClick"]),(0,o.Wm)(a,{onClick:i.addNode},{default:(0,o.w5)((()=>[(0,o.Uk)("Add Node")])),_:1},8,["onClick"]),(0,o.Wm)(a,{onClick:i.addJointNode},{default:(0,o.w5)((()=>[(0,o.Uk)("Add Joint Node")])),_:1},8,["onClick"])])),_:1})]),(0,o._)("div",nn,[(0,o.Wm)(l,{modelValue:i.scale,"onUpdate:modelValue":t[0]||(t[0]=e=>i.scale=e),"show-input":"",onChange:i.onScaleChange},null,8,["modelValue","onChange"])])]),(0,o._)("div",on,[(0,o._)("div",sn,null,512),(0,o.Wm)(u,{niceDagReactive:i.niceDagReactive},{default:(0,o.w5)((e=>["start"===e.node.id?((0,o.wg)(),(0,o.j4)(h,{key:0,niceDagReactive:i.niceDagReactive,observor:i.niceDagReactive.observor,node:e.node},null,8,["niceDagReactive","observor","node"])):(0,o.kq)("",!0),"end"===e.node.id?((0,o.wg)(),(0,o.j4)(c,{key:1,niceDagReactive:i.niceDagReactive,observor:i.niceDagReactive.observor,node:e.node},null,8,["niceDagReactive","observor","node"])):(0,o.kq)("",!0),e.node.joint?((0,o.wg)(),(0,o.j4)(g,{key:2,niceDagReactive:i.niceDagReactive,observor:i.niceDagReactive.observor,node:e.node},null,8,["niceDagReactive","observor","node"])):(0,o.kq)("",!0),"end"===e.node.id||"start"===e.node.id||e.node.joint?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(p,{key:3,node:e.node,niceDagReactive:i.niceDagReactive,observor:i.niceDagReactive.observor},null,8,["node","niceDagReactive","observor"]))])),_:1},8,["niceDagReactive"]),(0,o.Wm)(v,{niceDagReactive:i.niceDagReactive},{default:(0,o.w5)((()=>[(0,o.Wm)(m)])),_:1},8,["niceDagReactive"])])])}const an={className:"editable-sample-node"};function rn(e,t,n,i,s,d){const a=(0,o.up)("EditableGroupControl"),r=(0,o.up)("EditableNodeControl"),l=(0,o.up)("EditableConnector");return(0,o.wg)(),(0,o.iD)("div",an,[i.showGroupCtrl()?((0,o.wg)(),(0,o.j4)(a,{key:0,node:n.node,niceDag:n.niceDagReactive.use()},null,8,["node","niceDag"])):(0,o.kq)("",!0),i.showGroupCtrl()?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(r,{key:1,node:n.node,niceDag:n.niceDagReactive.use()},null,8,["node","niceDag"])),(0,o.Wm)(l,{type:"in"}),(0,o.Wm)(l,{type:"out",node:n.node,niceDag:n.niceDagReactive.use()},null,8,["node","niceDag"])])}function ln(e,t,n,i,d,a){return(0,o.wg)(),(0,o.iD)("div",{class:(0,s.C_)(`editable-sample-${n.shape||"circle"}-connector-${n.type}`),onMousedown:t[0]||(t[0]=(...e)=>i.startEdgeDragging&&i.startEdgeDragging(...e))},null,34)}var hn={name:"EditableConnector",props:["node","niceDag","type","shape"],setup(e){return{startEdgeDragging(t){e.node&&e.niceDag.startEdgeDragging(e.node,t)}}}};const cn=(0,T.Z)(hn,[["render",ln]]);var gn=cn;const pn={className:"editable-sample-node-group-content"};function un(e,t,n,i,d,a){const r=(0,o.up)("MoveSvg"),l=(0,o.up)("SvgIcon"),h=(0,o.up)("CloseSvg"),c=(0,o.up)("ShrinkSvg"),g=(0,o.up)("MyButton");return(0,o.wg)(),(0,o.iD)("div",pn,[(0,o._)("div",null,[(0,o._)("div",{className:"editable-sample-node-group-content-bar",onMousedown:t[0]||(t[0]=(...e)=>i.startNodeDragging&&i.startNodeDragging(...e))},[(0,o._)("span",null,(0,s.zw)(n.node.data?.label||n.node.id),1),n.niceDag.editing?((0,o.wg)(),(0,o.j4)(l,{key:0},{default:(0,o.w5)((()=>[(0,o.Wm)(r)])),_:1})):(0,o.kq)("",!0)],32),(0,o._)("div",{className:"editable-sample-node-group-content-delete-button",onMousedown:t[1]||(t[1]=(...e)=>i.removeNode&&i.removeNode(...e))},[(0,o.Wm)(h)],32),(0,o.Wm)(g,{onClick:i.shrinkNode},{default:(0,o.w5)((()=>[(0,o.Wm)(c)])),_:1},8,["onClick"])])])}const mn={class:"nice-dag-vue-sample-icon"};function vn(e,t,n,i,s,d){return(0,o.wg)(),(0,o.iD)("span",mn,[(0,o.WI)(e.$slots,"default",{},void 0,!0)])}var fn={name:"SvgIcon"};const yn=(0,T.Z)(fn,[["render",vn],["__scopeId","data-v-442a48a3"]]);var En=yn;const wn={viewBox:"64 64 896 896",focusable:"false","data-icon":"drag",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},bn=(0,o._)("path",{d:"M909.3 506.3L781.7 405.6a7.23 7.23 0 00-11.7 5.7V476H548V254h64.8c6 0 9.4-7 5.7-11.7L517.7 114.7a7.14 7.14 0 00-11.3 0L405.6 242.3a7.23 7.23 0 005.7 11.7H476v222H254v-64.8c0-6-7-9.4-11.7-5.7L114.7 506.3a7.14 7.14 0 000 11.3l127.5 100.8c4.7 3.7 11.7.4 11.7-5.7V548h222v222h-64.8c-6 0-9.4 7-5.7 11.7l100.8 127.5c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7.4-11.7-5.7-11.7H548V548h222v64.8c0 6 7 9.4 11.7 5.7l127.5-100.8a7.3 7.3 0 00.1-11.4z"},null,-1),Nn=[bn];function Dn(e,t,n,i,s,d){return(0,o.wg)(),(0,o.iD)("svg",wn,Nn)}var Cn={name:"MoveSvg"};const xn=(0,T.Z)(Cn,[["render",Dn]]);var Sn=xn;const Rn={viewBox:"64 64 896 896",focusable:"false","data-icon":"close-circle",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},_n=(0,o._)("path",{d:"M685.4 354.8c0-4.4-3.6-8-8-8l-66 .3L512 465.6l-99.3-118.4-66.1-.3c-4.4 0-8 3.5-8 8 0 1.9.7 3.7 1.9 5.2l130.1 155L340.5 670a8.32 8.32 0 00-1.9 5.2c0 4.4 3.6 8 8 8l66.1-.3L512 564.4l99.3 118.4 66 .3c4.4 0 8-3.5 8-8 0-1.9-.7-3.7-1.9-5.2L553.5 515l130.1-155c1.2-1.4 1.8-3.3 1.8-5.2z"},null,-1),Ln=(0,o._)("path",{d:"M512 65C264.6 65 64 265.6 64 513s200.6 448 448 448 448-200.6 448-448S759.4 65 512 65zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"},null,-1),kn=[_n,Ln];function Mn(e,t,n,i,s,d){return(0,o.wg)(),(0,o.iD)("svg",Rn,kn)}var Bn={name:"CloseSvg"};const In=(0,T.Z)(Bn,[["render",Mn]]);var Tn=In,Vn={name:"EditableGroupControl",components:{SvgIcon:En,MoveSvg:Sn,CloseSvg:Tn,MyButton:X,ShrinkSvg:z},props:["node","niceDag","type","shape"],setup(e){return{startNodeDragging(t){e.niceDag.startNodeDragging(e.node,t)},shrinkNode(){e.node.shrink()},removeNode(){e.node.remove()}}}};const zn=(0,T.Z)(Vn,[["render",un]]);var Pn=zn;const On={className:"editable-sample-node-content"};function An(e,t,n,i,d,a){const r=(0,o.up)("MoveSvg"),l=(0,o.up)("SvgIcon"),h=(0,o.up)("CloseSvg"),c=(0,o.up)("PlusSvg"),g=(0,o.up)("MyButton");return(0,o.wg)(),(0,o.iD)("div",On,[(0,o._)("div",{className:"editable-sample-node-content-bar",onMousedown:t[0]||(t[0]=(...e)=>i.startNodeDragging&&i.startNodeDragging(...e))},[(0,o._)("span",null,(0,s.zw)(n.node.data?.label||n.node.id),1),n.niceDag.editing?((0,o.wg)(),(0,o.j4)(l,{key:0},{default:(0,o.w5)((()=>[(0,o.Wm)(r)])),_:1})):(0,o.kq)("",!0)],32),(0,o._)("div",{className:"editable-sample-node-content-delete-button",role:"button",onMousedown:t[1]||(t[1]=(...e)=>i.removeNode&&i.removeNode(...e))},[(0,o.Wm)(l,null,{default:(0,o.w5)((()=>[(0,o.Wm)(h)])),_:1})],32),i.isExpandButtonVisible()?((0,o.wg)(),(0,o.j4)(g,{key:0,onClick:i.expandNode},{default:(0,o.w5)((()=>[(0,o.Wm)(c)])),_:1},8,["onClick"])):(0,o.kq)("",!0)])}var $n={name:"EditableNodeControl",components:{SvgIcon:En,MoveSvg:Sn,CloseSvg:Tn,PlusSvg:G,MyButton:X},props:["node","niceDag"],setup(e){return{startNodeDragging(t){e.niceDag.startNodeDragging(e.node,t)},removeNode(){e.node.remove()},expandNode(){e.node.expand()},isExpandButtonVisible(){return e.node.children?.length>0||e.node.data?.lazyLoadingChildren}}}};const Wn=(0,T.Z)($n,[["render",An]]);var jn=Wn,Hn={name:"EditableNode",props:["node","niceDagReactive"],components:{EditableConnector:gn,EditableGroupControl:Pn,EditableNodeControl:jn},setup(e){return{showGroupCtrl(){return e.node.children?.length>0&&!e.node.collapse}}}};const Gn=(0,T.Z)(Hn,[["render",rn]]);var qn=Gn;const Jn={className:"editable-sample-edge-label"};function Zn(e,t,n,i,s,d){return(0,o.wg)(),(0,o.iD)("div",Jn)}var Xn={setup(){}};const Yn=(0,T.Z)(Xn,[["render",Zn]]);var Fn=Yn;const Un={className:"editable-sample-start-node"};function Kn(e,t,n,i,s,d){const a=(0,o.up)("EditableConnector");return(0,o.wg)(),(0,o.iD)("div",Un,[(0,o._)("div",{className:"editable-sample-start-node-move-hand",onMousedown:t[0]||(t[0]=(...e)=>i.startNodeDragging&&i.startNodeDragging(...e))},null,32),(0,o.Wm)(a,{type:"out",shape:"square",node:n.node,niceDag:i.niceDag},null,8,["node","niceDag"])])}var Qn={components:{EditableConnector:gn},props:["niceDagReactive","node"],setup(e){return{niceDag:e.niceDagReactive.use(),startNodeDragging(t){e.niceDag.startNodeDragging(e.node,t)}}}};const ei=(0,T.Z)(Qn,[["render",Kn]]);var ti=ei;function ni(e,t,n,i,s,d){const a=(0,o.up)("EditableConnector");return(0,o.wg)(),(0,o.iD)("div",{className:"editable-sample-end-node",onMousedown:t[0]||(t[0]=(...e)=>i.startNodeDragging&&i.startNodeDragging(...e))},[(0,o.Wm)(a,{type:"in",shape:"square"})],32)}var ii={components:{EditableConnector:gn},props:["niceDag","node"],setup(e){return{startNodeDragging(t){e.niceDag.startNodeDragging(e.node,t)}}}};const oi=(0,T.Z)(ii,[["render",ni]]);var si=oi;const di={className:"editable-sample-joint-node"};function ai(e,t,n,i,s,d){const a=(0,o.up)("MoveSvg"),r=(0,o.up)("SvgIcon"),l=(0,o.up)("CloseSvg"),h=(0,o.up)("EditableConnector");return(0,o.wg)(),(0,o.iD)("div",di,[(0,o._)("div",{className:"editable-sample-joint-node-move",onMousedown:t[0]||(t[0]=(...e)=>i.startNodeDragging&&i.startNodeDragging(...e))},[i.niceDag.editing?((0,o.wg)(),(0,o.j4)(r,{key:0},{default:(0,o.w5)((()=>[(0,o.Wm)(a)])),_:1})):(0,o.kq)("",!0)],32),(0,o._)("div",{className:"editable-sample-joint-node-remove-button",role:"button",onMousedown:t[1]||(t[1]=(...e)=>i.removeNode&&i.removeNode(...e)),"aria-label":"Remove joint node"},[i.niceDag.editing?((0,o.wg)(),(0,o.j4)(r,{key:0},{default:(0,o.w5)((()=>[(0,o.Wm)(l)])),_:1})):(0,o.kq)("",!0)],32),(0,o.Wm)(h,{type:"in",shape:"square"}),(0,o.Wm)(h,{type:"out",node:n.node,niceDag:i.niceDag,shape:"square"},null,8,["node","niceDag"])])}var ri={name:"EditableJoint",props:["node","niceDagReactive"],components:{SvgIcon:En,MoveSvg:Sn,CloseSvg:Tn,EditableConnector:gn},setup(e){return{startNodeDragging(t){e.node&&e.niceDagReactive.use().startNodeDragging(e.node,t)},removeNode(){e.node.remove()},niceDag:e.niceDagReactive.use()}}};const li=(0,T.Z)(ri,[["render",ai]]);var hi=li;const ci=150,gi=60,pi=30,ui=e=>"start"===e.id||"end"===e.id||e.joint?{width:pi,height:pi}:{width:ci,height:gi};var mi={name:"EditableView",props:{},components:{NiceDagNodes:Pt,NiceDagEdges:It,EditableStartNode:ti,EditableNode:qn,EditableJoint:hi,EditableEdge:Fn,EditableEndNode:si},setup(){let e=0;const t=(0,_.iH)(100),{niceDagEl:n,niceDagReactive:i}=qt({initNodes:R,getNodeSize:ui,jointEdgeConnectorType:"CENTER_OF_BORDER",editable:!0}),s=()=>{i.use().setScale(t.value/100)},d=()=>{i.use().prettify()},a=()=>{i.use().addNode({id:`new-node-${e}`},{x:40,y:40}),e+=1},r=()=>{i.use().addJointNode({id:`new-node-${e}`},{x:40,y:40}),e+=1};return(0,o.bv)((()=>{const e=i.use();if(e){const t=n.value.getBoundingClientRect();e.center({width:t.width,height:400}).startEditing()}})),{nodeCtnRef:e,niceDagEl:n,niceDagReactive:i,scale:t,onScaleChange:s,prettify:d,addNode:a,addJointNode:r}}};const vi=(0,T.Z)(mi,[["render",dn]]);var fi=vi;function yi(e,t,n,i,s,d){const a=(0,o.up)("prism-editor");return(0,o.wg)(),(0,o.j4)(a,{class:"vue-code-editor",modelValue:i.content,"onUpdate:modelValue":t[0]||(t[0]=e=>i.content=e),highlight:d.highlighter,"line-numbers":""},null,8,["modelValue","highlight"])}var Ei='<template>\n  <div className="readonly-sample">\n    <div className="readonly-sample-control">\n      <div className="readonly-sample-control-direction">\n        <el-select\n          v-model="direction"\n          placeholder="Select"\n          @change="onDirectionChange"\n        >\n          <el-option\n            v-for="d in directions"\n            :key="d.value"\n            :label="d.label"\n            :value="d.value"\n          >\n          </el-option>\n        </el-select>\n      </div>\n      <div className="readonly-sample-control-zoom">\n        <el-slider v-model="scale" show-input @change="onScaleChange">\n        </el-slider>\n      </div>\n    </div>\n    <div className="readonly-sample-content">\n      <div className="readonly-sample-content-nice-dag" ref="niceDagEl" />\n      <NiceDagNodes v-slot="slotProps" :niceDagReactive="niceDagReactive">\n        <StartNode v-if="slotProps.node.id === \'start\'" />\n        <EndNode v-if="slotProps.node.id === \'end\'" />\n        <Joint v-if="slotProps.node.joint" />\n        <SampleNode\n          :node="slotProps.node"\n          :niceDagReactive="niceDagReactive"\n          v-if="\n            slotProps.node.id !== \'end\' &&\n            slotProps.node.id !== \'start\' &&\n            !slotProps.node.joint\n          "\n          :observor="niceDagReactive.observor"\n        />\n      </NiceDagNodes>\n      <NiceDagEdges :niceDagReactive="niceDagReactive">\n        <Edge />\n      </NiceDagEdges>\n    </div>\n    <div className="readonly-sample-content-minimap-row">\n      <div className="readonly-sample-content-minimap">\n        <div className="readonly-sample-content-minimap-body" ref="minimapEl" />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { HierarchicalModel } from "../data/ReadOnlyViewData";\nimport { onMounted, ref } from "vue";\nimport { StartNode, EndNode, SampleNode, Joint, Edge } from "./ReadOnlyNodes";\nimport { NiceDagNodes, NiceDagEdges, useNiceDag } from "@ebay/nice-dag-vue3";\nimport "./ReadOnlyView.less";\n\nconst NODE_WIDTH = 150;\nconst NODE_HEIGHT = 60;\nconst CIRCLE_W_H = 30;\n\nconst getNodeSize = (node) => {\n  if (node.id === "start" || node.id === "end" || node.joint) {\n    return {\n      width: CIRCLE_W_H,\n      height: CIRCLE_W_H,\n    };\n  }\n  return {\n    width: NODE_WIDTH,\n    height: NODE_HEIGHT,\n  };\n};\n\nexport default {\n  name: "ReadOnlyView",\n  props: {\n    // initNodes: HierarchicalModel,\n  },\n  components: {\n    NiceDagNodes,\n    NiceDagEdges,\n    StartNode,\n    EndNode,\n    SampleNode,\n    Joint,\n    Edge,\n  },\n  setup() {\n    const scale = ref(100);\n    const direction = ref("LR");\n    const directions = [\n      {\n        value: "LR",\n        label: "Left to Right",\n      },\n      {\n        value: "RL",\n        label: "Right to Left",\n      },\n      {\n        value: "TB",\n        label: "Top to Bottom",\n      },\n      {\n        value: "BT",\n        label: "Bottom to Top",\n      },\n    ];\n    const { niceDagEl, minimapEl, niceDagReactive } = useNiceDag(\n      {\n        initNodes: HierarchicalModel,\n        getNodeSize,\n        minimapConfig: {\n          viewBoxClassName: "readonly-sample-minimap-viewbox",\n        },\n      },\n      false\n    );\n    onMounted(() => {\n      const niceDag = niceDagReactive.use();\n      if (niceDag) {\n        const bounds = niceDagEl.value.getBoundingClientRect();\n        niceDag.center({\n          width: bounds.width,\n          height: 400,\n        });\n      }\n    });\n    const onScaleChange = () => {\n      niceDagReactive.use().setScale(scale.value / 100);\n    };\n    const onDirectionChange = () => {\n      niceDagReactive.use().setDirection(direction.value);\n    };\n    return {\n      niceDagEl,\n      minimapEl,\n      niceDagReactive,\n      scale,\n      onScaleChange,\n      direction,\n      directions,\n      onDirectionChange,\n    };\n  },\n};\n<\/script>\n',wi="import ShrinkSvg from '../../assets/svgs/shrink.vue';\nimport PlusSvg from '../../assets/svgs/plus.vue';\nimport MyButton from '../../components/MyButton.vue';\n\nexport const StartNode = <div className=\"readonly-sample-start-node\" />;\n\nexport const EndNode = <div className=\"readonly-sample-end-node\" />;\n\nexport const Connector = {\n  props: ['type'],\n  emits: ['update:type'],\n  render() {\n    return (\n      <div className={`readonly-sample-connector-${this.type}`} />\n    );\n  }\n};\n\nexport const Joint = <div className=\"readonly-sample-joint-node\" />;\n\nconst GroupControl = {\n  props: ['node', 'niceDag'],\n  emits: ['update:node', 'update:niceDag'],\n  components: [ShrinkSvg, MyButton],\n  render() {\n    return (<div className=\"readonly-sample-node-group-content\">\n      <div>\n        {this.node.data?.label || this.node.id}\n        <MyButton onClick={() => this.node.shrink()}>\n          <ShrinkSvg />\n        </MyButton>\n      </div>\n    </div>);\n  }\n}\n\nconst NodeControl = {\n  props: ['node', 'niceDag'],\n  emits: ['update:node', 'update:niceDag'],\n  render() {\n    return (\n      <div className=\"readonly-sample-node-content\">\n        <span>{this.node.data?.label || this.node.id}</span>\n        {(this.node.children?.length > 0 || this.node.data?.lazyLoadingChildren) && (\n          <MyButton onClick={() => {\n            if (this.node.data?.lazyLoadingChildren) {\n              this.node.withChildren(new Promise((resolve) => {\n                resolve([{\n                  id: 'step-1',\n                }, {\n                  id: 'step-2',\n                  dependencies: ['step-1']\n                }])\n              }));\n            } else {\n              this.node.expand();\n            }\n          }}>\n            <PlusSvg />\n          </MyButton>\n        )}\n      </div>\n    );\n  }\n};\n\nexport const Edge = {\n  render() {\n    return <div className=\"readonly-sample-edge-label\">to</div>;\n  }\n}\n\nexport const SampleNode = {\n  props: ['node', 'niceDagReactive'],\n  emits: ['update:node', 'update:niceDagReactive'],\n  render() {\n    return (\n      <div className=\"readonly-sample-node\">\n        {this.node.children?.length > 0 && !this.node.collapse ? (\n          <GroupControl node={this.node} niceDag={this.niceDagReactive.use()} />\n        ) : (\n          <NodeControl node={this.node} niceDag={this.niceDagReactive.use()} />\n        )}\n        <Connector type=\"in\" />\n        <Connector type=\"out\" />\n      </div>\n    );\n  }\n};",bi='@conector-size: 16px;\n\n.readonly-sample {\n  border: 1px solid #eaeaea;\n  padding: 4px 4px;\n  &-control {\n    margin-bottom: 10px;\n    min-height: 38px;\n  }\n  &-control-direction {\n    float: left;\n  }\n  &-control-zoom {\n    float: left;\n    width: 400px;\n    margin-left: 30px;\n   }\n  &-minimap {\n    width: 250px;\n    height: 200px;\n  }\n  &-edge-label {\n    text-align: center;\n    margin-top: -20px;\n  }\n  &-start-node,\n  &-end-node,\n  &-joint-node {\n    border: 1px solid black;\n    border-radius: 50%;\n    width: 30px;\n    height: 30px;\n    background: white;\n  }\n\n  &-joint-node {\n    font-size: 18px;\n    display: flex;\n    align-content: center;\n    justify-content: center;\n    align-items: center;\n  }\n\n  &-end-node::before {\n    content: "";\n    position: absolute;\n    border: 1px solid black;\n    border-radius: 50%;\n    background: black;\n    top: 5px;\n    left: 5px;\n    width: 20px;\n    height: 20px;\n  }\n\n  &-connector {\n    &-in,\n    &-out {\n      width: @conector-size;\n      height: @conector-size;\n      border: 1px solid black;\n      border-radius: 50%;\n      position: absolute;\n      margin: auto;\n      top: 0;\n      bottom: 0;\n      background: white;\n    }\n\n    &-in {\n      left: @conector-size / -2;\n    }\n    &-out {\n      right: @conector-size / -2;\n    }\n  }\n\n  &-node {\n    width: 100%;\n    height: 100%;\n    &-group-content,\n    &-content {\n      position: relative;\n      width: 100%;\n      height: 100%;\n      border: 1px solid #999999;\n      border-radius: 10px;\n      display: flex;\n      flex-direction: column;\n      box-sizing: border-box;\n    }\n    &-group-content {\n      padding: 4px 20px;\n      > div {\n        height: 30px;\n\n        a {\n          margin-left: 6px;\n          font-size: 16px;\n        }\n      }\n    }\n    &-content {\n      align-items: center;\n      justify-content: center;\n    }\n  }\n\n  &-content {\n    height: 400px;\n    position: relative;\n    &-nice-dag {\n      height: 100%;\n    }\n    &-minimap-row {\n      height: 130px;\n      position: relative;\n    }\n    &-minimap {\n      position: absolute;\n      top: 0;\n      right: 0;\n      width: 300px;\n      height: 120px;\n      bottom: 20px; //scroll bar\n      border: 1px solid gray;\n      padding: 2px 2px;\n      background-color: #efefef;\n\n      &-body {\n        width: 100%;\n        height: 100%;\n      }\n    }\n  }\n  &-minimap-viewbox {\n    border: 1px solid orange !important;\n  }\n}',Ni="export const HierarchicalModel = [\n  {\n    id: 'start',\n  },\n  {\n    id: 'git-clone',\n    dependencies: ['start'],\n    data: {\n      label: 'Git Clone',\n    },\n  },\n  {\n    id: 'mvn',\n    dependencies: ['git-clone'],\n    data: {\n      label: 'Mvn Install',\n    },\n  },\n  {\n    id: 'security-check',\n    dependencies: ['git-clone'],\n    data: {\n      label: 'Security Check',\n    },\n  },\n  {\n    id: 'build',\n    dependencies: ['mvn', 'security-check'],\n    data: {\n      label: 'Build',\n    },\n  },\n  {\n    id: 'deploy-fp-1',\n    dependencies: ['build'],\n    data: {\n      label: 'Deploy Feature-1',\n    },\n    children: [\n      {\n        id: 'provision-fp-1',\n        data: {\n          label: 'Provision Pool',\n        },\n      },\n      {\n        id: 'deployment-fp-1',\n        dependencies: ['provision-fp-1'],\n        data: {\n          label: 'Deployment',\n        },\n      },\n    ],\n  },\n  {\n    id: 'deploy-fp-2',\n    dependencies: ['build'],\n    data: {\n      label: 'Deploy Feature-2',\n    },\n    children: [\n      {\n        id: 'provision-fp-2',\n        data: {\n          label: 'Provision Pool',\n        },\n      },\n      {\n        id: 'deployment-fp-2',\n        dependencies: ['provision-fp-2'],\n        data: {\n          label: 'Deployment',\n        },\n      },\n    ],\n  },\n  {\n    id: 'smoke-test',\n    dependencies: ['deploy-fp-1', 'deploy-fp-2'],\n  },\n  {\n    id: 'integration-test',\n    dependencies: ['smoke-test'],\n  },\n  {\n    id: 'prod-deployment',\n    dependencies: ['integration-test'],\n  },\n  {\n    id: 'end',\n    dependencies: ['prod-deployment'],\n  },\n];\n\nexport const FlattenModel = [\n  {\n    id: 'start',\n  },\n  {\n    id: 'git-clone',\n    dependencies: ['start'],\n    data: {\n      label: 'Git Clone',\n    },\n  },\n  {\n    id: 'mvn',\n    dependencies: ['git-clone'],\n    data: {\n      label: 'Mvn Install',\n    },\n  },\n  {\n    id: 'security-check',\n    dependencies: ['git-clone'],\n    data: {\n      label: 'Security Check',\n    },\n  },\n  {\n    id: 'build',\n    dependencies: ['mvn', 'security-check'],\n    data: {\n      label: 'Build',\n    },\n  },\n  {\n    id: 'deploy-fp-1',\n    dependencies: ['build'],\n    data: {\n      label: 'Deploy Feature-1',\n    },\n  },\n  {\n    id: 'provision-fp-1',\n    data: {\n      label: 'Provision Pool',\n    },\n    parentId: 'deploy-fp-1'\n  },\n  {\n    id: 'deployment-fp-1',\n    dependencies: ['provision-fp-1'],\n    data: {\n      label: 'Deployment',\n    },\n    parentId: 'deploy-fp-1'\n  },\n  {\n    id: 'deploy-fp-2',\n    dependencies: ['build'],\n    data: {\n      label: 'Deploy Feature-2',\n    },\n  },\n  {\n    id: 'provision-fp-2',\n    data: {\n      label: 'Provision Pool',\n    },\n    parentId: 'deploy-fp-2'\n  },\n  {\n    id: 'deployment-fp-2',\n    dependencies: ['provision-fp-2'],\n    data: {\n      label: 'Deployment',\n    },\n    parentId: 'deploy-fp-2'\n  },\n  {\n    id: 'deployment-fp-3',\n    dependencies: ['deployment-fp-2'],\n    data: {\n      label: 'Last Step',\n    },\n    parentId: 'deploy-fp-2'\n\n  },\n  {\n    id: 'deployment-fp-2-2',\n    data: {\n      label: 'Deployment-child',\n    },\n    parentId: 'deployment-fp-2'\n  },\n  {\n    id: 'deployment-fp-2-2-child',\n    data: {\n      label: 'Deployment-child-child',\n    },\n    parentId: 'deployment-fp-2-2'\n  },\n  {\n    id: 'smoke-test',\n    dependencies: ['deploy-fp-1', 'deploy-fp-2'],\n  },\n  {\n    id: 'integration-test',\n    dependencies: ['smoke-test'],\n  },\n  {\n    id: 'prod-deployment',\n    dependencies: ['integration-test'],\n  },\n  {\n    id: 'end',\n    dependencies: ['prod-deployment'],\n  },\n];",Di='<template>\n  <div className="editable-sample">\n    <div className="editable-sample-control">\n      <div className="editable-sample-control-action">\n        <el-row>\n          <el-button @click="prettify">Prettify</el-button>\n          <el-button @click="addNode">Add Node</el-button>\n          <el-button @click="addJointNode">Add Joint Node</el-button>\n        </el-row>\n      </div>\n      <div className="editable-sample-control-zoom">\n        <el-slider v-model="scale" show-input @change="onScaleChange">\n        </el-slider>\n      </div>\n    </div>\n    <div className="editable-sample-content">\n      <div className="editable-sample-content-nice-dag" ref="niceDagEl" />\n      <NiceDagNodes v-slot="slotProps" :niceDagReactive="niceDagReactive">\n        <EditableStartNode\n          v-if="slotProps.node.id === \'start\'"\n          :niceDagReactive="niceDagReactive"\n          :observor="niceDagReactive.observor"\n          :node="slotProps.node"\n        />\n        <EditableEndNode\n          v-if="slotProps.node.id === \'end\'"\n          :niceDagReactive="niceDagReactive"\n          :observor="niceDagReactive.observor"\n          :node="slotProps.node"\n        />\n        <EditableJoint\n          v-if="slotProps.node.joint"\n          :niceDagReactive="niceDagReactive"\n          :observor="niceDagReactive.observor"\n          :node="slotProps.node"\n        />\n        <EditableNode\n          :node="slotProps.node"\n          :niceDagReactive="niceDagReactive"\n          :observor="niceDagReactive.observor"\n          v-if="\n            slotProps.node.id !== \'end\' &&\n            slotProps.node.id !== \'start\' &&\n            !slotProps.node.joint\n          "\n        />\n      </NiceDagNodes>\n      <NiceDagEdges :niceDagReactive="niceDagReactive">\n        <EditableEdge />\n      </NiceDagEdges>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { HierarchicalModel } from "../data/ReadOnlyViewData";\nimport { ref, onMounted } from "vue";\nimport { NiceDagNodes, NiceDagEdges, useNiceDag } from "@ebay/nice-dag-vue3";\nimport EditableNode from "./EditableNode";\nimport EditableEdge from "./EditableEdge";\nimport EditableStartNode from "./EditableStartNode";\nimport EditableEndNode from "./EditableEndNode";\nimport EditableJoint from "./EditableJoint";\nimport "./EditableView.less";\n\nconst NODE_WIDTH = 150;\nconst NODE_HEIGHT = 60;\nconst CIRCLE_W_H = 30;\n\nconst getNodeSize = (node) => {\n  if (node.id === "start" || node.id === "end" || node.joint) {\n    return {\n      width: CIRCLE_W_H,\n      height: CIRCLE_W_H,\n    };\n  }\n  return {\n    width: NODE_WIDTH,\n    height: NODE_HEIGHT,\n  };\n};\n\nexport default {\n  name: "EditableView",\n  props: {\n    // initNodes: HierarchicalModel,\n  },\n  components: {\n    NiceDagNodes,\n    NiceDagEdges,\n    EditableStartNode,\n    EditableNode,\n    EditableJoint,\n    EditableEdge,\n    EditableEndNode,\n  },\n  setup() {\n    let nodeCtnRef = 0;\n    const scale = ref(100);\n    const { niceDagEl, niceDagReactive } = useNiceDag({\n      initNodes: HierarchicalModel,\n      getNodeSize,\n      jointEdgeConnectorType: "CENTER_OF_BORDER",\n      editable: true,\n    });\n    const onScaleChange = () => {\n      niceDagReactive.use().setScale(scale.value / 100);\n    };\n    const prettify = () => {\n      niceDagReactive.use().prettify();\n    };\n    const addNode = () => {\n      niceDagReactive.use().addNode(\n        {\n          id: `new-node-${nodeCtnRef}`,\n        },\n        {\n          x: 40,\n          y: 40,\n        }\n      );\n      nodeCtnRef = nodeCtnRef + 1;\n    };\n    const addJointNode = () => {\n      niceDagReactive.use().addJointNode(\n        {\n          id: `new-node-${nodeCtnRef}`,\n        },\n        {\n          x: 40,\n          y: 40,\n        }\n      );\n      nodeCtnRef = nodeCtnRef + 1;\n    };\n    onMounted(() => {\n      const niceDag = niceDagReactive.use();\n      if (niceDag) {\n        const bounds = niceDagEl.value.getBoundingClientRect();\n        niceDag\n          .center({\n            width: bounds.width,\n            height: 400,\n          })\n          .startEditing();\n      }\n    });\n\n    return {\n      nodeCtnRef,\n      niceDagEl,\n      niceDagReactive,\n      scale,\n      onScaleChange,\n      prettify,\n      addNode,\n      addJointNode,\n    };\n  },\n};\n<\/script>\n',Ci='@conector-size: 16px;\n\n.editable-sample {\n  &-control {\n    margin-bottom: 10px;\n    min-height: 38px;\n  }\n  &-control-action {\n    float: left;\n  }\n  &-control-zoom {\n   float: left;\n   width: 320px;\n   margin-left: 30px;\n  }\n  .ant-slider {\n    min-width: 180px;\n  }\n  &-edge-label {\n    height: 100%;\n    width: calc(~"100% - " @conector-size);\n    margin: auto;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    &:hover {\n      background: rgba(0, 0, 255, 0.2);\n    }\n\n    div {\n      width: 16px;\n      height: 16px;\n    }\n  }\n  &-start-node {\n    &-move-hand {\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n    }\n  }\n  &-start-node,\n  &-end-node,\n  &-joint-node {\n    border: 1px solid black;\n    border-radius: 50%;\n    width: 30px;\n    height: 30px;\n    background: white;\n  }\n\n  &-joint-node {\n    &-move {\n      text-align: center;\n      padding-top: 2px;\n      z-index: 1;\n\n      .nice-dag-vue-sample-icon {\n        margin-left: 0;\n        margin-top: 4px;\n        font-size: 14px;\n      }\n    }\n\n    &-remove-button {\n      position: absolute;\n      top: -10px;\n      right: -2px;\n      background-color: white;\n      // border: 1px solid black;\n      height: 14px;\n      font-size: 12px;\n\n      .anticon-close {\n        transform: translateY(-2px);\n      }\n    }\n  }\n\n  &-end-node::before {\n    content: "";\n    position: absolute;\n    border: 1px solid black;\n    border-radius: 50%;\n    background: darkgray;\n    top: 5px;\n    left: 5px;\n    width: 20px;\n    height: 20px;\n  }\n\n  &-square-connector,\n  &-circle-connector {\n    &-in,\n    &-out {\n      width: @conector-size;\n      height: @conector-size;\n      border: 1px solid black;\n      border-radius: 50%;\n      position: absolute;\n      margin: auto;\n      top: 0;\n      bottom: 0;\n      background: white;\n    }\n\n    &-in {\n      left: @conector-size / -2;\n    }\n    &-out {\n      right: @conector-size / -2;\n      cursor: pointer;\n      z-index: 1;\n    }\n  }\n\n  &-square-connector {\n    &-in,\n    &-out {\n      border: 1px solid black;\n      border-radius: 0;\n    }\n  }\n\n  &-node {\n    width: 100%;\n    height: 100%;\n    background: white;\n\n    &-group-content,\n    &-content {\n      position: relative;\n      width: 100%;\n      height: 100%;\n      border: 1px solid #8799c1;\n      border-radius: 10px;\n      display: flex;\n      flex-direction: column;\n\n      &-delete-button {\n        position: absolute;\n        right: -10px;\n        top: -11px;\n        background: white;\n        font-size: 18px;\n        height: 20px;\n      }\n\n      &-bar {\n        cursor: pointer;\n        z-index: 2;\n        span:nth-child(2) {\n          margin-left: 4px;\n          font-size: 16px;\n        }\n      }\n    }\n    &-group-content {\n      padding: 4px 20px;\n      > div {\n        height: 30px;\n\n        a {\n          margin-left: 6px;\n          font-size: 16px;\n        }\n      }\n      &-bar {\n        cursor: pointer;\n        display: inline-block;\n        span:nth-child(2) {\n          margin-left: 4px;\n          font-size: 16px;\n        }\n      }\n    }\n    &-content {\n      align-items: center;\n      justify-content: center;\n    }\n  }\n\n  &-content-nice-dag {\n    height: 400px;\n    border: 1px solid #efefef;\n  }\n}\n',xi='<template>\n  <div className="editable-sample-node">\n    <EditableGroupControl\n      v-if="showGroupCtrl()"\n      :node="node"\n      :niceDag="niceDagReactive.use()"\n    />\n    <EditableNodeControl\n      v-if="!showGroupCtrl()"\n      :node="node"\n      :niceDag="niceDagReactive.use()"\n    />\n    <EditableConnector type="in" />\n    <EditableConnector type="out" :node="node" :niceDag="niceDagReactive.use()" />\n  </div>\n</template>\n\n<script>\nimport EditableConnector from "./EditableConnector";\nimport EditableGroupControl from "./EditableGroupControl";\nimport EditableNodeControl from "./EditableNodeControl";\n\nexport default {\n  name: "EditableNode",\n  props: ["node", "niceDagReactive"],\n  components: {\n    EditableConnector,\n    EditableGroupControl,\n    EditableNodeControl,\n  },\n  setup(props) {\n    return {\n      showGroupCtrl() {\n        return props.node.children?.length > 0 && !props.node.collapse;\n      },\n    };\n  },\n};\n<\/script>\n',Si='<template>\n  <div className="editable-sample-joint-node">\n    <div\n      className="editable-sample-joint-node-move"\n      @mousedown="startNodeDragging"\n    >\n      <SvgIcon v-if="niceDag.editing"><MoveSvg /></SvgIcon>\n    </div>\n    <div\n      className="editable-sample-joint-node-remove-button"\n      role="button"\n      @mousedown="removeNode"\n      aria-label="Remove joint node"\n    >\n      <SvgIcon v-if="niceDag.editing"><CloseSvg /></SvgIcon>\n    </div>\n    <EditableConnector type="in" shape="square" />\n    <EditableConnector\n      type="out"\n      :node="node"\n      :niceDag="niceDag"\n      shape="square"\n    />\n  </div>\n</template>\n\n<script>\nimport SvgIcon from "../../components/SvgIcon.vue";\nimport MoveSvg from "../../assets/svgs/move.vue";\nimport CloseSvg from "../../assets/svgs/close.vue";\nimport EditableConnector from "./EditableConnector";\n\nexport default {\n  name: "EditableJoint",\n  props: ["node", "niceDagReactive"],\n  components: {\n    SvgIcon,\n    MoveSvg,\n    CloseSvg,\n    EditableConnector,\n  },\n  setup(props) {\n    return {\n      startNodeDragging(e) {\n        if (props.node) {\n          props.niceDagReactive.use().startNodeDragging(props.node, e);\n        }\n      },\n      removeNode() {\n        props.node.remove();\n      },\n      niceDag: props.niceDagReactive.use(),\n    };\n  },\n};\n<\/script>\n',Ri='<template>\n  <div\n    :class="`editable-sample-${shape || \'circle\'}-connector-${type}`"\n    @mousedown="startEdgeDragging"\n  />\n</template>\n\n<script>\nexport default {\n  name: "EditableConnector",\n  props: ["node", "niceDag", "type", "shape"],\n  setup(props) {\n    return {\n      startEdgeDragging(e) {\n        if (props.node) {\n          props.niceDag.startEdgeDragging(props.node, e);\n        }\n      },\n    };\n  },\n};\n<\/script>\n',_i='<template>\n  <div className="editable-sample-start-node">\n    <div\n      className="editable-sample-start-node-move-hand"\n      @mousedown="startNodeDragging"\n    />\n    <EditableConnector\n      type="out"\n      shape="square"\n      :node="node"\n      :niceDag="niceDag"\n    />\n  </div>\n</template>\n\n<script>\nimport EditableConnector from "./EditableConnector";\nexport default {\n  components: { EditableConnector },\n  props: ["niceDagReactive", "node"],\n  setup(props) {\n    return {\n      niceDag: props.niceDagReactive.use(),\n      startNodeDragging(e) {\n        props.niceDag.startNodeDragging(props.node, e);\n      },\n    };\n  },\n};\n<\/script>\n',Li='<template>\n  <div className="editable-sample-end-node" @mousedown="startNodeDragging">\n    <EditableConnector type="in" shape="square" />\n  </div>\n</template>\n\n<script>\nimport EditableConnector from "./EditableConnector";\nexport default {\n  components: { EditableConnector },\n  props: ["niceDag", "node"],\n  setup(props) {\n    return {\n      startNodeDragging(e) {\n        props.niceDag.startNodeDragging(props.node, e);\n      },\n    };\n  },\n};\n<\/script>\n',ki='<template>\n  <div className="editable-sample-edge-label"></div>\n</template>\n\n<script>\nexport default {\n  setup() {},\n};\n<\/script>\n',Mi='<template>\n  <div className="editable-sample-node-group-content">\n    <div>\n      <div\n        className="editable-sample-node-group-content-bar"\n        @mousedown="startNodeDragging"\n      >\n        <span>{{ node.data?.label || node.id }}</span>\n        <SvgIcon v-if="niceDag.editing"><MoveSvg /></SvgIcon>\n      </div>\n      <div\n        className="editable-sample-node-group-content-delete-button"\n        @mousedown="removeNode"\n      >\n        <CloseSvg />\n      </div>\n      <MyButton @click="shrinkNode">\n        <ShrinkSvg />\n      </MyButton>\n    </div>\n  </div>\n</template>\n\n<script>\nimport SvgIcon from "../../components/SvgIcon.vue";\nimport MyButton from "../../components/MyButton.vue";\nimport MoveSvg from "../../assets/svgs/move.vue";\nimport CloseSvg from "../../assets/svgs/close.vue";\nimport ShrinkSvg from "../../assets/svgs/shrink.vue";\n\nexport default {\n  name: "EditableGroupControl",\n  components: { SvgIcon, MoveSvg, CloseSvg, MyButton, ShrinkSvg },\n  props: ["node", "niceDag", "type", "shape"],\n  setup(props) {\n    return {\n      startNodeDragging(e) {\n        props.niceDag.startNodeDragging(props.node, e);\n      },\n      shrinkNode() {\n        props.node.shrink();\n      },\n      removeNode() {\n        props.node.remove();\n      },\n    };\n  },\n};\n<\/script>\n',Bi='<template>\n  <div className="editable-sample-node-content">\n    <div\n      className="editable-sample-node-content-bar"\n      @mousedown="startNodeDragging"\n    >\n      <span>{{ node.data?.label || node.id }}</span>\n      <SvgIcon v-if="niceDag.editing"><MoveSvg /></SvgIcon>\n    </div>\n    <div\n      className="editable-sample-node-content-delete-button"\n      role="button"\n      @mousedown="removeNode"\n    >\n      <SvgIcon><CloseSvg /></SvgIcon>\n    </div>\n    <MyButton @click="expandNode" v-if="isExpandButtonVisible()">\n      <PlusSvg />\n    </MyButton>\n  </div>\n</template>\n\n<script>\nimport SvgIcon from "../../components/SvgIcon.vue";\nimport MyButton from "../../components/MyButton.vue";\nimport MoveSvg from "../../assets/svgs/move.vue";\nimport CloseSvg from "../../assets/svgs/close.vue";\nimport PlusSvg from "../../assets/svgs/plus.vue";\n\nexport default {\n  name: "EditableNodeControl",\n  components: { SvgIcon, MoveSvg, CloseSvg, PlusSvg, MyButton },\n  props: ["node", "niceDag"],\n  setup(props) {\n    return {\n      startNodeDragging(e) {\n        props.niceDag.startNodeDragging(props.node, e);\n      },\n      removeNode() {\n        props.node.remove();\n      },\n      expandNode() {\n        props.node.expand();\n      },\n      isExpandButtonVisible() {\n        return (\n          props.node.children?.length > 0 ||\n          props.node.data?.lazyLoadingChildren\n        );\n      },\n    };\n  },\n};\n<\/script>\n',Ii=n(2624),Ti=n(414),Vi=(n(1703),n(6279),{name:"App",props:["filename"],components:{PrismEditor:Ii.h},setup(e){const t={"ReadOnlyView.vue":Ei,"ReadOnlyNodes.js":wi,"ReadOnlyView.less":bi,"ReadOnlyViewData.js":Ni,"EditableView.vue":Di,"EditableNode.vue":xi,"EditableConnector.vue":Ri,"EditableStartNode.vue":_i,"EditableEndNode.vue":Li,"EditableGroupControl.vue":Mi,"EditableEdge.vue":ki,"EditableNodeControl.vue":Bi,"EditableJoint.vue":Si,"EditableView.less":Ci},n=t[e.filename];return{content:n}},methods:{highlighter(e){return(0,Ti.highlight)(e,Ti.languages.js)}}});const zi=(0,T.Z)(Vi,[["render",yi]]);var Pi=zi;const Oi={class:"logo",viewBox:"0 0 128 128",width:"28",height:"28","data-v-97393f76":""},Ai=(0,o._)("path",{fill:"#42b883",d:"M78.8,10L64,35.4L49.2,10H0l64,110l64-110C128,10,78.8,10,78.8,10z","data-v-97393f76":""},null,-1),$i=(0,o._)("path",{fill:"#35495e",d:"M78.8,10L64,35.4L49.2,10H25.6L64,76l38.4-66H78.8z","data-v-97393f76":""},null,-1),Wi=[Ai,$i];function ji(e,t,n,i,s,d){return(0,o.wg)(),(0,o.iD)("svg",Oi,Wi)}var Hi={name:"LogoSvg"};const Gi=(0,T.Z)(Hi,[["render",ji]]);var qi=Gi,Ji={name:"App",components:{ReadOnlyView:Kt,EditableView:fi,CodeViewer:Pi,LogoSvg:qi},setup(){const e={"read-only-view":{name:"Read Only View",codes:["ReadOnlyView.vue","ReadOnlyNodes.js"],less:"ReadOnlyView.less",data:"ReadOnlyViewData.js"},"editable-view":{name:"Editable View",codes:["EditableView.vue","EditableNode.vue","EditableJoint.vue","EditableStartNode.vue","EditableEndNode.vue","EditableConnector.vue","EditableEdge.vue","EditableNodeControl.vue","EditableGroupControl.vue"],less:"EditableView.less",data:"ReadOnlyViewData.js"}},t=(0,_.iH)("code"),n=window.location.hash.replace("#",""),i=(0,_.iH)(n&&""!==n?n:"read-only-view");return window.onhashchange=()=>{const e=window.location.hash.replace("#","");i.value=e},{examples:e,current:i,activeTab:t,getCurrentExample(t){return e[t]},handleClick(){},isActive(e){return i.value===e}}}};const Zi=(0,T.Z)(Ji,[["render",v]]);var Xi=Zi,Yi=n(8090);n(1376);(0,i.ri)(Xi).use(Yi.Z).mount("#app")}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var s=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.m=e,function(){var e=[];n.O=function(t,i,o,s){if(!i){var d=1/0;for(h=0;h<e.length;h++){i=e[h][0],o=e[h][1],s=e[h][2];for(var a=!0,r=0;r<i.length;r++)(!1&s||d>=s)&&Object.keys(n.O).every((function(e){return n.O[e](i[r])}))?i.splice(r--,1):(a=!1,s<d&&(d=s));if(a){e.splice(h--,1);var l=o();void 0!==l&&(t=l)}}return t}s=s||0;for(var h=e.length;h>0&&e[h-1][2]>s;h--)e[h]=e[h-1];e[h]=[i,o,s]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,i){var o,s,d=i[0],a=i[1],r=i[2],l=0;if(d.some((function(t){return 0!==e[t]}))){for(o in a)n.o(a,o)&&(n.m[o]=a[o]);if(r)var h=r(n)}for(t&&t(i);l<d.length;l++)s=d[l],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(h)},i=self["webpackChunkvue"]=self["webpackChunkvue"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=n.O(void 0,[998],(function(){return n(2216)}));i=n.O(i)})();
//# sourceMappingURL=app.e3658f3f.js.map